{"version":3,"sources":["RelevanceInspector.min__d6b9bcc2bfcb024de483.js","./src/ui/RelevanceInspector/RelevanceInspector.ts","./src/ui/ResultLink/ResultLink.ts","./src/ui/RelevanceInspector/TableBuilder.ts","./src/ui/RelevanceInspector/ExecutionReport.ts","./src/ui/RelevanceInspector/GenericValueOutput.ts","./src/ui/RelevanceInspector/ExecutionReportGenericSection.ts","./src/ui/RelevanceInspector/RankingInfoParser.ts","./src/ui/RelevanceInspector/ExecutionReportSimpleSection.ts","./src/ui/RelevanceInspector/RankingInfoTable.ts","./src/ui/RelevanceInspector/AgGrid.ts","./src/ui/RelevanceInspector/MetaDataTable.ts","./src/ui/RelevanceInspector/RelevanceInspectorTabs.ts","webpack:///./sass/_RelevanceInspector.scss?ff92","./sass/_RelevanceInspector.scss","./src/ui/RelevanceInspector/ExecutionReportAuthenticationSection.ts","./src/ui/RelevanceInspector/ExecutionReportResolvedPipelineSection.ts","./src/ui/RelevanceInspector/ExecutionReportQueryOverrideSection.ts","./src/ui/RelevanceInspector/ExecutionReportEffectiveIndexQuerySection.ts","./src/ui/RelevanceInspector/ExecutionReportRankingModifiers.ts","./src/ui/RelevanceInspector/ExecutionReportITDSection.ts","./src/ui/RelevanceInspector/AvailableFieldsTable.ts","./src/ui/RelevanceInspector/InlineRankingInfo.ts"],"names":["webpackJsonpCoveo__temporary","232","module","exports","__webpack_require__","__awaiter","this","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","verb","n","v","op","f","TypeError","_","y","t","call","label","ops","pop","trys","length","push","g","sent","throw","return","Symbol","iterator","Object","defineProperty","element","bindings","opened","modalBoxModule","ModalBox","$$","text","addClass","root","on","queryStateModel","getEventName","QueryStateModel","eventTypes","changeOne","attributesEnum","debug","args","toggleFromState","open","ResultListEvents","newResultDisplayed","handleNewResultDisplayed","get","show","hide","set","enumerable","configurable","removeClass","content","animation","rows","_a","DomUtils","getBasicLoadingAnimation","append","modalBox","el","modalBoxOptions","buildTabs","remove","close","item","hasClass","InlineRankingInfo","build","prepend","title","titleClose","overlayClose","sizeMod","className","validation","document","getElementsByClassName","stateValue","lastResults","container","rankingInfoTable","metadataTable","executionReport","availableFields","inspectorTabs","debouncedResize","_b","_c","_d","_e","_f","_g","_h","_j","_k","_l","_m","_this","_o","queryController","getLastResults","results","rankingInfo","RankingInfoTable","MetaDataTable","ExecutionReport","AvailableFieldsTable","tabs","relevanceInspectorRankingInfo","relevanceInspectorMetadata","relevanceInspectorExecutionReport","relevanceInspectorAvailableFields","RelevanceInspectorTabs","tabChangedTo","activeTab","resize","debounce","window","addEventListener","addSection","Logger","error","select","navigationSection","tabContentSection","gridOptions","api","sizeColumnsToFit","RelevanceInspector","532","69","__extends","extendStatics","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","s","i","arguments","options","os","ResultLink","ID","logAnalytics","saveLastQuery","documentURL","getAttribute","undefined","escapedClickUri","logDocumentOpen","Defer","flush","globalOptions","searchInterface","originalOptionsObject","initialOptions","ComponentOptions","initComponentOptions","resultLinkOptions","componentOptionsModel","ComponentOptionsModel","resultLink","extend","resolveResult","openQuickview","raw","DeviceUtils","isMobileDevice","hasAttribute","setAttribute","Assert","exists","quickviewShouldBeOpened","once","setTimeout","clearTimeout","renderUri","bindEventToOpen","test","innerHTML","getDisplayedTitle","titleAsText","getDisplayedTitleAsText","openLink","location","href","getResultUri","openLinkInNewWindow","openLinkInOutlook","hasOutlookField","openLinkAsConfigured","toExecuteOnOpen","bindOnClickIfNotUndefined","bindOpenQuickviewIfNotUndefined","setHrefIfNotAlready","openLinkThatIsNotAnAnchor","titleTemplate","newTitle","StringUtils","buildStringTemplateFromResult","StreamHighlightUtils","highlightStreamText","termsToHighlight","phrasesToHighlight","HighlightUtils","highlightString","titleHighlights","setHtml","escape","clickUri","onClick","AccessibleButton","withElement","withLabel","withSelectAction","resultElement","trigger","preventDefault","elementIsAnAnchor","alwaysOpenInNewWindow","openInOutlook","Utils","isNonEmptyString","usageAnalytics","logClickEvent","analyticsActionCauseList","documentOpen","documentTitle","author","getFieldValue","filterProtocol","uri","isAbsolute","isRelative","hrefTemplate","field","setField","tagName","OSUtils","OS_NAME","MACOSX","WINDOWS","isUriThatMustBeOpenedInQuickview","toLowerCase","indexOf","QueryUtils","hasHTMLVersion","doExport","exportGlobally","buildFieldOption","buildBooleanOption","defaultValue","buildStringOption","buildCustomOption","Component","Initialization","registerAutoCreateComponent","807","defaultGridOptions","domLayout","enableColResize","rowHeight","enableRangeSelection","suppressRowClickSelection","suppressCellSelection","defaultColDef","width","enableSorting","autoSizePadding","sources","table","firstData","mapToAgGridFormat","columnDefs","rowData","grid","first","key","children","headerName","marryChildren","flatten","map","child","source","merged","extractContent","each","loadAgGridLibrary","agGrid","Grid","thumbnailCell","Document","cellRenderer","ThumbnailHtmlRenderer","getQuickFilterText","params","TableBuilder","init","currentFilter","filterManager","quickFilter","getGui","cell","thumbnail","dom","resultLists","getComponents","firstActiveResultList","find","resultList","disabled","buildResult","builtResult","highlightSearch","refresh","elementToSearch","search","asHTMLElement","innerText","match","split","RegExp","regexEncode","forEach","span","regex","group","appendChild","substr","highlightStreamHTML","Precision","GenericHtmlRenderer","808","EXECUTION_REPORT_SECTION","standardSectionHeader","agGridElement","authenticationSection","resolvedPipelineSection","resolvedRankingModifiers","queryParamOverrideSection","thesaurusSection","stopWordsSection","filtersSection","rankingSection","topResultsSection","itdSection","rankingWeightsSection","indexQuerySection","ExecutionReportAuthenticationSection","ExecutionReportResolvedPipelineSection","ExecutionReportRankingModifiers","rankingExpressions","ExecutionReportQueryOverrideSection","ExecutionReportSimpleSection","PREPROCESS_QUERY_EXPRESSION","THESAURUS","STOP_WORDS","PREPROCESS_QUERY","FILTERS","RANKING","TOP_RESULT","ExecutionReportITDSection","RANKING_WEIGHT","ExecutionReportEffectiveIndexQuerySection","option","809","output","section","isArray","arrayJoined","isObject","objectJoined","simpleValue","valueOrNullOutput","list","innerList","outerHTML","sectionValue","toString","GenericValueOutput","810","executionReportSection","descriptionSection","durationSection","Description","description","Duration","duration","ExecutionReportGenericSection","811","buildListOfTermsElement","weightPerTerm","listItems","dt","dd","total","reduce","memo","parseRankingInfo","REGEX_EXTRACT_DOCUMENT_WEIGHTS","REGEX_EXTRACT_TERMS_WEIGHTS","REGEX_EXTRACT_TOTAL_WEIGHTS","docWeightsRegexResult","exec","termsWeightRegexResult","totalWeigthRegexResult","qreWeights","parseQREWeights","documentWeights","parseWeights","termsWeight","parseTermsWeights","totalWeight","Number","REGEX_EXTRACT_LIST_OF_WEIGHTS","REGEX_EXTRACT_WEIGHT_GROUP","listOfWeight","object","weight","weightGroup","weightAppliedOn","weightValue","REGEX_EXTRACT_GROUP_OF_TERMS","REGEX_EXTRACT_SINGLE_TERM","terms","term","words","word","Correlation","weights","keys","join","Weights","REGEX_EXTRACT_QRE_WEIGHTS","qreWeightsRegexResult","expression","score","parseInt","812","topLevelProperty","secondLevelProperty","sectionTitle","dataSource","tableBuilder","name","findWhere","Applied","applied","813","topLevelInfoThatHaveAtLeastANonZeroValue","containsKeywordRankingInfo","data","uniq","documentsWeights","buildTopLevelDocumentsWeights","chain","sortBy","reverse","totalContent","Total","getRowHeight","onGridReady","setSortModel","colId","sort","hasAtLeastOneNonZeroValue","contains","814","isAgGridLoaded","isAgGridLoading","reset","doc","addAgGridScriptsToDocument","catch","src","type","async","styleBase","rel","style","head","resolveScriptLoaded","rejectScriptLoaded","onload","onerror","815","fieldsDescription","builders","builtTables","textInput","getEndpoint","listFields","nestedContainer","nestedAgGrid","fields","FieldValuesRenderer","allValues","val","concat","onCellDoubleClicked","event","target","getSelection","createRange","selection","range","selectNodeContents","removeAllRanges","addRange","built","all","TextInput","input","setQuickFilter","getValue","onRowHeightChanged","getElement","listAsInput","eParentOfValue","height","Math","max","maxHeight","min","node","setRowHeight","fieldInResult","isCurrentElementFilteredOut","inputGroup","fieldName","fieldValue","convertFieldValueToReadableFormat","fieldValueElement","matchInFieldName","matchInFieldValue","matchingFieldDescription","replace","fieldType","DateUtils","convertToStandardDate","816","onTabChange","navigationElements","tabContentElements","id","navElementToActivate","findNavigationById","tabContentToActivate","findTabContentById","activateTabNavigation","activateTabContent","addNavigation","caption","navigationElement","addContent","targetId","tabContent","tabContentElement","contentElement","817","transform","locals","818","819","PERFORM_AUTHENTICATION","configurationSection","pipelineOuputSection","Configured","Primary","genericOutput","configured","primary","Secondary","secondary","Mandatory","mandatory","usersIds","userIds","queryRestrictions","Roles","roles","userGroups","userId","Kind","kind","Provider","provider","Info","info","820","RESOLVE_PIPELINE","Pipeline","pipeline","splitTest","821","queryOverrideSection","QUERY_PARAM_OVERRIDE","822","collapsibleSectionsInReport","INDEX_QUERY","in","paramValue","paramKey","row","btn","toggleClass","823","dataSourcePromises","rankingExpression","isAutomaticBoostRegex","thumbnailPreview","returnedByIndexForCurrentQuery","isAutomaticBoost","permanentIDUsedInAutomaticBoost","extracted","extractDocumentInfoFromBoost","ReturnedByIndexForCurrentQuery","IsRecommendation","isRecommendation","Expression","Modifier","modifier","permanentID","matchingResult","resultInResultSet","queryBuilder","resultsFromIndex","permanentid","urihash","QueryBuilder","advancedExpression","add","824","preprocessQuerySection","originalLongQuery","topClicksSection","lq","TOP_CLICKS","buildOriginalLongQueryCell","refinedQueries","buildRefinedQueryCell","buildFallbackEmptyTable","doHighlights","refined","q","preprocessSection","isNonEmptyArray","buildRefinedQueryByMLCell","fallbackIndexPartialMatch","PARTIAL_MATCH","out","buildRefinedQueryByPartialMatchCell","buildRefinedQueryNoExtraction","topLevelContainer","keywordsList","refinedQuery","refinedQueryContainer","partialMatch","NONE","825","allFieldsDescription","Name","fieldSourceType","includeInQuery","includeInResults","groupByField","splitGroupByField","sortByField","suppressSorting","suppressFilter","AvailableFieldsSampleValue","enableFilter","rowModelType","pagination","paginationPageSize","enableServerSideFilter","enableServerSideSorting","datasource","AvailableFieldsDatasource","popperElement","userHoveringButtonWithHisMouse","values","getFieldsValues","renderFieldValues","PopupUtils","positionPopup","horizontal","PopupHorizontalAlignment","LEFT","vertical","PopupVerticalAlignment","MIDDLE","fieldDesciption","queryResults","listFieldValues","fieldValues","background","listItem","rowsData","getRows","filtered","filter","filterModel","filteredAndSorted","sortModel","successCallback","slice","startRow","endRow","where","possibleReturn","sortModels","second","firstValue","secondValue","ascendingOrDescendingMultiplier","isNullOrEmptyString","isNaN","localeCompare","826","buildTogglableTermsSection","buildTogglableQRESection","termsButton","termsSection","builtKey","qreButton","qreSection"],"mappings":"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","file":"RelevanceInspector.min__d6b9bcc2bfcb024de483.js","sourcesContent":["webpackJsonpCoveo__temporary([0,65],{\n\n/***/ 232:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar RankingInfoTable_1 = __webpack_require__(813);\nvar MetaDataTable_1 = __webpack_require__(815);\nvar Dom_1 = __webpack_require__(1);\nvar ExternalModulesShim_1 = __webpack_require__(26);\nvar Core_1 = __webpack_require__(20);\nvar RelevanceInspectorTabs_1 = __webpack_require__(816);\n__webpack_require__(817);\nvar ExecutionReport_1 = __webpack_require__(808);\nvar AvailableFieldsTable_1 = __webpack_require__(825);\nvar underscore_1 = __webpack_require__(0);\nvar InlineRankingInfo_1 = __webpack_require__(826);\nvar RelevanceInspector = /** @class */ (function () {\n    function RelevanceInspector(element, bindings) {\n        var _this = this;\n        this.element = element;\n        this.bindings = bindings;\n        this.opened = false;\n        this.modalBoxModule = ExternalModulesShim_1.ModalBox;\n        Dom_1.$$(this.element).text('Relevance Inspector');\n        Dom_1.$$(this.element).addClass('coveo-button coveo-relevance-inspector');\n        Dom_1.$$(this.bindings.root).on(this.bindings.queryStateModel.getEventName(Core_1.QueryStateModel.eventTypes.changeOne + Core_1.QueryStateModel.attributesEnum.debug), function (e, args) { return _this.toggleFromState(args.value); });\n        Dom_1.$$(this.element).on('click', function () { return _this.open(); });\n        Dom_1.$$(this.bindings.root).on(Core_1.ResultListEvents.newResultDisplayed, function (e, args) {\n            return _this.handleNewResultDisplayed(args);\n        });\n        this.bindings.queryStateModel.get(Core_1.QueryStateModel.attributesEnum.debug) ? this.show() : this.hide();\n    }\n    Object.defineProperty(RelevanceInspector.prototype, \"modalBox\", {\n        get: function () {\n            return this.modalBoxModule;\n        },\n        set: function (modalBoxModule) {\n            this.modalBoxModule = modalBoxModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    RelevanceInspector.prototype.hide = function () {\n        Dom_1.$$(this.element).addClass('coveo-hidden');\n    };\n    RelevanceInspector.prototype.show = function () {\n        Dom_1.$$(this.element).removeClass('coveo-hidden');\n    };\n    RelevanceInspector.prototype.open = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var content, animation, rows;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (this.opened) {\n                            return [2 /*return*/];\n                        }\n                        this.opened = true;\n                        content = Dom_1.$$('div');\n                        animation = Core_1.DomUtils.getBasicLoadingAnimation();\n                        content.append(animation);\n                        this.modalBox.open(content.el, this.modalBoxOptions);\n                        return [4 /*yield*/, this.buildTabs()];\n                    case 1:\n                        rows = _a.sent();\n                        if (rows) {\n                            animation.remove();\n                            content.append(rows.el);\n                        }\n                        else {\n                            this.modalBox.close();\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    RelevanceInspector.prototype.handleNewResultDisplayed = function (args) {\n        if (this.bindings.queryStateModel.get(Core_1.QueryStateModel.attributesEnum.debug)) {\n            Dom_1.$$(args.item).addClass('coveo-with-inline-ranking-info');\n            if (Dom_1.$$(args.item).hasClass('coveo-table-layout')) {\n                Dom_1.$$(args.item).append(new InlineRankingInfo_1.InlineRankingInfo(args.result).build().el);\n            }\n            else {\n                Dom_1.$$(args.item).prepend(new InlineRankingInfo_1.InlineRankingInfo(args.result).build().el);\n            }\n        }\n    };\n    Object.defineProperty(RelevanceInspector.prototype, \"modalBoxOptions\", {\n        get: function () {\n            var _this = this;\n            return {\n                title: 'Relevance Inspector',\n                titleClose: false,\n                overlayClose: true,\n                sizeMod: 'big',\n                className: 'relevance-inspector-modal',\n                validation: function () {\n                    _this.opened = false;\n                    return true;\n                },\n                body: document.getElementsByClassName('CoveoSearchInterface')[0] // Will return undefined if no CoveoSearchInterface is present\n            };\n        },\n        enumerable: true,\n        configurable: true\n    });\n    RelevanceInspector.prototype.toggleFromState = function (stateValue) {\n        stateValue != 0 ? this.show() : this.hide();\n        this.modalBox.close();\n    };\n    RelevanceInspector.prototype.buildTabs = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            var lastResults, container, rankingInfoTable, metadataTable, executionReport, availableFields, inspectorTabs, debouncedResize, _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m;\n            return __generator(this, function (_o) {\n                switch (_o.label) {\n                    case 0:\n                        lastResults = this.bindings.queryController.getLastResults().results;\n                        if (!lastResults || lastResults.length == 0) {\n                            new Core_1.Logger(this).error('Could not open Relevance Inspector because there is no results to display. Please execute a query beforehand', lastResults);\n                            return [2 /*return*/];\n                        }\n                        if (!lastResults[0].rankingInfo) {\n                            new Core_1.Logger(this).error('Could not open Relevance Inspector because there is no ranking info returned on the results. Please execute a query in debug mode beforehad', lastResults);\n                            return [2 /*return*/];\n                        }\n                        container = Dom_1.$$('div');\n                        rankingInfoTable = new RankingInfoTable_1.RankingInfoTable(lastResults, this.bindings);\n                        metadataTable = new MetaDataTable_1.MetaDataTable(lastResults, this.bindings);\n                        executionReport = new ExecutionReport_1.ExecutionReport(this.bindings.queryController.getLastResults(), this.bindings);\n                        availableFields = new AvailableFieldsTable_1.AvailableFieldsTable(this.bindings);\n                        this.tabs = {\n                            relevanceInspectorRankingInfo: rankingInfoTable,\n                            relevanceInspectorMetadata: metadataTable,\n                            relevanceInspectorExecutionReport: executionReport,\n                            relevanceInspectorAvailableFields: availableFields\n                        };\n                        inspectorTabs = new RelevanceInspectorTabs_1.RelevanceInspectorTabs(function (tabChangedTo) {\n                            _this.activeTab = tabChangedTo;\n                            _this.resize();\n                        });\n                        debouncedResize = underscore_1.debounce(function () { return _this.resize(); }, 100);\n                        window.addEventListener('resize', debouncedResize);\n                        _b = (_a = inspectorTabs).addSection;\n                        _c = ['Ranking Information'];\n                        return [4 /*yield*/, rankingInfoTable.build()];\n                    case 1:\n                        _b.apply(_a, _c.concat([_o.sent(), 'relevanceInspectorRankingInfo']));\n                        _e = (_d = inspectorTabs).addSection;\n                        _f = ['Metadata'];\n                        return [4 /*yield*/, metadataTable.build()];\n                    case 2:\n                        _e.apply(_d, _f.concat([_o.sent(), 'relevanceInspectorMetadata']));\n                        _h = (_g = inspectorTabs).addSection;\n                        _j = ['Execution Report'];\n                        return [4 /*yield*/, executionReport.build()];\n                    case 3:\n                        _h.apply(_g, _j.concat([_o.sent(), 'relevanceInspectorExecutionReport']));\n                        _l = (_k = inspectorTabs).addSection;\n                        _m = ['Available Fields'];\n                        return [4 /*yield*/, availableFields.build()];\n                    case 4:\n                        _l.apply(_k, _m.concat([_o.sent(), 'relevanceInspectorAvailableFields']));\n                        inspectorTabs.select('relevanceInspectorRankingInfo');\n                        container.append(inspectorTabs.navigationSection.el);\n                        container.append(inspectorTabs.tabContentSection.el);\n                        return [2 /*return*/, container];\n                }\n            });\n        });\n    };\n    RelevanceInspector.prototype.resize = function () {\n        if (!this.activeTab) {\n            return;\n        }\n        if (!this.tabs[this.activeTab]) {\n            return;\n        }\n        this.tabs[this.activeTab].gridOptions.api.sizeColumnsToFit();\n    };\n    return RelevanceInspector;\n}());\nexports.RelevanceInspector = RelevanceInspector;\n\n\n/***/ }),\n\n/***/ 532:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 69:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Component_1 = __webpack_require__(7);\nvar ComponentOptions_1 = __webpack_require__(8);\nvar ComponentOptionsModel_1 = __webpack_require__(28);\nvar AnalyticsActionListMeta_1 = __webpack_require__(10);\nvar ResultListEvents_1 = __webpack_require__(29);\nvar HighlightUtils_1 = __webpack_require__(67);\nvar DeviceUtils_1 = __webpack_require__(24);\nvar OSUtils_1 = __webpack_require__(178);\nvar Initialization_1 = __webpack_require__(2);\nvar QueryUtils_1 = __webpack_require__(21);\nvar Assert_1 = __webpack_require__(5);\nvar Utils_1 = __webpack_require__(4);\nvar Defer_1 = __webpack_require__(31);\nvar Dom_1 = __webpack_require__(1);\nvar StreamHighlightUtils_1 = __webpack_require__(118);\nvar StringUtils_1 = __webpack_require__(22);\nvar underscore_1 = __webpack_require__(0);\nvar GlobalExports_1 = __webpack_require__(3);\n__webpack_require__(532);\nvar AccessibleButton_1 = __webpack_require__(15);\n/**\n * The `ResultLink` component automatically transform a search result title into a clickable link pointing to the\n * original item.\n *\n * This component is a result template component (see [Result Templates](https://docs.coveo.com/en/413/)).\n */\nvar ResultLink = /** @class */ (function (_super) {\n    __extends(ResultLink, _super);\n    /**\n     * Creates a new `ResultLink` component.\n     * @param element The HTMLElement on which to instantiate the component.\n     * @param options The options for the `ResultLink` component.\n     * @param bindings The bindings that the component requires to function normally. If not set, these will be\n     * automatically resolved (with a slower execution time).\n     * @param result The result to associate the component with.\n     * @param os\n     */\n    function ResultLink(element, options, bindings, result, os) {\n        var _this = _super.call(this, element, ResultLink.ID, bindings) || this;\n        _this.element = element;\n        _this.options = options;\n        _this.bindings = bindings;\n        _this.result = result;\n        _this.os = os;\n        _this.logAnalytics = underscore_1.debounce(function () {\n            _this.queryController.saveLastQuery();\n            var documentURL = Dom_1.$$(_this.element).getAttribute('href');\n            if (documentURL == undefined || documentURL == '') {\n                documentURL = _this.escapedClickUri;\n            }\n            if (_this.options.logAnalytics) {\n                _this.options.logAnalytics(documentURL);\n            }\n            else {\n                _this.logDocumentOpen(documentURL);\n            }\n            Defer_1.Defer.flush();\n        }, 1500, true);\n        var globalOptions = _this.searchInterface.options.originalOptionsObject[ResultLink.ID] || {};\n        var initialOptions = ComponentOptions_1.ComponentOptions.initComponentOptions(element, ResultLink, __assign({}, globalOptions, options));\n        var resultLinkOptions = _this.componentOptionsModel.get(ComponentOptionsModel_1.ComponentOptionsModel.attributesEnum.resultLink);\n        _this.options = underscore_1.extend({}, initialOptions, resultLinkOptions);\n        _this.result = result || _this.resolveResult();\n        if (_this.options.openQuickview == null) {\n            _this.options.openQuickview = result.raw['connectortype'] == 'ExchangeCrawler' && DeviceUtils_1.DeviceUtils.isMobileDevice();\n        }\n        if (!_this.element.hasAttribute('tabindex')) {\n            _this.element.setAttribute('tabindex', '0');\n        }\n        Assert_1.Assert.exists(_this.componentOptionsModel);\n        Assert_1.Assert.exists(_this.result);\n        if (!_this.quickviewShouldBeOpened()) {\n            // Bind on multiple \"click\" or \"mouse\" events.\n            // Create a function that will be executed only once, so as not to log multiple events\n            // Once a result link has been opened, and that we log at least one analytics event,\n            // it should not matter if the end user open the same link multiple times with different methods.\n            // It's still only one \"click\" event as far as UA is concerned.\n            // Also need to handle \"longpress\" on mobile (the contextual menu), which we assume to be 1 s long.\n            var executeOnlyOnce_1 = underscore_1.once(function () { return _this.logAnalytics(); });\n            Dom_1.$$(element).on(['contextmenu', 'click', 'mousedown', 'mouseup'], executeOnlyOnce_1);\n            var longPressTimer_1;\n            Dom_1.$$(element).on('touchstart', function () {\n                longPressTimer_1 = window.setTimeout(executeOnlyOnce_1, 1000);\n            });\n            Dom_1.$$(element).on('touchend', function () {\n                if (longPressTimer_1) {\n                    clearTimeout(longPressTimer_1);\n                }\n            });\n        }\n        _this.renderUri(element, result);\n        _this.bindEventToOpen();\n        return _this;\n    }\n    ResultLink.prototype.renderUri = function (element, result) {\n        if (/^\\s*$/.test(this.element.innerHTML)) {\n            var title = this.getDisplayedTitle();\n            this.element.innerHTML = title;\n            var titleAsText = this.getDisplayedTitleAsText();\n            if (!this.element.hasAttribute('aria-label')) {\n                this.element.setAttribute('aria-label', titleAsText);\n            }\n            if (!this.element.title) {\n                this.element.title = titleAsText;\n            }\n        }\n    };\n    /**\n     * Opens the result in the same window, no matter how the actual component is configured for the end user.\n     * @param logAnalytics Specifies whether the method should log an analytics event.\n     */\n    ResultLink.prototype.openLink = function (logAnalytics) {\n        if (logAnalytics === void 0) { logAnalytics = true; }\n        if (logAnalytics) {\n            this.logAnalytics();\n        }\n        window.location.href = this.getResultUri();\n    };\n    /**\n     * Opens the result in a new window, no matter how the actual component is configured for the end user.\n     * @param logAnalytics Specifies whether the method should log an analytics event.\n     */\n    ResultLink.prototype.openLinkInNewWindow = function (logAnalytics) {\n        if (logAnalytics === void 0) { logAnalytics = true; }\n        if (logAnalytics) {\n            this.logAnalytics();\n        }\n        window.open(this.getResultUri(), '_blank');\n    };\n    /**\n     * Tries to open the result in Microsoft Outlook if the result has an `outlookformacuri` or `outlookuri` field.\n     *\n     * Normally, this implies the result should be a link to an email.\n     *\n     * If the needed fields are not present, this method does nothing.\n     * @param logAnalytics Specifies whether the method should log an analytics event.\n     */\n    ResultLink.prototype.openLinkInOutlook = function (logAnalytics) {\n        if (logAnalytics === void 0) { logAnalytics = true; }\n        if (this.hasOutlookField()) {\n            if (logAnalytics) {\n                this.logAnalytics();\n            }\n            this.openLink();\n        }\n    };\n    /**\n     * Opens the link in the same manner the end user would.\n     *\n     * This essentially simulates a click on the result link.\n     *\n     * @param logAnalytics Specifies whether the method should log an analytics event.\n     */\n    ResultLink.prototype.openLinkAsConfigured = function (logAnalytics) {\n        if (logAnalytics === void 0) { logAnalytics = true; }\n        if (this.toExecuteOnOpen) {\n            if (logAnalytics) {\n                this.logAnalytics();\n            }\n            this.toExecuteOnOpen();\n        }\n    };\n    ResultLink.prototype.bindEventToOpen = function () {\n        return (this.bindOnClickIfNotUndefined() ||\n            this.bindOpenQuickviewIfNotUndefined() ||\n            this.setHrefIfNotAlready() ||\n            this.openLinkThatIsNotAnAnchor());\n    };\n    ResultLink.prototype.getDisplayedTitle = function () {\n        if (!this.options.titleTemplate) {\n            return this.result.title\n                ? HighlightUtils_1.HighlightUtils.highlightString(this.result.title, this.result.titleHighlights, null, 'coveo-highlight')\n                : this.escapedClickUri;\n        }\n        else {\n            var newTitle = StringUtils_1.StringUtils.buildStringTemplateFromResult(this.options.titleTemplate, this.result);\n            return newTitle\n                ? StreamHighlightUtils_1.StreamHighlightUtils.highlightStreamText(newTitle, this.result.termsToHighlight, this.result.phrasesToHighlight)\n                : this.escapedClickUri;\n        }\n    };\n    ResultLink.prototype.getDisplayedTitleAsText = function () {\n        var container = Dom_1.$$('div');\n        container.setHtml(this.getDisplayedTitle());\n        return container.text();\n    };\n    Object.defineProperty(ResultLink.prototype, \"escapedClickUri\", {\n        get: function () {\n            return underscore_1.escape(this.result.clickUri);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ResultLink.prototype.bindOnClickIfNotUndefined = function () {\n        var _this = this;\n        if (this.options.onClick != undefined) {\n            this.toExecuteOnOpen = function (e) {\n                _this.options.onClick.call(_this, e, _this.result);\n            };\n            new AccessibleButton_1.AccessibleButton()\n                .withElement(this.element)\n                .withLabel(this.result.title)\n                .withSelectAction(function (e) { return _this.toExecuteOnOpen(e); })\n                .build();\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    ResultLink.prototype.bindOpenQuickviewIfNotUndefined = function () {\n        var _this = this;\n        if (this.quickviewShouldBeOpened()) {\n            this.toExecuteOnOpen = function () {\n                Dom_1.$$(_this.bindings.resultElement).trigger(ResultListEvents_1.ResultListEvents.openQuickview);\n            };\n            Dom_1.$$(this.element).on('click', function (e) {\n                e.preventDefault();\n                _this.toExecuteOnOpen();\n            });\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    ResultLink.prototype.openLinkThatIsNotAnAnchor = function () {\n        var _this = this;\n        if (!this.elementIsAnAnchor()) {\n            this.toExecuteOnOpen = function () {\n                if (_this.options.alwaysOpenInNewWindow) {\n                    if (_this.options.openInOutlook) {\n                        _this.openLinkInOutlook();\n                    }\n                    else {\n                        _this.openLinkInNewWindow();\n                    }\n                }\n                else {\n                    _this.openLink();\n                }\n            };\n            Dom_1.$$(this.element).on('click', function () {\n                _this.toExecuteOnOpen();\n            });\n            return true;\n        }\n        return false;\n    };\n    ResultLink.prototype.setHrefIfNotAlready = function () {\n        // Do not erase any value put in href by the template, etc. Allows\n        // using custom click urls while still keeping analytics recording\n        // and other behavior brought by the component.\n        if (this.elementIsAnAnchor() && !Utils_1.Utils.isNonEmptyString(Dom_1.$$(this.element).getAttribute('href'))) {\n            Dom_1.$$(this.element).setAttribute('href', this.getResultUri());\n            if (this.options.alwaysOpenInNewWindow && !(this.options.openInOutlook && this.hasOutlookField())) {\n                Dom_1.$$(this.element).setAttribute('target', '_blank');\n            }\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    ResultLink.prototype.logDocumentOpen = function (href) {\n        this.usageAnalytics.logClickEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.documentOpen, {\n            documentURL: href,\n            documentTitle: this.result.title,\n            author: Utils_1.Utils.getFieldValue(this.result, 'author')\n        }, this.result, this.root);\n    };\n    ResultLink.prototype.filterProtocol = function (uri) {\n        var isAbsolute = /^(https?|ftp|file|mailto|tel):/i.test(uri);\n        var isRelative = /^(\\/|\\.\\/|\\.\\.\\/)/.test(uri);\n        return isAbsolute || isRelative ? uri : '';\n    };\n    ResultLink.prototype.getResultUri = function () {\n        if (this.options.hrefTemplate) {\n            var uri = StringUtils_1.StringUtils.buildStringTemplateFromResult(this.options.hrefTemplate, this.result);\n            return this.filterProtocol(uri);\n        }\n        if (this.options.field == undefined && this.options.openInOutlook) {\n            this.setField();\n        }\n        if (this.options.field != undefined) {\n            return this.filterProtocol(Utils_1.Utils.getFieldValue(this.result, this.options.field));\n        }\n        return this.filterProtocol(this.result.clickUri);\n    };\n    ResultLink.prototype.elementIsAnAnchor = function () {\n        return this.element.tagName == 'A';\n    };\n    ResultLink.prototype.setField = function () {\n        var os = Utils_1.Utils.exists(this.os) ? this.os : OSUtils_1.OSUtils.get();\n        if (os == OSUtils_1.OS_NAME.MACOSX && this.hasOutlookField()) {\n            this.options.field = '@outlookformacuri';\n        }\n        else if (os == OSUtils_1.OS_NAME.WINDOWS && this.hasOutlookField()) {\n            this.options.field = '@outlookuri';\n        }\n    };\n    ResultLink.prototype.hasOutlookField = function () {\n        var os = Utils_1.Utils.exists(this.os) ? this.os : OSUtils_1.OSUtils.get();\n        if (os == OSUtils_1.OS_NAME.MACOSX && this.result.raw['outlookformacuri'] != undefined) {\n            return true;\n        }\n        else if (os == OSUtils_1.OS_NAME.WINDOWS && this.result.raw['outlookuri'] != undefined) {\n            return true;\n        }\n        return false;\n    };\n    ResultLink.prototype.isUriThatMustBeOpenedInQuickview = function () {\n        return this.escapedClickUri.toLowerCase().indexOf('ldap://') == 0;\n    };\n    ResultLink.prototype.quickviewShouldBeOpened = function () {\n        return (this.options.openQuickview || this.isUriThatMustBeOpenedInQuickview()) && QueryUtils_1.QueryUtils.hasHTMLVersion(this.result);\n    };\n    ResultLink.ID = 'ResultLink';\n    ResultLink.doExport = function () {\n        GlobalExports_1.exportGlobally({\n            ResultLink: ResultLink\n        });\n    };\n    /**\n     * The options for the ResultLink\n     * @componentOptions\n     */\n    ResultLink.options = {\n        /**\n         * Specifies the field to use to output the component `href` attribute value.\n         *\n         * **Tip:**\n         * > Instead of specifying a value for the `field` option, you can directly add an `href` attribute to the\n         * > `ResultLink` HTML element. Then, you can use a custom script to generate the `href` value.\n         *\n         * **Examples:**\n         * - With the following markup, the `ResultLink` outputs its `href` value using the `@uri` field (rather than the\n         * default field):\n         *\n         * ```html\n         * <a class=\"CoveoResultLink\" data-field=\"@uri\"></a>\n         * ```\n         *\n         * - In the following result template, the custom `getMyKBUri()` function provides the `href` value:\n         *\n         * ```html\n         * <script id=\"KnowledgeArticle\" type=\"text/underscore\" class=\"result-template\">\n         *   <div class='CoveoIcon>'></div>\n         *   <a class=\"CoveoResultLink\" href=\"<%= getMyKBUri(raw) %>\"></a>\n         *   <div class=\"CoveoExcerpt\"></div>\n         * </script>\n         * ```\n         *\n         * See also [`hrefTemplate`]{@link ResultLink.options.hrefTemplate}, which can override this option.\n         *\n         * By default, the component uses the `@clickUri` field of the item to output the value of its `href` attribute.\n         */\n        field: ComponentOptions_1.ComponentOptions.buildFieldOption(),\n        /**\n         * Specifies whether the component should try to open its link in Microsoft Outlook.\n         *\n         * Setting this option to `true` is normally useful for `ResultLink` instances related to Microsoft Exchange emails.\n         *\n         * If this option is `true`, clicking the `ResultLink` calls the\n         * [`openLinkInOutlook`]{@link ResultLink.openLinkInOutlook} method instead of the\n         * [`openLink`]{@link ResultLink.openLink} method.\n         *\n         * Default value is `false`.\n         */\n        openInOutlook: ComponentOptions_1.ComponentOptions.buildBooleanOption({ defaultValue: false }),\n        /**\n         * Specifies whether the component should open its link in the [`Quickview`]{@link Quickview} component rather than\n         * loading through the original URL.\n         *\n         * Default value is `false`.\n         */\n        openQuickview: ComponentOptions_1.ComponentOptions.buildBooleanOption({ defaultValue: false }),\n        /**\n         * Specifies whether the component should open its link in a new window instead of opening it in the current\n         * context.\n         *\n         * If this option is `true`, clicking the `ResultLink` calls the\n         * [`openLinkInNewWindow`]{@link ResultLink.openLinkInNewWindow} method instead of the\n         * [`openLink`]{@link ResultLink.openLink} method.\n         *\n         * **Note:**\n         * > If a search page contains a [`ResultPreferences`]{@link ResultsPreferences} component whose\n         * > [`enableOpenInNewWindow`]{@link ResultsPreferences.options.enableOpenInNewWindow} option is `true`, and the end\n         * > user checks the <b>Always open results in new window</b> box, `ResultLink` components in this page will always\n         * > open their links in a new window when the end user clicks them, no matter what the value of their\n         * > `alwaysOpenInNewWindow` option is.\n         *\n         * Default value is `false`.\n         */\n        alwaysOpenInNewWindow: ComponentOptions_1.ComponentOptions.buildBooleanOption({ defaultValue: false }),\n        /**\n         * Specifies a template literal from which to generate the `ResultLink` `href` attribute value (see\n         * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\n         *\n         * This option overrides the [`field`]{@link ResultLink.options.field} option value.\n         *\n         * The template literal can reference any number of fields from the parent result. It can also reference global\n         * scope properties.\n         *\n         * **Examples:**\n         *\n         * - The following markup generates an `href` value such as `http://uri.com?id=itemTitle`:\n         *\n         * ```html\n         * <a class='CoveoResultLink' data-href-template='${clickUri}?id=${raw.title}'></a>\n         * ```\n         *\n         * - The following markup generates an `href` value such as `localhost/fooBar`:\n         *\n         * ```html\n         * <a class='CoveoResultLink' data-href-template='${window.location.hostname}/{Foo.Bar}'></a>\n         * ```\n         *\n         * Default value is `undefined`.\n         */\n        hrefTemplate: ComponentOptions_1.ComponentOptions.buildStringOption(),\n        /**\n         * Specifies a template literal from which to generate the `ResultLink` display title (see\n         * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\n         *\n         * This option overrides the default `ResultLink` display title behavior.\n         *\n         * The template literal can reference any number of fields from the parent result. However, if the template literal\n         * references a key whose value is undefined in the parent result fields, the `ResultLink` title displays the\n         * name of this key instead.\n         *\n         * This option is ignored if the `ResultLink` innerHTML contains any value.\n         *\n         * **Examples:**\n         *\n         * - The following markup generates a `ResultLink` display title such as `Case number: 123456` if both the\n         * `raw.objecttype` and `raw.objectnumber` keys are defined in the parent result fields:\n         *\n         * ```html\n         * <a class=\"CoveoResultLink\" data-title-template=\"${raw.objecttype} number: ${raw.objectnumber}\"></a>\n         * ```\n         *\n         * - The following markup generates `${myField}` as a `ResultLink` display title if the `myField` key is undefined\n         * in the parent result fields:\n         *\n         * ```html\n         * <a class=\"CoveoResultLink\" data-title-template=\"${myField}\"></a>\n         * ```\n         *\n         * - The following markup generates `Foobar` as a `ResultLink` display title, because the `ResultLink` innterHTML is\n         * not empty:\n         *\n         * ```html\n         * <a class=\"CoveoResultLink\" data-title-template=\"${will} ${be} ${ignored}\">Foobar</a>\n         * ```\n         *\n         * Default value is `undefined`.\n         *\n         * @availablesince [January 2017 Release (v1.1865.9)](https://docs.coveo.com/en/396/#january-2017-release-v118659)\n         */\n        titleTemplate: ComponentOptions_1.ComponentOptions.buildStringOption(),\n        /**\n         * Specifies an event handler function to execute when the user clicks the `ResultLink` component.\n         *\n         * The handler function takes a JavaScript [`Event`](https://developer.mozilla.org/en/docs/Web/API/Event) object and\n         * an [`IQueryResult`]{@link IQueryResult} as its parameters.\n         *\n         * Overriding the default behavior of the `onClick` event can allow you to execute specific code instead.\n         *\n         * **Note:**\n         * > You cannot set this option directly in the component markup as an HTML attribute. You must either set it in the\n         * > [`init`]{@link init} call of your search interface (see\n         * > [Passing Component Options in the init Call](https://docs.coveo.com/en/346/#passing-component-options-in-the-init-call)),\n         * > or before the `init` call, using the `options` top-level function (see\n         * > [Passing Component Options Before the init Call](https://docs.coveo.com/en/346/#passing-component-options-before-the-init-call)).\n         *\n         * **Example:**\n         * ```javascript\n         * // You can set the option in the 'init' call:\n         * Coveo.init(document.querySelector(\"#search\"), {\n         *   ResultLink : {\n         *     onClick : function(e, result) {\n         *       e.preventDefault();\n         *       // Custom code to execute with the item URI and title.\n         *       openUriInASpecialTab(result.clickUri, result.title);\n         *     }\n         *   }\n         * });\n         *\n         * // Or before the 'init' call, using the 'options' top-level function:\n         * // Coveo.options(document.querySelector('#search'), {\n         * //   ResultLink : {\n         * //     onClick : function(e, result) {\n         * //       e.preventDefault();\n         * //       // Custom code to execute with the item URI and title.\n         * //       openUriInASpecialTab(result.clickUri, result.title);\n         * //     }\n         * //   }\n         * // });\n         * ```\n         */\n        onClick: ComponentOptions_1.ComponentOptions.buildCustomOption(function () {\n            return null;\n        }),\n        /**\n         * Specify this option to log additional analytics when this result link is pressed.\n         *\n         * **Example:**\n         * ```javascript\n         * const resultLink = new Coveo.ResultLink(\n         *   linkElement,\n         *   {\n         *     logAnalytics: (href) => Coveo.logCustomEvent(\n         *         Coveo.analyticsActionCauseList.openSmartSnippetSource,\n         *         {\n         *           searchQueryUid: searchInterface.queryController.lastSearchUid,\n         *           documentTitle: result.title,\n         *           author: Utils.getFieldValue(result, 'author'),\n         *           documentURL: href\n         *         },\n         *         element\n         *       )\n         *   },\n         *   searchInterface.getBindings(),\n         *   result\n         * )\n         * ```\n         */\n        logAnalytics: ComponentOptions_1.ComponentOptions.buildCustomOption(function () { return null; })\n    };\n    return ResultLink;\n}(Component_1.Component));\nexports.ResultLink = ResultLink;\nInitialization_1.Initialization.registerAutoCreateComponent(ResultLink);\n\n\n/***/ }),\n\n/***/ 807:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar AgGrid_1 = __webpack_require__(814);\nvar underscore_1 = __webpack_require__(0);\nvar UtilsModules_1 = __webpack_require__(86);\nvar ResultLink_1 = __webpack_require__(69);\nexports.defaultGridOptions = {\n    domLayout: 'autoHeight',\n    enableColResize: true,\n    rowHeight: 100,\n    enableRangeSelection: true,\n    suppressRowClickSelection: true,\n    suppressCellSelection: true,\n    defaultColDef: {\n        width: 100\n    },\n    enableSorting: true,\n    autoSizePadding: 10\n};\nvar TableBuilder = /** @class */ (function () {\n    function TableBuilder() {\n    }\n    TableBuilder.prototype.build = function (sources, table, gridOptions) {\n        if (gridOptions === void 0) { gridOptions = exports.defaultGridOptions; }\n        return __awaiter(this, void 0, void 0, function () {\n            var firstData, mapToAgGridFormat, columnDefs, rowData, grid;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        firstData = underscore_1.first(sources) || {};\n                        mapToAgGridFormat = function (value, key) {\n                            if (value.children) {\n                                return {\n                                    field: key,\n                                    headerName: key,\n                                    marryChildren: true,\n                                    children: underscore_1.flatten(value.children.map(function (child) {\n                                        return underscore_1.map(child, mapToAgGridFormat);\n                                    }))\n                                };\n                            }\n                            else {\n                                return __assign({ field: key, headerName: key }, value);\n                            }\n                        };\n                        columnDefs = underscore_1.map(firstData, mapToAgGridFormat);\n                        rowData = underscore_1.map(sources, function (source) {\n                            var merged = {};\n                            var extractContent = function (value, key) {\n                                if (value.content) {\n                                    merged[key] = value.content;\n                                }\n                                else if (value.children) {\n                                    underscore_1.each(value.children, function (child) {\n                                        underscore_1.each(child, extractContent);\n                                    });\n                                }\n                            };\n                            underscore_1.each(source, extractContent);\n                            return merged;\n                        });\n                        this.gridOptions = __assign({}, exports.defaultGridOptions, { columnDefs: columnDefs,\n                            rowData: rowData }, gridOptions);\n                        return [4 /*yield*/, AgGrid_1.loadAgGridLibrary()];\n                    case 1:\n                        _a.sent();\n                        grid = new agGrid.Grid(table.el, this.gridOptions);\n                        return [2 /*return*/, { grid: grid, gridOptions: this.gridOptions }];\n                }\n            });\n        });\n    };\n    TableBuilder.thumbnailCell = function (result, bindings) {\n        return {\n            Document: {\n                content: { result: result, bindings: bindings },\n                cellRenderer: ThumbnailHtmlRenderer,\n                width: 550,\n                getQuickFilterText: function (params) {\n                    return '';\n                }\n            }\n        };\n    };\n    return TableBuilder;\n}());\nexports.TableBuilder = TableBuilder;\nvar ThumbnailHtmlRenderer = /** @class */ (function () {\n    function ThumbnailHtmlRenderer() {\n    }\n    ThumbnailHtmlRenderer.prototype.init = function (params) {\n        if (params) {\n            this.element = params.value;\n            this.currentFilter = params.api.filterManager.quickFilter;\n        }\n    };\n    ThumbnailHtmlRenderer.prototype.getGui = function () {\n        var cell = UtilsModules_1.$$('div', { className: 'coveo-relevance-inspector-thumbnail-cell' });\n        if (this.element) {\n            var thumbnail = this.thumbnail(this.element.result, this.element.bindings);\n            cell.append(thumbnail.el);\n        }\n        else {\n            cell.append(UtilsModules_1.$$('p', undefined, '-- NULL --').el);\n        }\n        return cell.el;\n    };\n    ThumbnailHtmlRenderer.prototype.thumbnail = function (result, bindings) {\n        var dom;\n        if (bindings && result) {\n            var resultLists = bindings.searchInterface.getComponents('ResultList');\n            var firstActiveResultList = underscore_1.find(resultLists, function (resultList) { return !resultList.disabled; });\n            if (firstActiveResultList) {\n                dom = UtilsModules_1.$$('div', {\n                    className: 'coveo-relevance-inspector-result-thumbnail'\n                });\n                firstActiveResultList.buildResult(result).then(function (builtResult) {\n                    dom.append(builtResult);\n                });\n            }\n            else {\n                dom = UtilsModules_1.$$('a', {\n                    className: 'CoveoResultLink'\n                });\n                new ResultLink_1.ResultLink(dom.el, { alwaysOpenInNewWindow: true }, bindings, result);\n            }\n            if (this.currentFilter) {\n                this.highlightSearch(dom.el, this.currentFilter);\n            }\n        }\n        else {\n            dom = UtilsModules_1.$$('div', undefined, '-- NULL --');\n        }\n        return dom;\n    };\n    ThumbnailHtmlRenderer.prototype.refresh = function (params) {\n        return true;\n    };\n    ThumbnailHtmlRenderer.prototype.highlightSearch = function (elementToSearch, search) {\n        var asHTMLElement = elementToSearch;\n        if (asHTMLElement != null && asHTMLElement.innerText != null) {\n            var match = asHTMLElement.innerText.split(new RegExp('(?=' + UtilsModules_1.StringUtils.regexEncode(search) + ')', 'gi'));\n            asHTMLElement.innerHTML = '';\n            match.forEach(function (value) {\n                var regex = new RegExp('(' + UtilsModules_1.StringUtils.regexEncode(search) + ')', 'i');\n                var group = value.match(regex);\n                var span;\n                if (group != null) {\n                    span = UtilsModules_1.$$('span', {\n                        className: 'coveo-relevance-inspector-highlight'\n                    });\n                    span.text(group[1]);\n                    asHTMLElement.appendChild(span.el);\n                    span = UtilsModules_1.$$('span');\n                    span.text(value.substr(group[1].length));\n                    asHTMLElement.appendChild(span.el);\n                }\n                else {\n                    span = UtilsModules_1.$$('span');\n                    span.text(value);\n                    asHTMLElement.appendChild(span.el);\n                }\n            });\n        }\n    };\n    return ThumbnailHtmlRenderer;\n}());\nexports.ThumbnailHtmlRenderer = ThumbnailHtmlRenderer;\nvar GenericHtmlRenderer = /** @class */ (function () {\n    function GenericHtmlRenderer() {\n    }\n    GenericHtmlRenderer.prototype.init = function (params) {\n        if (params && params.api) {\n            this.element = params.value;\n            this.currentFilter = params.api.filterManager.quickFilter;\n        }\n    };\n    GenericHtmlRenderer.prototype.getGui = function () {\n        if (this.element && this.currentFilter) {\n            return UtilsModules_1.$$('div', undefined, UtilsModules_1.StreamHighlightUtils.highlightStreamHTML(this.element, { Precision: ['precision'] }, {})).el;\n        }\n        else if (this.element) {\n            return UtilsModules_1.$$('div', undefined, this.element).el;\n        }\n        else {\n            return UtilsModules_1.$$('div', undefined, '-- NULL --').el;\n        }\n    };\n    GenericHtmlRenderer.prototype.refresh = function (params) {\n        return true;\n    };\n    return GenericHtmlRenderer;\n}());\nexports.GenericHtmlRenderer = GenericHtmlRenderer;\n\n\n/***/ }),\n\n/***/ 808:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ExecutionReportAuthenticationSection_1 = __webpack_require__(819);\nvar ExecutionReportResolvedPipelineSection_1 = __webpack_require__(820);\nvar ExecutionReportQueryOverrideSection_1 = __webpack_require__(821);\nvar ExecutionReportSimpleSection_1 = __webpack_require__(812);\nvar ExecutionReportEffectiveIndexQuerySection_1 = __webpack_require__(822);\nvar UtilsModules_1 = __webpack_require__(86);\nvar ExecutionReportRankingModifiers_1 = __webpack_require__(823);\nvar Core_1 = __webpack_require__(20);\nvar ExecutionReportITDSection_1 = __webpack_require__(824);\nvar EXECUTION_REPORT_SECTION;\n(function (EXECUTION_REPORT_SECTION) {\n    EXECUTION_REPORT_SECTION[\"PERFORM_AUTHENTICATION\"] = \"PerformAuthentication\";\n    EXECUTION_REPORT_SECTION[\"RESOLVE_PIPELINE\"] = \"ResolvePipeline\";\n    EXECUTION_REPORT_SECTION[\"QUERY_PARAM_OVERRIDE\"] = \"ApplyQueryParamOverrideFeature\";\n    EXECUTION_REPORT_SECTION[\"THESAURUS\"] = \"ApplyThesaurusFeature\";\n    EXECUTION_REPORT_SECTION[\"PREPROCESS_QUERY_EXPRESSION\"] = \"PreprocessQueryExpression\";\n    EXECUTION_REPORT_SECTION[\"PREPROCESS_QUERY\"] = \"PreprocessQuery\";\n    EXECUTION_REPORT_SECTION[\"STOP_WORDS\"] = \"ApplyStopWordFeature\";\n    EXECUTION_REPORT_SECTION[\"FILTERS\"] = \"ApplyFilterFeature\";\n    EXECUTION_REPORT_SECTION[\"RANKING\"] = \"ApplyRankingFeature\";\n    EXECUTION_REPORT_SECTION[\"TOP_RESULT\"] = \"ApplyTopResultFeature\";\n    EXECUTION_REPORT_SECTION[\"RANKING_WEIGHT\"] = \"ApplyRankingWeightFeature\";\n    EXECUTION_REPORT_SECTION[\"INDEX_QUERY\"] = \"Send query to index\";\n    EXECUTION_REPORT_SECTION[\"TOP_CLICKS\"] = \"EvaluatingTopClicks\";\n    EXECUTION_REPORT_SECTION[\"PARTIAL_MATCH\"] = \"PartialMatch\";\n    EXECUTION_REPORT_SECTION[\"NONE\"] = \"NONE\";\n})(EXECUTION_REPORT_SECTION = exports.EXECUTION_REPORT_SECTION || (exports.EXECUTION_REPORT_SECTION = {}));\nvar ExecutionReport = /** @class */ (function () {\n    function ExecutionReport(results, bindings) {\n        this.results = results;\n        this.bindings = bindings;\n    }\n    ExecutionReport.standardSectionHeader = function (title) {\n        var container = UtilsModules_1.$$('div');\n        container.append(UtilsModules_1.$$('h4', undefined, title).el);\n        var agGridElement = UtilsModules_1.$$('div', {\n            className: 'ag-theme-fresh'\n        });\n        container.append(agGridElement.el);\n        return {\n            container: container,\n            agGridElement: agGridElement\n        };\n    };\n    ExecutionReport.prototype.build = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var container, gridOptions, authenticationSection, resolvedPipelineSection, resolvedRankingModifiers, queryParamOverrideSection, thesaurusSection, stopWordsSection, filtersSection, rankingSection, topResultsSection, itdSection, rankingWeightsSection, indexQuerySection;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!this.results.executionReport) {\n                            new Core_1.Logger(this).error('Could not open execution report : Missing execution report on results. Try executing the query in debug mode.');\n                            return [2 /*return*/, UtilsModules_1.$$('div')];\n                        }\n                        container = UtilsModules_1.$$('div', {\n                            className: 'execution-report-debug'\n                        });\n                        gridOptions = [];\n                        return [4 /*yield*/, new ExecutionReportAuthenticationSection_1.ExecutionReportAuthenticationSection().build(this.results.executionReport)];\n                    case 1:\n                        authenticationSection = _a.sent();\n                        container.append(authenticationSection.container.el);\n                        if (authenticationSection.gridOptions) {\n                            gridOptions.push(authenticationSection.gridOptions);\n                        }\n                        return [4 /*yield*/, new ExecutionReportResolvedPipelineSection_1.ExecutionReportResolvedPipelineSection().build(this.results.executionReport)];\n                    case 2:\n                        resolvedPipelineSection = _a.sent();\n                        container.append(resolvedPipelineSection.container.el);\n                        if (resolvedPipelineSection.gridOptions) {\n                            gridOptions.push(resolvedPipelineSection.gridOptions);\n                        }\n                        return [4 /*yield*/, new ExecutionReportRankingModifiers_1.ExecutionReportRankingModifiers().build(this.results.results, this.results.rankingExpressions, this.bindings)];\n                    case 3:\n                        resolvedRankingModifiers = _a.sent();\n                        container.append(resolvedRankingModifiers.container.el);\n                        if (resolvedRankingModifiers.gridOptions) {\n                            gridOptions.push(resolvedRankingModifiers.gridOptions);\n                        }\n                        return [4 /*yield*/, new ExecutionReportQueryOverrideSection_1.ExecutionReportQueryOverrideSection().build(this.results.executionReport)];\n                    case 4:\n                        queryParamOverrideSection = _a.sent();\n                        container.append(queryParamOverrideSection.container.el);\n                        if (queryParamOverrideSection.gridOptions) {\n                            gridOptions.push(queryParamOverrideSection.gridOptions);\n                        }\n                        return [4 /*yield*/, new ExecutionReportSimpleSection_1.ExecutionReportSimpleSection(EXECUTION_REPORT_SECTION.PREPROCESS_QUERY_EXPRESSION, EXECUTION_REPORT_SECTION.THESAURUS, 'Thesaurus').build(this.results.executionReport)];\n                    case 5:\n                        thesaurusSection = _a.sent();\n                        container.append(thesaurusSection.container.el);\n                        if (thesaurusSection.gridOptions) {\n                            gridOptions.push(thesaurusSection.gridOptions);\n                        }\n                        return [4 /*yield*/, new ExecutionReportSimpleSection_1.ExecutionReportSimpleSection(EXECUTION_REPORT_SECTION.PREPROCESS_QUERY_EXPRESSION, EXECUTION_REPORT_SECTION.STOP_WORDS, 'Stop words').build(this.results.executionReport)];\n                    case 6:\n                        stopWordsSection = _a.sent();\n                        container.append(stopWordsSection.container.el);\n                        if (stopWordsSection.gridOptions) {\n                            gridOptions.push(stopWordsSection.gridOptions);\n                        }\n                        return [4 /*yield*/, new ExecutionReportSimpleSection_1.ExecutionReportSimpleSection(EXECUTION_REPORT_SECTION.PREPROCESS_QUERY, EXECUTION_REPORT_SECTION.FILTERS, 'Filters').build(this.results.executionReport)];\n                    case 7:\n                        filtersSection = _a.sent();\n                        container.append(filtersSection.container.el);\n                        if (filtersSection.gridOptions) {\n                            gridOptions.push(filtersSection.gridOptions);\n                        }\n                        return [4 /*yield*/, new ExecutionReportSimpleSection_1.ExecutionReportSimpleSection(EXECUTION_REPORT_SECTION.PREPROCESS_QUERY, EXECUTION_REPORT_SECTION.RANKING, 'Ranking').build(this.results.executionReport)];\n                    case 8:\n                        rankingSection = _a.sent();\n                        container.append(rankingSection.container.el);\n                        if (rankingSection.gridOptions) {\n                            gridOptions.push(rankingSection.gridOptions);\n                        }\n                        return [4 /*yield*/, new ExecutionReportSimpleSection_1.ExecutionReportSimpleSection(EXECUTION_REPORT_SECTION.PREPROCESS_QUERY, EXECUTION_REPORT_SECTION.TOP_RESULT, 'Featured Results').build(this.results.executionReport)];\n                    case 9:\n                        topResultsSection = _a.sent();\n                        container.append(topResultsSection.container.el);\n                        if (topResultsSection.gridOptions) {\n                            gridOptions.push(topResultsSection.gridOptions);\n                        }\n                        return [4 /*yield*/, new ExecutionReportITDSection_1.ExecutionReportITDSection().build(this.results.executionReport)];\n                    case 10:\n                        itdSection = _a.sent();\n                        container.append(itdSection.container.el);\n                        if (itdSection.gridOptions) {\n                            gridOptions.push(itdSection.gridOptions);\n                        }\n                        return [4 /*yield*/, new ExecutionReportSimpleSection_1.ExecutionReportSimpleSection(EXECUTION_REPORT_SECTION.PREPROCESS_QUERY, EXECUTION_REPORT_SECTION.RANKING_WEIGHT, 'Ranking weights').build(this.results.executionReport)];\n                    case 11:\n                        rankingWeightsSection = _a.sent();\n                        container.append(rankingWeightsSection.container.el);\n                        if (rankingWeightsSection.gridOptions) {\n                            gridOptions.push(rankingWeightsSection.gridOptions);\n                        }\n                        return [4 /*yield*/, new ExecutionReportEffectiveIndexQuerySection_1.ExecutionReportEffectiveIndexQuerySection().build(this.results.executionReport)];\n                    case 12:\n                        indexQuerySection = _a.sent();\n                        container.append(indexQuerySection.container.el);\n                        this.gridOptions = {\n                            api: {\n                                sizeColumnsToFit: function () {\n                                    gridOptions.forEach(function (option) { return (option.api ? option.api.sizeColumnsToFit() : null); });\n                                }\n                            }\n                        };\n                        return [2 /*return*/, container];\n                }\n            });\n        });\n    };\n    return ExecutionReport;\n}());\nexports.ExecutionReport = ExecutionReport;\n\n\n/***/ }),\n\n/***/ 809:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar TableBuilder_1 = __webpack_require__(807);\nvar underscore_1 = __webpack_require__(0);\nvar Dom_1 = __webpack_require__(1);\nvar defaultNullOutput = '-- NULL --';\nvar GenericValueOutput = /** @class */ (function () {\n    function GenericValueOutput() {\n    }\n    GenericValueOutput.prototype.output = function (section) {\n        if (underscore_1.isArray(section)) {\n            return this.arrayJoined(section);\n        }\n        if (underscore_1.isObject(section)) {\n            return this.objectJoined(section);\n        }\n        return this.simpleValue(section);\n    };\n    GenericValueOutput.prototype.simpleValue = function (section) {\n        return {\n            content: this.valueOrNullOutput(section)\n        };\n    };\n    GenericValueOutput.prototype.objectJoined = function (section) {\n        var _this = this;\n        var content = '';\n        underscore_1.each(section, function (value, key) {\n            if (underscore_1.isArray(value)) {\n                var list = Dom_1.$$('dl');\n                list.append(Dom_1.$$('dt', undefined, key).el);\n                var innerList = Dom_1.$$('dd', undefined, _this.arrayJoined(value).content);\n                list.append(innerList.el);\n                content += list.el.outerHTML;\n            }\n            else if (underscore_1.isObject(value)) {\n                content += _this.objectJoined(value).content;\n            }\n            else {\n                var list = Dom_1.$$('dl');\n                list.append(Dom_1.$$('dt', undefined, key).el);\n                list.append(Dom_1.$$('dd', undefined, _this.valueOrNullOutput(value)).el);\n                content += list.el.outerHTML;\n            }\n        });\n        return {\n            content: content,\n            cellRenderer: TableBuilder_1.GenericHtmlRenderer\n        };\n    };\n    GenericValueOutput.prototype.arrayJoined = function (section) {\n        var _this = this;\n        if (!section || section.length == 0) {\n            return {\n                content: defaultNullOutput\n            };\n        }\n        var list = Dom_1.$$('ul', {\n            className: 'relevance-inspector-list-output'\n        });\n        section.forEach(function (sectionValue) {\n            if (underscore_1.isObject(sectionValue)) {\n                list.append(Dom_1.$$('li', undefined, _this.objectJoined(sectionValue).content).el);\n            }\n            else {\n                list.append(Dom_1.$$('li', undefined, _this.valueOrNullOutput(sectionValue)).el);\n            }\n        });\n        return {\n            content: list.el.outerHTML,\n            cellRenderer: TableBuilder_1.GenericHtmlRenderer\n        };\n    };\n    GenericValueOutput.prototype.valueOrNullOutput = function (value) {\n        if (value != null && value !== '') {\n            return value.toString();\n        }\n        return defaultNullOutput;\n    };\n    return GenericValueOutput;\n}());\nexports.GenericValueOutput = GenericValueOutput;\n\n\n/***/ }),\n\n/***/ 810:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar GenericValueOutput_1 = __webpack_require__(809);\nvar ExecutionReportGenericSection = /** @class */ (function () {\n    function ExecutionReportGenericSection() {\n    }\n    ExecutionReportGenericSection.prototype.build = function (executionReportSection) {\n        return __assign({}, this.descriptionSection(executionReportSection), this.durationSection(executionReportSection));\n    };\n    ExecutionReportGenericSection.prototype.descriptionSection = function (executionReportSection) {\n        return {\n            Description: new GenericValueOutput_1.GenericValueOutput().output(executionReportSection.description)\n        };\n    };\n    ExecutionReportGenericSection.prototype.durationSection = function (executionReportSection) {\n        return {\n            Duration: new GenericValueOutput_1.GenericValueOutput().output(executionReportSection.duration + \" ms\")\n        };\n    };\n    return ExecutionReportGenericSection;\n}());\nexports.ExecutionReportGenericSection = ExecutionReportGenericSection;\n\n\n/***/ }),\n\n/***/ 811:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar underscore_1 = __webpack_require__(0);\nvar StringUtils_1 = __webpack_require__(22);\nvar Dom_1 = __webpack_require__(1);\nexports.buildListOfTermsElement = function (weightPerTerm) {\n    var listItems = underscore_1.map(weightPerTerm, function (value, key) {\n        return {\n            dt: Dom_1.$$('dt', {\n                className: 'coveo-relevance-inspector-dt'\n            }, \"\" + key),\n            dd: Dom_1.$$('dd', {\n                className: 'coveo-relevance-inspector-dd'\n            }, \"\" + value)\n        };\n    });\n    var total = underscore_1.reduce(weightPerTerm, function (memo, value) { return memo + value; }, 0);\n    var list = Dom_1.$$('dl');\n    listItems.forEach(function (item) {\n        list.append(item.dt.el);\n        list.append(item.dd.el);\n    });\n    list.append(Dom_1.$$('dt', { className: 'coveo-relevance-inspector-dt' }, \"Total\").el);\n    list.append(Dom_1.$$('dd', { className: 'coveo-relevance-inspector-dd coveo-relevance-inspector-highlight' }, \"\" + total).el);\n    return list;\n};\nexports.parseRankingInfo = function (value) {\n    var REGEX_EXTRACT_DOCUMENT_WEIGHTS = /Document weights:\\n((?:.)*?)\\n+/g;\n    var REGEX_EXTRACT_TERMS_WEIGHTS = /Terms weights:\\n((?:.|\\n)*)\\n+/g;\n    var REGEX_EXTRACT_TOTAL_WEIGHTS = /Total weight: ([0-9]+)/g;\n    if (value) {\n        var docWeightsRegexResult = REGEX_EXTRACT_DOCUMENT_WEIGHTS.exec(value);\n        var termsWeightRegexResult = REGEX_EXTRACT_TERMS_WEIGHTS.exec(value);\n        var totalWeigthRegexResult = REGEX_EXTRACT_TOTAL_WEIGHTS.exec(value);\n        var qreWeights = parseQREWeights(value);\n        var documentWeights = parseWeights(docWeightsRegexResult ? docWeightsRegexResult[1] : null);\n        var termsWeight = parseTermsWeights(termsWeightRegexResult);\n        var totalWeight = totalWeigthRegexResult ? Number(totalWeigthRegexResult[1]) : null;\n        return {\n            documentWeights: documentWeights,\n            termsWeight: termsWeight,\n            totalWeight: totalWeight,\n            qreWeights: qreWeights\n        };\n    }\n    return null;\n};\nvar parseWeights = function (value) {\n    var REGEX_EXTRACT_LIST_OF_WEIGHTS = /(\\w+(?:\\s\\w+)*): ([-0-9]+)/g;\n    var REGEX_EXTRACT_WEIGHT_GROUP = /^(\\w+(?:\\s\\w+)*): ([-0-9]+)$/;\n    if (value) {\n        var listOfWeight = value.match(REGEX_EXTRACT_LIST_OF_WEIGHTS);\n        if (listOfWeight) {\n            return underscore_1.object(listOfWeight.map(function (weight) {\n                var weightGroup = weight.match(REGEX_EXTRACT_WEIGHT_GROUP);\n                if (weightGroup) {\n                    var weightAppliedOn = weightGroup[1];\n                    var weightValue = weightGroup[2];\n                    return [weightAppliedOn, Number(weightValue)];\n                }\n                return null;\n            }));\n        }\n    }\n    return null;\n};\nvar parseTermsWeights = function (termsWeight) {\n    var REGEX_EXTRACT_GROUP_OF_TERMS = /((?:[^:]+: [0-9]+, [0-9]+; )+)\\n((?:\\w+: [0-9]+; )+)/g;\n    var REGEX_EXTRACT_SINGLE_TERM = /([^:]+): ([0-9]+), ([0-9]+); /g;\n    if (termsWeight && termsWeight[1]) {\n        var terms = StringUtils_1.StringUtils.match(termsWeight[1], REGEX_EXTRACT_GROUP_OF_TERMS);\n        return underscore_1.object(underscore_1.map(terms, function (term) {\n            var words = underscore_1.object(underscore_1.map(StringUtils_1.StringUtils.match(term[1], REGEX_EXTRACT_SINGLE_TERM), function (word) {\n                return [\n                    word[1],\n                    {\n                        Correlation: Number(word[2]),\n                        'TF-IDF': Number(word[3])\n                    }\n                ];\n            }));\n            var weights = parseWeights(term[2]);\n            return [\n                underscore_1.keys(words).join(', '),\n                {\n                    terms: words,\n                    Weights: weights\n                }\n            ];\n        }));\n    }\n    return null;\n};\nvar parseQREWeights = function (value) {\n    var REGEX_EXTRACT_QRE_WEIGHTS = /(Expression:\\s\".*\")\\sScore:\\s(?!0)([-0-9]+)\\n+/g;\n    var qreWeightsRegexResult = REGEX_EXTRACT_QRE_WEIGHTS.exec(value);\n    var qreWeights = [];\n    while (qreWeightsRegexResult) {\n        qreWeights.push({\n            expression: qreWeightsRegexResult[1],\n            score: parseInt(qreWeightsRegexResult[2], 10)\n        });\n        qreWeightsRegexResult = REGEX_EXTRACT_QRE_WEIGHTS.exec(value);\n    }\n    return qreWeights;\n};\n\n\n/***/ }),\n\n/***/ 812:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ExecutionReport_1 = __webpack_require__(808);\nvar underscore_1 = __webpack_require__(0);\nvar ExecutionReportGenericSection_1 = __webpack_require__(810);\nvar GenericValueOutput_1 = __webpack_require__(809);\nvar TableBuilder_1 = __webpack_require__(807);\nvar ExecutionReportSimpleSection = /** @class */ (function () {\n    function ExecutionReportSimpleSection(topLevelProperty, secondLevelProperty, sectionTitle) {\n        this.topLevelProperty = topLevelProperty;\n        this.secondLevelProperty = secondLevelProperty;\n        this.sectionTitle = sectionTitle;\n    }\n    ExecutionReportSimpleSection.prototype.build = function (executionReport) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            var _a, container, agGridElement, gridOptions, topLevelProperty, secondLevelProperty, dataSource, tableBuilder, tableBuilder, _b;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        _a = ExecutionReport_1.ExecutionReport.standardSectionHeader(this.sectionTitle), container = _a.container, agGridElement = _a.agGridElement;\n                        topLevelProperty = underscore_1.find(executionReport.children, function (child) {\n                            return child.name == _this.topLevelProperty && child.children && underscore_1.findWhere(child.children, { name: _this.secondLevelProperty });\n                        });\n                        if (!(topLevelProperty && topLevelProperty.children)) return [3 /*break*/, 3];\n                        secondLevelProperty = underscore_1.findWhere(topLevelProperty.children, { name: this.secondLevelProperty });\n                        if (!secondLevelProperty) return [3 /*break*/, 2];\n                        dataSource = [\n                            __assign({}, new ExecutionReportGenericSection_1.ExecutionReportGenericSection().build(secondLevelProperty), { Applied: new GenericValueOutput_1.GenericValueOutput().output(secondLevelProperty.applied) })\n                        ];\n                        return [4 /*yield*/, new TableBuilder_1.TableBuilder().build(dataSource, agGridElement)];\n                    case 1:\n                        tableBuilder = _c.sent();\n                        gridOptions = tableBuilder.gridOptions;\n                        _c.label = 2;\n                    case 2: return [3 /*break*/, 5];\n                    case 3: return [4 /*yield*/, new TableBuilder_1.TableBuilder().build([\n                            (_b = {},\n                                _b[\"\" + this.sectionTitle] = {\n                                    content: \"NO DATA AVAILABLE FOR \" + this.sectionTitle + \" IN CURRENT EXECUTION REPORT\"\n                                },\n                                _b)\n                        ], agGridElement)];\n                    case 4:\n                        tableBuilder = _c.sent();\n                        gridOptions = tableBuilder.gridOptions;\n                        _c.label = 5;\n                    case 5: return [2 /*return*/, { container: container, gridOptions: gridOptions }];\n                }\n            });\n        });\n    };\n    return ExecutionReportSimpleSection;\n}());\nexports.ExecutionReportSimpleSection = ExecutionReportSimpleSection;\n\n\n/***/ }),\n\n/***/ 813:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar RankingInfoParser_1 = __webpack_require__(811);\nvar underscore_1 = __webpack_require__(0);\nvar TableBuilder_1 = __webpack_require__(807);\nvar Dom_1 = __webpack_require__(1);\nvar RankingInfoTable = /** @class */ (function () {\n    function RankingInfoTable(results, bindings) {\n        this.results = results;\n        this.bindings = bindings;\n    }\n    RankingInfoTable.prototype.build = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            var container, agGridElement, topLevelInfoThatHaveAtLeastANonZeroValue, containsKeywordRankingInfo, data, gridOptions;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        container = Dom_1.$$('div');\n                        agGridElement = Dom_1.$$('div', {\n                            className: 'ag-theme-fresh'\n                        });\n                        container.append(agGridElement.el);\n                        topLevelInfoThatHaveAtLeastANonZeroValue = [];\n                        containsKeywordRankingInfo = false;\n                        this.results.forEach(function (result) {\n                            var rankingInfo = RankingInfoParser_1.parseRankingInfo(result.rankingInfo);\n                            containsKeywordRankingInfo = rankingInfo.termsWeight != null;\n                            if (rankingInfo && rankingInfo.documentWeights) {\n                                underscore_1.each(rankingInfo.documentWeights, function (value, key) {\n                                    if (value != 0) {\n                                        topLevelInfoThatHaveAtLeastANonZeroValue.push(key);\n                                    }\n                                });\n                            }\n                        });\n                        topLevelInfoThatHaveAtLeastANonZeroValue = underscore_1.uniq(topLevelInfoThatHaveAtLeastANonZeroValue);\n                        data = this.results.map(function (result) {\n                            var rankingInfo = RankingInfoParser_1.parseRankingInfo(result.rankingInfo);\n                            if (rankingInfo) {\n                                var documentsWeights = _this.buildTopLevelDocumentsWeights(rankingInfo, topLevelInfoThatHaveAtLeastANonZeroValue);\n                                var breakdownPerTerm_1 = {};\n                                var onlyTopFewKeywords_1 = {};\n                                underscore_1.chain(rankingInfo.termsWeight)\n                                    .keys()\n                                    .sortBy(function (key) {\n                                    var total = underscore_1.reduce(rankingInfo.termsWeight[key].Weights, function (memo, value) { return memo + value; }, 0);\n                                    return total;\n                                })\n                                    .reverse()\n                                    .first(3)\n                                    .each(function (key) {\n                                    onlyTopFewKeywords_1[key] = rankingInfo.termsWeight[key];\n                                });\n                                underscore_1.each(onlyTopFewKeywords_1, function (value, key) {\n                                    var builtKey = \"Keyword: \" + key;\n                                    breakdownPerTerm_1[builtKey] = {\n                                        content: RankingInfoParser_1.buildListOfTermsElement(value.Weights).el.outerHTML,\n                                        cellRenderer: TableBuilder_1.GenericHtmlRenderer,\n                                        width: 200\n                                    };\n                                });\n                                var totalContent = rankingInfo.totalWeight ? rankingInfo.totalWeight : 0;\n                                return __assign({}, TableBuilder_1.TableBuilder.thumbnailCell(result, _this.bindings), documentsWeights, breakdownPerTerm_1, { Total: { content: totalContent || 0 } });\n                            }\n                            return {};\n                        });\n                        return [4 /*yield*/, new TableBuilder_1.TableBuilder().build(data, agGridElement, {\n                                getRowHeight: function () {\n                                    return containsKeywordRankingInfo ? 400 : 250;\n                                },\n                                onGridReady: function (params) {\n                                    setTimeout(function () {\n                                        if (params) {\n                                            params.api.sizeColumnsToFit();\n                                            params.api.setSortModel([{ colId: 'Total', sort: 'desc' }]);\n                                        }\n                                    }, 0);\n                                }\n                            })];\n                    case 1:\n                        gridOptions = (_a.sent()).gridOptions;\n                        this.gridOptions = gridOptions;\n                        return [2 /*return*/, container];\n                }\n            });\n        });\n    };\n    RankingInfoTable.prototype.buildTopLevelDocumentsWeights = function (rankingInfo, hasAtLeastOneNonZeroValue) {\n        var documentWeights = {};\n        underscore_1.each(rankingInfo.documentWeights || {}, function (value, key) {\n            if (underscore_1.contains(hasAtLeastOneNonZeroValue, key))\n                documentWeights[key] = { content: value || 0 };\n        });\n        return documentWeights;\n    };\n    return RankingInfoTable;\n}());\nexports.RankingInfoTable = RankingInfoTable;\n\n\n/***/ }),\n\n/***/ 814:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Dom_1 = __webpack_require__(1);\nvar isAgGridLoaded = false;\nvar isAgGridLoading = null;\nvar agGridLibUrl = 'https://cdnjs.cloudflare.com/ajax/libs/ag-grid/16.0.1/ag-grid.min.noStyle.js';\nvar agGridStyleBaseUrl = 'https://cdnjs.cloudflare.com/ajax/libs/ag-grid/16.0.1/styles/ag-grid.css';\nvar agGridStyleFreshUrl = 'https://cdnjs.cloudflare.com/ajax/libs/ag-grid/16.0.1/styles/ag-theme-fresh.css';\n// Should only be used for UT\nexports.reset = function (doc) {\n    if (doc === void 0) { doc = document; }\n    isAgGridLoaded = false;\n    isAgGridLoading = null;\n};\nexports.loadAgGridLibrary = function (doc) {\n    if (doc === void 0) { doc = document; }\n    return new Promise(function (resolve, reject) {\n        if (isAgGridLoaded) {\n            resolve(true);\n        }\n        else if (typeof agGrid !== 'undefined') {\n            isAgGridLoaded = true;\n            resolve(true);\n        }\n        else {\n            addAgGridScriptsToDocument(doc);\n            isAgGridLoading.then(function () { return resolve(true); });\n            isAgGridLoading.catch(function () { return reject(false); });\n        }\n    });\n};\nvar addAgGridScriptsToDocument = function (doc) {\n    if (doc === void 0) { doc = document; }\n    if (!isAgGridLoading) {\n        var script_1 = Dom_1.$$('script', {\n            src: agGridLibUrl,\n            type: 'text/javascript',\n            async: true\n        }).el;\n        var styleBase = Dom_1.$$('link', {\n            href: agGridStyleBaseUrl,\n            rel: 'stylesheet',\n            type: 'text/css'\n        }).el;\n        var style = Dom_1.$$('link', {\n            href: agGridStyleFreshUrl,\n            rel: 'stylesheet',\n            type: 'text/css'\n        }).el;\n        doc.head.appendChild(script_1);\n        doc.head.appendChild(styleBase);\n        doc.head.appendChild(style);\n        isAgGridLoading = new Promise(function (resolveScriptLoaded, rejectScriptLoaded) {\n            script_1.onload = function () {\n                resolveScriptLoaded(true);\n            };\n            script_1.onerror = function () {\n                isAgGridLoaded = false;\n                rejectScriptLoaded(false);\n            };\n        });\n    }\n};\n\n\n/***/ }),\n\n/***/ 815:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar TableBuilder_1 = __webpack_require__(807);\nvar underscore_1 = __webpack_require__(0);\nvar Dom_1 = __webpack_require__(1);\nvar StringUtils_1 = __webpack_require__(22);\nvar DateUtils_1 = __webpack_require__(33);\nvar TextInput_1 = __webpack_require__(56);\nvar MetaDataTable = /** @class */ (function () {\n    function MetaDataTable(results, bindings) {\n        this.results = results;\n        this.bindings = bindings;\n    }\n    MetaDataTable.prototype.build = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            var fieldsDescription, container, builders, builtTables, textInput;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!this.bindings.queryController) {\n                            return [2 /*return*/];\n                        }\n                        return [4 /*yield*/, this.bindings.queryController.getEndpoint().listFields()];\n                    case 1:\n                        fieldsDescription = _a.sent();\n                        container = Dom_1.$$('div', {\n                            className: 'metadata-table'\n                        });\n                        builders = this.results.map(function (result) { return __awaiter(_this, void 0, void 0, function () {\n                            var nestedContainer, nestedAgGrid, thumbnail, fields;\n                            return __generator(this, function (_a) {\n                                switch (_a.label) {\n                                    case 0:\n                                        nestedContainer = Dom_1.$$('div');\n                                        container.append(nestedContainer.el);\n                                        nestedAgGrid = Dom_1.$$('div', {\n                                            className: 'ag-theme-fresh'\n                                        });\n                                        nestedContainer.append(nestedAgGrid.el);\n                                        thumbnail = TableBuilder_1.TableBuilder.thumbnailCell(result, this.bindings);\n                                        fields = {};\n                                        fields[\"Fields Values\"] = {\n                                            content: { result: result, fieldsDescription: fieldsDescription },\n                                            cellRenderer: FieldValuesRenderer,\n                                            width: 900,\n                                            getQuickFilterText: function (params) {\n                                                var allValues = underscore_1.map(params.value.result.raw, function (val) { return val.toString(); });\n                                                return Object.keys(params.value.result.raw)\n                                                    .concat(allValues)\n                                                    .join(' ');\n                                            },\n                                            onCellDoubleClicked: function (params) {\n                                                var el = params.event ? params.event.target : null;\n                                                if (el && window.getSelection && document.createRange) {\n                                                    var selection = window.getSelection();\n                                                    var range = document.createRange();\n                                                    range.selectNodeContents(el);\n                                                    selection.removeAllRanges();\n                                                    selection.addRange(range);\n                                                }\n                                            }\n                                        };\n                                        return [4 /*yield*/, new TableBuilder_1.TableBuilder().build([\n                                                __assign({}, thumbnail, fields)\n                                            ], nestedAgGrid, {\n                                                rowHeight: 400\n                                            })];\n                                    case 1: return [2 /*return*/, _a.sent()];\n                                }\n                            });\n                        }); });\n                        this.gridOptions = {\n                            api: {\n                                sizeColumnsToFit: function () {\n                                    builtTables.forEach(function (built) { return (built.gridOptions.api ? built.gridOptions.api.sizeColumnsToFit : null); });\n                                }\n                            }\n                        };\n                        return [4 /*yield*/, Promise.all(builders)];\n                    case 2:\n                        builtTables = _a.sent();\n                        textInput = new TextInput_1.TextInput(function (input) {\n                            builtTables.forEach(function (built) {\n                                var api = built.gridOptions && built.gridOptions.api;\n                                if (api) {\n                                    api.setQuickFilter(input.getValue());\n                                    api.onRowHeightChanged();\n                                }\n                            });\n                        }, 'Filters on Fields Values');\n                        container.prepend(textInput.getElement());\n                        return [2 /*return*/, container];\n                }\n            });\n        });\n    };\n    return MetaDataTable;\n}());\nexports.MetaDataTable = MetaDataTable;\nvar FieldValuesRenderer = /** @class */ (function () {\n    function FieldValuesRenderer() {\n    }\n    FieldValuesRenderer.prototype.init = function (params) {\n        this.element = params.value;\n        this.params = params;\n        this.currentFilter = params.api.filterManager.quickFilter;\n        params.value.el = this.listAsInput(this.element.result);\n    };\n    FieldValuesRenderer.prototype.getGui = function () {\n        if (this.element) {\n            var list = this.listAsInput(this.element.result);\n            this.params.eParentOfValue.appendChild(list.el);\n            var height = Math.max(list.height() + 50, 200);\n            var maxHeight = Math.min(height, 5000);\n            this.params.node.setRowHeight(maxHeight);\n            return Dom_1.$$('div', undefined, list).el;\n        }\n        return Dom_1.$$('div', undefined, 'N.A').el;\n    };\n    FieldValuesRenderer.prototype.listAsInput = function (result) {\n        var _this = this;\n        var container = Dom_1.$$('div');\n        underscore_1.each(result.raw, function (value, fieldInResult) {\n            if (fieldInResult == 'allmetadatavalues' || fieldInResult.indexOf('sys') == 0) {\n                return;\n            }\n            if (_this.isCurrentElementFilteredOut(value, fieldInResult)) {\n                return;\n            }\n            var inputGroup = Dom_1.$$('div', { className: 'coveo-relevance-inspector-input-group' });\n            var fieldName = Dom_1.$$('div', {\n                className: 'coveo-relevance-inspector-metadata-name'\n            }, fieldInResult);\n            var fieldValue = _this.convertFieldValueToReadableFormat(result, fieldInResult);\n            var fieldValueElement = Dom_1.$$('div', {\n                className: 'coveo-relevance-inspector-metadata-value'\n            }, fieldValue);\n            if (_this.currentFilter) {\n                _this.highlightSearch(fieldName.el, _this.currentFilter);\n                _this.highlightSearch(fieldValueElement.el, _this.currentFilter);\n            }\n            inputGroup.append(fieldName.el);\n            inputGroup.append(fieldValueElement.el);\n            container.append(inputGroup.el);\n        });\n        return container;\n    };\n    FieldValuesRenderer.prototype.isCurrentElementFilteredOut = function (value, fieldInResult) {\n        if (this.currentFilter) {\n            var matchInFieldName = fieldInResult.toLowerCase().indexOf(this.currentFilter.toLowerCase()) != -1;\n            var matchInFieldValue = value\n                ? value\n                    .toString()\n                    .toLowerCase()\n                    .indexOf(this.currentFilter.toLowerCase()) != -1\n                : false;\n            if (!matchInFieldName && !matchInFieldValue) {\n                return true;\n            }\n        }\n        return false;\n    };\n    FieldValuesRenderer.prototype.convertFieldValueToReadableFormat = function (result, fieldInResult) {\n        var fieldValue = result.raw[fieldInResult].toString();\n        if (this.element.fieldsDescription) {\n            var matchingFieldDescription = underscore_1.find(this.element.fieldsDescription, function (description) {\n                return description.name.replace('@', '').toLowerCase() == fieldInResult;\n            });\n            if (matchingFieldDescription && matchingFieldDescription.fieldType == 'Date') {\n                fieldValue = DateUtils_1.DateUtils.convertToStandardDate(fieldValue).toString() + \" ( Epoch : \" + fieldValue + \" )\";\n            }\n        }\n        return fieldValue;\n    };\n    FieldValuesRenderer.prototype.highlightSearch = function (elementToSearch, search) {\n        var asHTMLElement = elementToSearch;\n        if (asHTMLElement != null && asHTMLElement.innerText != null) {\n            var match = asHTMLElement.innerText.split(new RegExp('(?=' + StringUtils_1.StringUtils.regexEncode(search) + ')', 'gi'));\n            asHTMLElement.innerHTML = '';\n            match.forEach(function (value) {\n                var regex = new RegExp('(' + StringUtils_1.StringUtils.regexEncode(search) + ')', 'i');\n                var group = value.match(regex);\n                var span;\n                if (group != null) {\n                    span = Dom_1.$$('span', {\n                        className: 'coveo-relevance-inspector-highlight'\n                    });\n                    span.text(group[1]);\n                    asHTMLElement.appendChild(span.el);\n                    span = Dom_1.$$('span');\n                    span.text(value.substr(group[1].length));\n                    asHTMLElement.appendChild(span.el);\n                }\n                else {\n                    span = Dom_1.$$('span');\n                    span.text(value);\n                    asHTMLElement.appendChild(span.el);\n                }\n            });\n        }\n    };\n    FieldValuesRenderer.prototype.refresh = function (params) {\n        return true;\n    };\n    return FieldValuesRenderer;\n}());\nexports.FieldValuesRenderer = FieldValuesRenderer;\n\n\n/***/ }),\n\n/***/ 816:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Dom_1 = __webpack_require__(1);\nvar underscore_1 = __webpack_require__(0);\nvar RelevanceInspectorTabs = /** @class */ (function () {\n    function RelevanceInspectorTabs(onTabChange) {\n        this.onTabChange = onTabChange;\n        this.navigationSection = Dom_1.$$('div', {\n            className: 'coveo-relevance-inspector-tab-navigation-section'\n        });\n        this.tabContentSection = Dom_1.$$('div', {\n            className: 'coveo-relevance-inspector-tab-content-section'\n        });\n        this.navigationElements = [];\n        this.tabContentElements = [];\n    }\n    RelevanceInspectorTabs.prototype.select = function (id) {\n        var navElementToActivate = this.findNavigationById(id);\n        var tabContentToActivate = this.findTabContentById(id);\n        if (navElementToActivate && tabContentToActivate) {\n            this.activateTabNavigation(navElementToActivate);\n            this.activateTabContent(tabContentToActivate);\n            if (this.onTabChange) {\n                this.onTabChange(id);\n            }\n        }\n    };\n    RelevanceInspectorTabs.prototype.addNavigation = function (caption, id) {\n        var _this = this;\n        var navigationElement = Dom_1.$$('div', {\n            id: id,\n            className: 'coveo-relevance-inspector-tab'\n        }, caption);\n        navigationElement.on('click', function () { return _this.select(id); });\n        this.navigationElements.push(navigationElement);\n        this.navigationSection.append(navigationElement.el);\n        return this;\n    };\n    RelevanceInspectorTabs.prototype.addContent = function (content, targetId) {\n        var tabContent = Dom_1.$$('div', {\n            className: 'coveo-relevance-inspector-tab-content',\n            'data-target-tab': targetId\n        });\n        tabContent.append(content.el);\n        this.tabContentElements.push(tabContent);\n        this.tabContentSection.append(tabContent.el);\n        return this;\n    };\n    RelevanceInspectorTabs.prototype.addSection = function (caption, content, id) {\n        return this.addNavigation(caption, id).addContent(content, id);\n    };\n    RelevanceInspectorTabs.prototype.findNavigationById = function (id) {\n        return underscore_1.find(this.navigationElements, function (element) { return element.getAttribute('id') == id; });\n    };\n    RelevanceInspectorTabs.prototype.findTabContentById = function (id) {\n        return underscore_1.find(this.tabContentElements, function (tabContentElement) { return tabContentElement.getAttribute('data-target-tab') == id; });\n    };\n    RelevanceInspectorTabs.prototype.activateTabNavigation = function (navigationElement) {\n        this.navigationElements.forEach(function (element) {\n            element.removeClass('coveo-selected');\n        });\n        navigationElement.addClass('coveo-selected');\n    };\n    RelevanceInspectorTabs.prototype.activateTabContent = function (contentElement) {\n        this.tabContentElements.forEach(function (element) {\n            element.removeClass('coveo-selected');\n        });\n        contentElement.addClass('coveo-selected');\n    };\n    return RelevanceInspectorTabs;\n}());\nexports.RelevanceInspectorTabs = RelevanceInspectorTabs;\n\n\n/***/ }),\n\n/***/ 817:\n/***/ (function(module, exports, __webpack_require__) {\n\n// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(818);\nif(typeof content === 'string') content = [[module.i, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {\"hmr\":true}\noptions.transform = transform\n// add the styles to the DOM\nvar update = __webpack_require__(709)(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(false) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../node_modules/css-loader/index.js??ref--0-2!../node_modules/resolve-url-loader/index.js??ref--0-3!../node_modules/sass-loader/lib/loader.js??ref--0-4!./_RelevanceInspector.scss\", function() {\n\t\t\tvar newContent = require(\"!!../node_modules/css-loader/index.js??ref--0-2!../node_modules/resolve-url-loader/index.js??ref--0-3!../node_modules/sass-loader/lib/loader.js??ref--0-4!./_RelevanceInspector.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n/***/ }),\n\n/***/ 818:\n/***/ (function(module, exports, __webpack_require__) {\n\nexports = module.exports = __webpack_require__(708)();\n// imports\n\n\n// module\nexports.push([module.i, \"@keyframes fadeout{0%{opacity:1}to{opacity:0}}@keyframes fadein{0%{opacity:0}to{opacity:1}}@keyframes slideInLeft{0%{transform:translateX(-2000px);opacity:0}to{transform:translateX(0);opacity:1}}@keyframes coveo-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes loadingFade{0%{opacity:0}50%{opacity:.8}to{opacity:0}}.coveo-relevance-inspector{text-align:center;padding:10px;line-height:20px;height:40px;top:0;z-index:1000}.coveo-relevance-inspector.coveo-hidden{display:none}.relevance-inspector-modal .coveo-logo{height:64px;width:178px}.ag-theme-fresh .ag-cell{overflow:auto;white-space:normal;word-break:break-word}.ag-theme-fresh .ag-font-style{user-select:auto}.coveo-relevance-inspector-tab-navigation-section{margin-bottom:20px}.coveo-relevance-inspector-tab-content{display:none}.coveo-relevance-inspector-tab-content.coveo-selected{display:block;animation:slideInLeft .3s ease-in}.coveo-relevance-inspector-tab{display:-moz-flex;display:-ms-flexbox;display:flex;box-align:center;-moz-align-items:center;-ms-align-items:center;-o-align-items:center;align-items:center;-ms-flex-align:center;font-size:12px;font-weight:700;padding:0 5px 10px;border-bottom:1px solid #bcc3ca;text-transform:uppercase;border-bottom:2px solid #bcc3ca;display:inline-block;margin-right:10px}.coveo-relevance-inspector-tab.coveo-selected,.coveo-relevance-inspector-tab.coveo-selected:hover{border-bottom:2px solid #263e55}.coveo-relevance-inspector-tab:hover{color:#263e55}.coveo-relevance-inspector-highlight{display:inline-block;font-weight:700}.coveo-relevance-inspector-result-thumbnail{min-width:500px;white-space:normal}.coveo-relevance-inspector-dt{font-weight:700}.coveo-relevance-inspector-dd,.coveo-relevance-inspector-dt{font-size:14px;line-height:14px;padding:2px 0 4px}.coveo-relevance-inspector-metadata-name,.coveo-relevance-inspector-metadata-value{background-color:#e9ecef;display:block;padding:10px;line-height:1.5;border:1px solid #ced4da;border-radius:2px;position:relative;flex:1 1 auto;margin-bottom:0}.coveo-relevance-inspector-metadata-name{max-width:25%;min-width:25%}.coveo-relevance-inspector-metadata-value{width:75%;overflow:auto}.coveo-relevance-inspector-input-group{position:relative;display:flex;flex-wrap:wrap;align-items:stretch;width:100%}.coveo-relevance-inspector-tab-content .coveo-input{margin:40px 0 10px}.coveo-relevance-inspector-available-fields-popup{background:#fff;border:1px solid #bcc3ca;border-radius:2px;padding:10px 5px 10px 20px;width:200px;overflow:hidden;list-style-type:none}.coveo-relevance-inspector-available-fields-popup-value{padding:0 0 10px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.coveo-available-fields-table-button{overflow:hidden;display:inline-block;position:relative;top:50%;transform:translateY(-50%)}.coveo-relevance-inspector-effective-query-collapsible{display:none}.coveo-relevance-inspector-effective-query-collapsible.coveo-active{display:inherit}.coveo-relevance-inspector-table{width:100%;text-align:left;border:none;border-spacing:0}.coveo-relevance-inspector-table tr{height:37px;font-size:15px;line-height:18px}.coveo-relevance-inspector-table tr:first-child{padding-left:10px}.coveo-relevance-inspector-table tr:hover td{background-color:#e6ecf0}.coveo-relevance-inspector-table td{position:relative;vertical-align:middle;padding:9px 15px;margin-left:15px;text-align:left;border-bottom:1px solid #bcc3ca}.coveo-relevance-inspector-table td:first-child{border-left:5px solid transparent}.coveo-relevance-inspector-inline-ranking{border:1px solid #bcc3ca;border-radius:2px;display:-moz-flex;display:-ms-flexbox;display:flex;-webkit-box-lines:multiple;-moz-box-lines:multiple;box-lines:multiple;-ms-flex-wrap:wrap;flex-wrap:wrap;padding:10px;margin-bottom:10px}.coveo-relevance-inspector-inline-ranking-section{margin:10px}.coveo-relevance-inspector-inline-ranking-terms{display:none;padding:10px;width:100%}.coveo-relevance-inspector-inline-ranking-terms.coveo-active{display:block;animation:fadein .5s}.coveo-relevance-inspector-inline-ranking-terms h2{border-bottom:1px solid #bcc3ca}.coveo-relevance-inspector-inline-ranking-terms dl{display:-moz-flex;display:-ms-flexbox;display:flex;-webkit-box-lines:multiple;-moz-box-lines:multiple;box-lines:multiple;-ms-flex-wrap:wrap;flex-wrap:wrap;box-align:center;-moz-align-items:center;-ms-align-items:center;-o-align-items:center;align-items:center;-ms-flex-align:center}.coveo-relevance-inspector-inline-ranking-terms dt{margin:10px 20px}.coveo-relevance-inspector-inline-ranking-terms dd{margin-left:0}.coveo-relevance-inspector-inline-ranking-button{height:35px;margin:5px 0}.relevance-inspector-list-output{padding-left:5px;margin-top:0}.coveo-relevance-inspector-inline-ranking-qre-expression{font-weight:700;word-break:break-all}\", \"\"]);\n\n// exports\n\n\n/***/ }),\n\n/***/ 819:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ExecutionReport_1 = __webpack_require__(808);\nvar TableBuilder_1 = __webpack_require__(807);\nvar underscore_1 = __webpack_require__(0);\nvar ExecutionReportGenericSection_1 = __webpack_require__(810);\nvar GenericValueOutput_1 = __webpack_require__(809);\nvar ExecutionReportAuthenticationSection = /** @class */ (function () {\n    function ExecutionReportAuthenticationSection() {\n    }\n    ExecutionReportAuthenticationSection.prototype.build = function (executionReport) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, container, agGridElement, gridOptions, authenticationSection, dataSource, tableBuilder;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        _a = ExecutionReport_1.ExecutionReport.standardSectionHeader('Authentication'), container = _a.container, agGridElement = _a.agGridElement;\n                        authenticationSection = underscore_1.find(executionReport.children, function (child) { return child.name == ExecutionReport_1.EXECUTION_REPORT_SECTION.PERFORM_AUTHENTICATION; });\n                        if (!authenticationSection) return [3 /*break*/, 2];\n                        dataSource = [\n                            __assign({}, new ExecutionReportGenericSection_1.ExecutionReportGenericSection().build(authenticationSection), this.configurationSection(authenticationSection), this.pipelineOuputSection(authenticationSection))\n                        ];\n                        return [4 /*yield*/, new TableBuilder_1.TableBuilder().build(dataSource, agGridElement, {\n                                rowHeight: 150\n                            })];\n                    case 1:\n                        tableBuilder = _b.sent();\n                        gridOptions = tableBuilder.gridOptions;\n                        _b.label = 2;\n                    case 2: return [2 /*return*/, { container: container, gridOptions: gridOptions }];\n                }\n            });\n        });\n    };\n    ExecutionReportAuthenticationSection.prototype.configurationSection = function (authenticationSection) {\n        return {\n            Configured: {\n                children: [\n                    {\n                        Primary: this.genericOutput(authenticationSection.configured.primary),\n                        Secondary: this.genericOutput(authenticationSection.configured.secondary),\n                        Mandatory: this.genericOutput(authenticationSection.configured.mandatory)\n                    }\n                ]\n            }\n        };\n    };\n    ExecutionReportAuthenticationSection.prototype.pipelineOuputSection = function (authenticationSection) {\n        return {\n            'Pipeline Output': {\n                children: [\n                    {\n                        'User ids': {\n                            children: this.usersIds(authenticationSection.result.userIds)\n                        },\n                        'Query restriction': {\n                            children: this.queryRestrictions(authenticationSection.result.queryRestrictions)\n                        },\n                        Roles: __assign({}, this.genericOutput(authenticationSection.result.roles), { width: 200 }),\n                        'User groups': this.genericOutput(authenticationSection.result.userGroups)\n                    }\n                ]\n            }\n        };\n    };\n    ExecutionReportAuthenticationSection.prototype.usersIds = function (userIds) {\n        var _this = this;\n        return underscore_1.map(userIds, function (userId) {\n            return _a = {},\n                _a[userId.name] = {\n                    children: [\n                        {\n                            Kind: _this.genericOutput(userId.kind),\n                            Provider: __assign({}, _this.genericOutput(userId.provider), { width: 150 }),\n                            Info: { content: userId.info }\n                        }\n                    ]\n                },\n                _a;\n            var _a;\n        });\n    };\n    ExecutionReportAuthenticationSection.prototype.genericOutput = function (section) {\n        return new GenericValueOutput_1.GenericValueOutput().output(section);\n    };\n    ExecutionReportAuthenticationSection.prototype.queryRestrictions = function (queryRestrictions) {\n        var _this = this;\n        return underscore_1.map(queryRestrictions, function (value, key) {\n            return _a = {},\n                _a[key] = _this.genericOutput(value),\n                _a;\n            var _a;\n        });\n    };\n    return ExecutionReportAuthenticationSection;\n}());\nexports.ExecutionReportAuthenticationSection = ExecutionReportAuthenticationSection;\n\n\n/***/ }),\n\n/***/ 820:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ExecutionReport_1 = __webpack_require__(808);\nvar underscore_1 = __webpack_require__(0);\nvar ExecutionReportGenericSection_1 = __webpack_require__(810);\nvar TableBuilder_1 = __webpack_require__(807);\nvar GenericValueOutput_1 = __webpack_require__(809);\nvar ExecutionReportResolvedPipelineSection = /** @class */ (function () {\n    function ExecutionReportResolvedPipelineSection() {\n    }\n    ExecutionReportResolvedPipelineSection.prototype.build = function (executionReport) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, container, agGridElement, gridOptions, resolvedPipelineSection, dataSource, tableBuilder;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        _a = ExecutionReport_1.ExecutionReport.standardSectionHeader('Pipeline'), container = _a.container, agGridElement = _a.agGridElement;\n                        resolvedPipelineSection = underscore_1.find(executionReport.children, function (child) { return child.name == ExecutionReport_1.EXECUTION_REPORT_SECTION.RESOLVE_PIPELINE; });\n                        if (!resolvedPipelineSection) return [3 /*break*/, 2];\n                        dataSource = [\n                            __assign({}, new ExecutionReportGenericSection_1.ExecutionReportGenericSection().build(resolvedPipelineSection), { Pipeline: new GenericValueOutput_1.GenericValueOutput().output(resolvedPipelineSection.result.pipeline) }, { 'Split Test': new GenericValueOutput_1.GenericValueOutput().output(resolvedPipelineSection.result.splitTest) })\n                        ];\n                        return [4 /*yield*/, new TableBuilder_1.TableBuilder().build(dataSource, agGridElement)];\n                    case 1:\n                        tableBuilder = _b.sent();\n                        gridOptions = tableBuilder.gridOptions;\n                        _b.label = 2;\n                    case 2: return [2 /*return*/, { container: container, gridOptions: gridOptions }];\n                }\n            });\n        });\n    };\n    return ExecutionReportResolvedPipelineSection;\n}());\nexports.ExecutionReportResolvedPipelineSection = ExecutionReportResolvedPipelineSection;\n\n\n/***/ }),\n\n/***/ 821:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ExecutionReport_1 = __webpack_require__(808);\nvar underscore_1 = __webpack_require__(0);\nvar ExecutionReportGenericSection_1 = __webpack_require__(810);\nvar TableBuilder_1 = __webpack_require__(807);\nvar GenericValueOutput_1 = __webpack_require__(809);\nvar ExecutionReportQueryOverrideSection = /** @class */ (function () {\n    function ExecutionReportQueryOverrideSection() {\n    }\n    ExecutionReportQueryOverrideSection.prototype.build = function (executionReport) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, container, agGridElement, gridOptions, queryOverrideSection, dataSource, tableBuilder;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        _a = ExecutionReport_1.ExecutionReport.standardSectionHeader('Query Params Override'), container = _a.container, agGridElement = _a.agGridElement;\n                        queryOverrideSection = underscore_1.find(executionReport.children, function (child) { return child.name == ExecutionReport_1.EXECUTION_REPORT_SECTION.QUERY_PARAM_OVERRIDE; });\n                        if (!queryOverrideSection) return [3 /*break*/, 2];\n                        dataSource = [\n                            __assign({}, new ExecutionReportGenericSection_1.ExecutionReportGenericSection().build(queryOverrideSection), { Applied: new GenericValueOutput_1.GenericValueOutput().output(queryOverrideSection.applied) })\n                        ];\n                        return [4 /*yield*/, new TableBuilder_1.TableBuilder().build(dataSource, agGridElement)];\n                    case 1:\n                        tableBuilder = _b.sent();\n                        gridOptions = tableBuilder.gridOptions;\n                        _b.label = 2;\n                    case 2: return [2 /*return*/, { container: container, gridOptions: gridOptions }];\n                }\n            });\n        });\n    };\n    return ExecutionReportQueryOverrideSection;\n}());\nexports.ExecutionReportQueryOverrideSection = ExecutionReportQueryOverrideSection;\n\n\n/***/ }),\n\n/***/ 822:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ExecutionReport_1 = __webpack_require__(808);\nvar underscore_1 = __webpack_require__(0);\nvar GenericValueOutput_1 = __webpack_require__(809);\nvar Dom_1 = __webpack_require__(1);\nvar collapsibleSectionsInReport = ['Facets', 'RankingOverrides', 'RankingExpressions'];\nvar ExecutionReportEffectiveIndexQuerySection = /** @class */ (function () {\n    function ExecutionReportEffectiveIndexQuerySection() {\n    }\n    ExecutionReportEffectiveIndexQuerySection.prototype.build = function (executionReport) {\n        return __awaiter(this, void 0, void 0, function () {\n            var container, table, indexQuerySection;\n            return __generator(this, function (_a) {\n                container = ExecutionReport_1.ExecutionReport.standardSectionHeader('Query sent to index').container;\n                table = Dom_1.$$('table', {\n                    className: 'coveo-relevance-inspector-table'\n                });\n                container.append(table.el);\n                indexQuerySection = underscore_1.findWhere(executionReport.children, { description: ExecutionReport_1.EXECUTION_REPORT_SECTION.INDEX_QUERY });\n                if (indexQuerySection) {\n                    underscore_1.each(indexQuerySection.result.in, function (paramValue, paramKey) {\n                        var row = Dom_1.$$('tr');\n                        table.append(row.el);\n                        var id = \"executionReportIndexExecution\" + paramKey;\n                        if (underscore_1.contains(collapsibleSectionsInReport, paramKey) && paramValue) {\n                            var btn = Dom_1.$$('button', {\n                                className: 'coveo-button',\n                                type: 'button'\n                            }, paramKey);\n                            var tdTarget_1 = Dom_1.$$('td', {\n                                id: id,\n                                className: 'coveo-relevance-inspector-effective-query-collapsible'\n                            }, new GenericValueOutput_1.GenericValueOutput().output(paramValue).content);\n                            btn.on('click', function () {\n                                tdTarget_1.toggleClass('coveo-active');\n                            });\n                            row.append(Dom_1.$$('td', undefined, btn).el);\n                            row.append(tdTarget_1.el);\n                        }\n                        else {\n                            row.append(Dom_1.$$('td', undefined, paramKey).el);\n                            row.append(Dom_1.$$('td', undefined, new GenericValueOutput_1.GenericValueOutput().output(paramValue).content).el);\n                        }\n                    });\n                }\n                return [2 /*return*/, { container: container }];\n            });\n        });\n    };\n    return ExecutionReportEffectiveIndexQuerySection;\n}());\nexports.ExecutionReportEffectiveIndexQuerySection = ExecutionReportEffectiveIndexQuerySection;\n\n\n/***/ }),\n\n/***/ 823:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ExecutionReport_1 = __webpack_require__(808);\nvar TableBuilder_1 = __webpack_require__(807);\nvar underscore_1 = __webpack_require__(0);\nvar GenericValueOutput_1 = __webpack_require__(809);\nvar QueryBuilder_1 = __webpack_require__(48);\nvar ExecutionReportRankingModifiers = /** @class */ (function () {\n    function ExecutionReportRankingModifiers() {\n    }\n    ExecutionReportRankingModifiers.prototype.build = function (results, rankingExpressions, bindings) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            var _a, container, agGridElement, dataSourcePromises, dataSource, gridOptions;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        _a = ExecutionReport_1.ExecutionReport.standardSectionHeader('Ranking Modifiers & Machine Learning Boosts'), container = _a.container, agGridElement = _a.agGridElement;\n                        dataSourcePromises = underscore_1.map(rankingExpressions, function (rankingExpression) { return __awaiter(_this, void 0, void 0, function () {\n                            var isAutomaticBoostRegex, thumbnailPreview, returnedByIndexForCurrentQuery, result, isAutomaticBoost, permanentIDUsedInAutomaticBoost, extracted;\n                            return __generator(this, function (_a) {\n                                switch (_a.label) {\n                                    case 0:\n                                        isAutomaticBoostRegex = /^(@permanentid|@urihash)=\"?([a-zA-Z0-9]+)\"?$/;\n                                        thumbnailPreview = TableBuilder_1.TableBuilder.thumbnailCell(null, null);\n                                        returnedByIndexForCurrentQuery = '-- NULL --';\n                                        result = null;\n                                        isAutomaticBoost = rankingExpression.expression.match(isAutomaticBoostRegex);\n                                        if (!isAutomaticBoost) return [3 /*break*/, 2];\n                                        permanentIDUsedInAutomaticBoost = isAutomaticBoost[2];\n                                        return [4 /*yield*/, this.extractDocumentInfoFromBoost(results, permanentIDUsedInAutomaticBoost, rankingExpression, bindings)];\n                                    case 1:\n                                        extracted = _a.sent();\n                                        thumbnailPreview = TableBuilder_1.TableBuilder.thumbnailCell(extracted.result, bindings);\n                                        result = extracted.result;\n                                        returnedByIndexForCurrentQuery = extracted.returnedByIndexForCurrentQuery.toString();\n                                        _a.label = 2;\n                                    case 2: return [2 /*return*/, __assign({}, thumbnailPreview, { ReturnedByIndexForCurrentQuery: new GenericValueOutput_1.GenericValueOutput().output(returnedByIndexForCurrentQuery), IsRecommendation: new GenericValueOutput_1.GenericValueOutput().output(result ? result.isRecommendation : '-- NULL --'), Expression: __assign({}, new GenericValueOutput_1.GenericValueOutput().output(rankingExpression.expression), { width: 150 }), Modifier: new GenericValueOutput_1.GenericValueOutput().output(rankingExpression.modifier) })];\n                                }\n                            });\n                        }); });\n                        return [4 /*yield*/, Promise.all(dataSourcePromises)];\n                    case 1:\n                        dataSource = _b.sent();\n                        return [4 /*yield*/, new TableBuilder_1.TableBuilder().build(dataSource, agGridElement, {\n                                rowHeight: 150\n                            })];\n                    case 2:\n                        gridOptions = (_b.sent()).gridOptions;\n                        return [2 /*return*/, {\n                                container: container,\n                                gridOptions: gridOptions\n                            }];\n                }\n            });\n        });\n    };\n    ExecutionReportRankingModifiers.prototype.extractDocumentInfoFromBoost = function (results, permanentID, rankingExpression, bindings) {\n        return __awaiter(this, void 0, void 0, function () {\n            var matchingResult, resultInResultSet, queryBuilder, resultsFromIndex;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        matchingResult = {\n                            result: null,\n                            returnedByIndexForCurrentQuery: false\n                        };\n                        resultInResultSet = underscore_1.find(results, function (result) {\n                            return result.raw.permanentid == permanentID || result.raw.urihash == permanentID;\n                        });\n                        if (resultInResultSet) {\n                            matchingResult = {\n                                result: resultInResultSet,\n                                returnedByIndexForCurrentQuery: true\n                            };\n                            return [2 /*return*/, matchingResult];\n                        }\n                        queryBuilder = new QueryBuilder_1.QueryBuilder();\n                        queryBuilder.advancedExpression.add(rankingExpression.expression);\n                        return [4 /*yield*/, bindings.queryController.getEndpoint().search(queryBuilder.build())];\n                    case 1:\n                        resultsFromIndex = _a.sent();\n                        matchingResult = {\n                            result: resultsFromIndex.results[0],\n                            returnedByIndexForCurrentQuery: false\n                        };\n                        return [2 /*return*/, matchingResult];\n                }\n            });\n        });\n    };\n    return ExecutionReportRankingModifiers;\n}());\nexports.ExecutionReportRankingModifiers = ExecutionReportRankingModifiers;\n\n\n/***/ }),\n\n/***/ 824:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ExecutionReport_1 = __webpack_require__(808);\nvar underscore_1 = __webpack_require__(0);\nvar TableBuilder_1 = __webpack_require__(807);\nvar Dom_1 = __webpack_require__(1);\nvar Utils_1 = __webpack_require__(4);\nvar StreamHighlightUtils_1 = __webpack_require__(118);\nvar ExecutionReportSimpleSection_1 = __webpack_require__(812);\nvar ExecutionReportITDSection = /** @class */ (function () {\n    function ExecutionReportITDSection() {\n    }\n    ExecutionReportITDSection.prototype.build = function (executionReport) {\n        return __awaiter(this, void 0, void 0, function () {\n            var preprocessQuerySection, originalLongQuery, topClicksSection, _a, container, agGridElement, gridOptions, dataSource, tableBuilder;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        preprocessQuerySection = underscore_1.find(executionReport.children, function (child) { return child.name == ExecutionReport_1.EXECUTION_REPORT_SECTION.PREPROCESS_QUERY; });\n                        if (!preprocessQuerySection) {\n                            return [2 /*return*/, this.buildFallbackEmptyTable(executionReport)];\n                        }\n                        originalLongQuery = preprocessQuerySection.result.in.lq;\n                        topClicksSection = underscore_1.find(preprocessQuerySection.children, function (child) { return child.name == ExecutionReport_1.EXECUTION_REPORT_SECTION.TOP_CLICKS; });\n                        if (!topClicksSection || !originalLongQuery) {\n                            return [2 /*return*/, this.buildFallbackEmptyTable(executionReport)];\n                        }\n                        _a = ExecutionReport_1.ExecutionReport.standardSectionHeader('Large Query Intelligent Term Detection (ITD)'), container = _a.container, agGridElement = _a.agGridElement;\n                        dataSource = [\n                            {\n                                'Original large query': this.buildOriginalLongQueryCell(originalLongQuery, topClicksSection.refinedQueries),\n                                'Keyword(s) extracted': this.buildRefinedQueryCell(executionReport, topClicksSection.refinedQueries, preprocessQuerySection)\n                            }\n                        ];\n                        return [4 /*yield*/, new TableBuilder_1.TableBuilder().build(dataSource, agGridElement, {\n                                rowHeight: 300\n                            })];\n                    case 1:\n                        tableBuilder = _b.sent();\n                        gridOptions = tableBuilder.gridOptions;\n                        return [2 /*return*/, { container: container, gridOptions: gridOptions }];\n                }\n            });\n        });\n    };\n    ExecutionReportITDSection.prototype.doHighlights = function (originalLongQuery, refinedQueries) {\n        var termsToHighlight = {};\n        underscore_1.each(refinedQueries, function (refined) {\n            termsToHighlight[refined.q] = [];\n        });\n        return StreamHighlightUtils_1.StreamHighlightUtils.highlightStreamText(originalLongQuery, termsToHighlight, {});\n    };\n    ExecutionReportITDSection.prototype.buildOriginalLongQueryCell = function (originalLongQuery, refinedQueries) {\n        return {\n            content: this.doHighlights(originalLongQuery, refinedQueries),\n            cellRenderer: TableBuilder_1.GenericHtmlRenderer\n        };\n    };\n    ExecutionReportITDSection.prototype.buildRefinedQueryCell = function (executionReport, refinedQueries, preprocessSection) {\n        if (Utils_1.Utils.isNonEmptyArray(refinedQueries)) {\n            return this.buildRefinedQueryByMLCell(refinedQueries);\n        }\n        var fallbackIndexPartialMatch = underscore_1.find(preprocessSection.children, function (child) { return child.name == ExecutionReport_1.EXECUTION_REPORT_SECTION.PARTIAL_MATCH; });\n        var isUsingPartialMatch = fallbackIndexPartialMatch ? fallbackIndexPartialMatch.result.out.match(/^PartialMatch/) : false;\n        if (isUsingPartialMatch) {\n            return this.buildRefinedQueryByPartialMatchCell(fallbackIndexPartialMatch);\n        }\n        return this.buildRefinedQueryNoExtraction();\n    };\n    ExecutionReportITDSection.prototype.buildRefinedQueryByMLCell = function (refinedQueries) {\n        var _this = this;\n        var topLevelContainer = Dom_1.$$('div', undefined, Dom_1.$$('h2', undefined, 'Extraction and scoring performed using Coveo Machine Learning:'));\n        var keywordsList = Dom_1.$$('ul');\n        topLevelContainer.append(keywordsList.el);\n        underscore_1.chain(refinedQueries)\n            .map(function (refinedQuery) {\n            var content = _this.doHighlights(\"Keyword: \" + refinedQuery.q + \" ==> Score: \" + refinedQuery.score, [refinedQuery]);\n            var container = Dom_1.$$('li', null, content);\n            return container;\n        })\n            .each(function (refinedQueryContainer) {\n            keywordsList.append(refinedQueryContainer.el);\n        });\n        return {\n            content: topLevelContainer,\n            cellRenderer: TableBuilder_1.GenericHtmlRenderer\n        };\n    };\n    ExecutionReportITDSection.prototype.buildRefinedQueryByPartialMatchCell = function (partialMatch) {\n        var topLevelContainer = Dom_1.$$('div');\n        topLevelContainer.append(Dom_1.$$('h2', undefined, 'Coveo Machine learning was unable to suggest any refined keywords').el);\n        topLevelContainer.append(Dom_1.$$('h4', undefined, 'Fallback on Coveo Index partial match feature').el);\n        var content = Dom_1.$$('code', undefined, partialMatch.result.out);\n        topLevelContainer.append(content.el);\n        return {\n            content: topLevelContainer,\n            cellRenderer: TableBuilder_1.GenericHtmlRenderer\n        };\n    };\n    ExecutionReportITDSection.prototype.buildRefinedQueryNoExtraction = function () {\n        var topLevelContainer = Dom_1.$$('div');\n        topLevelContainer.append(Dom_1.$$('h2', undefined, 'No keywords were extracted').el);\n        topLevelContainer.append(Dom_1.$$('h4', undefined, 'The query is probably too small, or Coveo is lacking usage analytics data to return any meaningful suggestions.')\n            .el);\n        return {\n            content: topLevelContainer,\n            cellRenderer: TableBuilder_1.GenericHtmlRenderer\n        };\n    };\n    ExecutionReportITDSection.prototype.buildFallbackEmptyTable = function (executionReport) {\n        return new ExecutionReportSimpleSection_1.ExecutionReportSimpleSection(ExecutionReport_1.EXECUTION_REPORT_SECTION.NONE, ExecutionReport_1.EXECUTION_REPORT_SECTION.NONE, 'Large Query Intelligent Term Detection (ITD)').build(executionReport);\n    };\n    return ExecutionReportITDSection;\n}());\nexports.ExecutionReportITDSection = ExecutionReportITDSection;\n\n\n/***/ }),\n\n/***/ 825:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar TableBuilder_1 = __webpack_require__(807);\nvar underscore_1 = __webpack_require__(0);\nvar GenericValueOutput_1 = __webpack_require__(809);\nvar UtilsModules_1 = __webpack_require__(86);\nvar QueryBuilder_1 = __webpack_require__(48);\nvar PopupUtils_1 = __webpack_require__(195);\nvar AvailableFieldsTable = /** @class */ (function () {\n    function AvailableFieldsTable(bindings) {\n        this.bindings = bindings;\n    }\n    AvailableFieldsTable.prototype.build = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            var container, agGridElement, allFieldsDescription, _a, dataSource, gridOptions;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        container = UtilsModules_1.$$('div');\n                        agGridElement = UtilsModules_1.$$('div', {\n                            className: 'ag-theme-fresh'\n                        });\n                        container.append(agGridElement.el);\n                        if (!this.bindings.queryController) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this.bindings.queryController.getEndpoint().listFields()];\n                    case 1:\n                        _a = _b.sent();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        _a = null;\n                        _b.label = 3;\n                    case 3:\n                        allFieldsDescription = _a;\n                        if (!allFieldsDescription) return [3 /*break*/, 5];\n                        dataSource = underscore_1.map(allFieldsDescription, function (description) {\n                            return {\n                                Name: new GenericValueOutput_1.GenericValueOutput().output(description.name),\n                                Description: __assign({}, new GenericValueOutput_1.GenericValueOutput().output(description.description), { width: 150 }),\n                                'Default Value': new GenericValueOutput_1.GenericValueOutput().output(description.defaultValue),\n                                'Field Type': new GenericValueOutput_1.GenericValueOutput().output(description.fieldType),\n                                'Field Source Type': new GenericValueOutput_1.GenericValueOutput().output(description.fieldSourceType),\n                                'Include In Query': new GenericValueOutput_1.GenericValueOutput().output(description.includeInQuery),\n                                'Include In Results': new GenericValueOutput_1.GenericValueOutput().output(description.includeInResults),\n                                'Group By Field': new GenericValueOutput_1.GenericValueOutput().output(description.groupByField),\n                                'Split Group By Field': new GenericValueOutput_1.GenericValueOutput().output(description.splitGroupByField),\n                                'Sort By Field': new GenericValueOutput_1.GenericValueOutput().output(description.sortByField),\n                                'Sample Of Available Values': {\n                                    content: {\n                                        content: {\n                                            description: description,\n                                            bindings: _this.bindings,\n                                            container: container\n                                        }\n                                    },\n                                    width: 200,\n                                    suppressSorting: true,\n                                    suppressFilter: true,\n                                    cellRenderer: AvailableFieldsSampleValue\n                                }\n                            };\n                        });\n                        return [4 /*yield*/, new TableBuilder_1.TableBuilder().build(dataSource, agGridElement, {\n                                enableFilter: true,\n                                rowModelType: 'infinite',\n                                pagination: true,\n                                paginationPageSize: 25,\n                                rowHeight: 100,\n                                enableServerSideFilter: true,\n                                enableServerSideSorting: true,\n                                datasource: new AvailableFieldsDatasource(dataSource)\n                            })];\n                    case 4:\n                        gridOptions = (_b.sent()).gridOptions;\n                        this.gridOptions = gridOptions;\n                        _b.label = 5;\n                    case 5: return [2 /*return*/, container];\n                }\n            });\n        });\n    };\n    return AvailableFieldsTable;\n}());\nexports.AvailableFieldsTable = AvailableFieldsTable;\nvar AvailableFieldsSampleValue = /** @class */ (function () {\n    function AvailableFieldsSampleValue() {\n    }\n    AvailableFieldsSampleValue.prototype.init = function (params) {\n        if (params.value && params.value.content) {\n            this.description = params.value.content.description;\n            this.bindings = params.value.content.bindings;\n            this.container = params.value.content.container;\n        }\n    };\n    AvailableFieldsSampleValue.prototype.getGui = function () {\n        var _this = this;\n        var btn = UtilsModules_1.$$('button', {\n            className: 'coveo-button coveo-available-fields-table-button',\n            type: 'button'\n        }, 'Hover For Sample Values');\n        var popperElement;\n        var userHoveringButtonWithHisMouse = false;\n        btn.on('mouseover', function () { return __awaiter(_this, void 0, void 0, function () {\n            var values;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        userHoveringButtonWithHisMouse = true;\n                        if (!(this.description && this.container && userHoveringButtonWithHisMouse)) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this.getFieldsValues(this.description)];\n                    case 1:\n                        values = _a.sent();\n                        if (userHoveringButtonWithHisMouse) {\n                            popperElement = this.renderFieldValues(values);\n                            this.container.append(popperElement.el);\n                            UtilsModules_1.PopupUtils.positionPopup(popperElement.el, btn.el, document.body, {\n                                horizontal: PopupUtils_1.PopupHorizontalAlignment.LEFT,\n                                vertical: PopupUtils_1.PopupVerticalAlignment.MIDDLE\n                            });\n                        }\n                        userHoveringButtonWithHisMouse = false;\n                        _a.label = 2;\n                    case 2: return [2 /*return*/];\n                }\n            });\n        }); });\n        btn.on('mouseout', function () {\n            if (popperElement) {\n                popperElement.remove();\n            }\n            userHoveringButtonWithHisMouse = false;\n        });\n        return btn.el;\n    };\n    AvailableFieldsSampleValue.prototype.getFieldsValues = function (fieldDesciption) {\n        return __awaiter(this, void 0, void 0, function () {\n            var queryBuilder, queryResults, _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (!this.bindings || !this.description || !this.bindings.queryController || !this.container) {\n                            return [2 /*return*/, []];\n                        }\n                        if (!fieldDesciption.groupByField) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this.bindings.queryController.getEndpoint().listFieldValues({\n                                field: this.description.name\n                            })];\n                    case 1: return [2 /*return*/, _b.sent()];\n                    case 2:\n                        queryBuilder = new QueryBuilder_1.QueryBuilder();\n                        queryBuilder.advancedExpression.add(fieldDesciption.name);\n                        if (!this.bindings) return [3 /*break*/, 4];\n                        return [4 /*yield*/, this.bindings.queryController.getEndpoint().search(queryBuilder.build())];\n                    case 3:\n                        _a = _b.sent();\n                        return [3 /*break*/, 5];\n                    case 4:\n                        _a = null;\n                        _b.label = 5;\n                    case 5:\n                        queryResults = _a;\n                        if (queryResults) {\n                            return [2 /*return*/, underscore_1.map(queryResults.results, function (result) {\n                                    return { value: UtilsModules_1.Utils.getFieldValue(result, fieldDesciption.name) };\n                                })];\n                        }\n                        else {\n                            return [2 /*return*/, []];\n                        }\n                        _b.label = 6;\n                    case 6: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    AvailableFieldsSampleValue.prototype.renderFieldValues = function (fieldValues) {\n        var list = UtilsModules_1.$$('ul', { className: 'coveo-relevance-inspector-available-fields-popup' });\n        list.el.style.background = 'white';\n        if (fieldValues.length == 0) {\n            list.append(UtilsModules_1.$$('li', undefined, 'No Values Available ...').el);\n        }\n        else {\n            fieldValues.forEach(function (fieldValue) {\n                var listItem = UtilsModules_1.$$('li', {\n                    className: 'coveo-relevance-inspector-available-fields-popup-value'\n                }, new GenericValueOutput_1.GenericValueOutput().output(fieldValue.value).content);\n                list.append(listItem.el);\n            });\n        }\n        return list;\n    };\n    AvailableFieldsSampleValue.prototype.refresh = function () {\n        return true;\n    };\n    return AvailableFieldsSampleValue;\n}());\nexports.AvailableFieldsSampleValue = AvailableFieldsSampleValue;\nvar AvailableFieldsDatasource = /** @class */ (function () {\n    function AvailableFieldsDatasource(dataSource) {\n        this.dataSource = dataSource;\n        this.rowsData = [];\n        this.rowsData = underscore_1.map(this.dataSource, function (source) {\n            var merged = {};\n            var extractContent = function (value, key) {\n                if (value.content != null) {\n                    merged[key] = value.content;\n                }\n                else if (value.children) {\n                    underscore_1.each(value.children, function (child) {\n                        underscore_1.each(child, extractContent);\n                    });\n                }\n            };\n            underscore_1.each(source, extractContent);\n            return merged;\n        });\n    }\n    AvailableFieldsDatasource.prototype.getRows = function (params) {\n        var filtered = this.filter(this.rowsData, params.filterModel);\n        var filteredAndSorted = this.sort(filtered, params.sortModel);\n        params.successCallback(filteredAndSorted.slice(params.startRow, params.endRow), filteredAndSorted.length);\n    };\n    AvailableFieldsDatasource.prototype.filter = function (rows, filterModel) {\n        underscore_1.each(filterModel, function (value, key) {\n            switch (value.type) {\n                case 'equals':\n                    rows = underscore_1.where(rows, (_a = {}, _a[key] = value.filter, _a));\n                    break;\n                case 'notEqual':\n                    rows = underscore_1.reject(rows, function (possibleReturn) {\n                        return possibleReturn[key] == value.filter;\n                    });\n                    break;\n                case 'startsWith':\n                    rows = underscore_1.filter(rows, function (possibleReturn) {\n                        return possibleReturn[key].toLowerCase().indexOf(value.filter) == 0;\n                    });\n                    break;\n                case 'endsWith':\n                    rows = underscore_1.filter(rows, function (possibleReturn) {\n                        return possibleReturn[key].toLowerCase().indexOf(value.filter) == possibleReturn[key].length - value.filter.length;\n                    });\n                    break;\n                case 'contains':\n                    rows = underscore_1.filter(rows, function (possibleReturn) {\n                        return possibleReturn[key].toLowerCase().indexOf(value.filter) != -1;\n                    });\n                    break;\n                case 'notContains':\n                    rows = underscore_1.filter(rows, function (possibleReturn) {\n                        return possibleReturn[key].toLowerCase().indexOf(value.filter) == -1;\n                    });\n                    break;\n            }\n            var _a;\n        });\n        return rows;\n    };\n    AvailableFieldsDatasource.prototype.sort = function (rows, sortModels) {\n        if (sortModels && sortModels[0]) {\n            var sortModel_1 = sortModels[0];\n            return rows.sort(function (first, second) {\n                var firstValue = first[sortModel_1.colId];\n                var secondValue = second[sortModel_1.colId];\n                var ascendingOrDescendingMultiplier = sortModel_1.sort == 'asc' ? 1 : -1;\n                if (UtilsModules_1.Utils.isNullOrEmptyString(firstValue) && UtilsModules_1.Utils.isNullOrEmptyString(secondValue)) {\n                    return 0;\n                }\n                if (UtilsModules_1.Utils.isNullOrEmptyString(firstValue)) {\n                    return -1 * ascendingOrDescendingMultiplier;\n                }\n                if (UtilsModules_1.Utils.isNullOrEmptyString(secondValue)) {\n                    return 1 * ascendingOrDescendingMultiplier;\n                }\n                if (isNaN(firstValue) || isNaN(secondValue)) {\n                    return firstValue.localeCompare(secondValue) * ascendingOrDescendingMultiplier;\n                }\n                else {\n                    return (Number(firstValue) - Number(secondValue)) * ascendingOrDescendingMultiplier;\n                }\n            });\n        }\n        return rows;\n    };\n    return AvailableFieldsDatasource;\n}());\nexports.AvailableFieldsDatasource = AvailableFieldsDatasource;\n\n\n/***/ }),\n\n/***/ 826:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar RankingInfoParser_1 = __webpack_require__(811);\nvar Dom_1 = __webpack_require__(1);\nvar underscore_1 = __webpack_require__(0);\nvar Utils_1 = __webpack_require__(4);\nvar InlineRankingInfo = /** @class */ (function () {\n    function InlineRankingInfo(result) {\n        this.result = result;\n        this.rankingInfo = RankingInfoParser_1.parseRankingInfo(result.rankingInfo);\n    }\n    InlineRankingInfo.prototype.build = function () {\n        var container = Dom_1.$$('div', {\n            className: 'coveo-relevance-inspector-inline-ranking'\n        });\n        underscore_1.each(this.rankingInfo.documentWeights, function (value, key) {\n            var section = Dom_1.$$('div', { className: 'coveo-relevance-inspector-inline-ranking-section' }, key + \": \" + value);\n            container.append(section.el);\n        });\n        var total = Dom_1.$$('div', { className: 'coveo-relevance-inspector-highlight coveo-relevance-inspector-inline-ranking-section' }, \"Total: \" + this.rankingInfo.totalWeight);\n        container.append(total.el);\n        if (this.rankingInfo.termsWeight) {\n            this.buildTogglableTermsSection(container);\n        }\n        if (Utils_1.Utils.isNonEmptyArray(this.rankingInfo.qreWeights)) {\n            this.buildTogglableQRESection(container);\n        }\n        return container;\n    };\n    InlineRankingInfo.prototype.buildTogglableTermsSection = function (container) {\n        var termsButton = Dom_1.$$('button', { className: 'coveo-button coveo-relevance-inspector-inline-ranking-button', type: 'button' }, 'Toggle Terms Relevancy Breakdown');\n        container.append(termsButton.el);\n        var termsSection = Dom_1.$$('div', { className: 'coveo-relevance-inspector-inline-ranking-terms' });\n        container.append(termsSection.el);\n        underscore_1.each(this.rankingInfo.termsWeight || {}, function (value, key) {\n            var builtKey = \"Keyword: \" + key;\n            termsSection.append(Dom_1.$$('h2', undefined, builtKey).el);\n            termsSection.append(RankingInfoParser_1.buildListOfTermsElement(value.Weights).el);\n        });\n        termsButton.on('click', function () { return termsSection.toggleClass('coveo-active'); });\n    };\n    InlineRankingInfo.prototype.buildTogglableQRESection = function (container) {\n        var qreButton = Dom_1.$$('button', { className: 'coveo-button coveo-relevance-inspector-inline-ranking-button', type: 'button' }, 'Toggle QRE Breakdown');\n        container.append(qreButton.el);\n        var qreSection = Dom_1.$$('ul', { className: 'coveo-relevance-inspector-inline-ranking-terms' });\n        container.append(qreSection.el);\n        underscore_1.each(this.rankingInfo.qreWeights, function (value) {\n            qreSection.append(Dom_1.$$('dd', { className: 'coveo-relevance-inspector-inline-ranking-qre-expression' }, \"\" + value.expression).el);\n            qreSection.append(Dom_1.$$('dt', undefined, \"Score: \" + value.score).el);\n        });\n        qreButton.on('click', function () { return qreSection.toggleClass('coveo-active'); });\n    };\n    return InlineRankingInfo;\n}());\nexports.InlineRankingInfo = InlineRankingInfo;\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// RelevanceInspector.min__d6b9bcc2bfcb024de483.js","import { RankingInfoTable } from './RankingInfoTable';\nimport { MetaDataTable } from './MetaDataTable';\nimport { IComponentBindings } from '../Base/ComponentBindings';\nimport { IAttributeChangedEventArg } from '../../models/Model';\nimport { $$ } from '../../utils/Dom';\nimport { ModalBox } from '../../ExternalModulesShim';\nimport { QueryStateModel, ResultListEvents, DomUtils, Logger } from '../../Core';\nimport { RelevanceInspectorTabs } from './RelevanceInspectorTabs';\nimport 'styling/_RelevanceInspector';\nimport { ExecutionReport } from './ExecutionReport';\nimport { AvailableFieldsTable } from './AvailableFieldsTable';\nimport agGridModule = require('ag-grid/main');\nimport { debounce } from 'underscore';\nimport { IDisplayedNewResultEventArgs } from '../../events/ResultListEvents';\nimport { InlineRankingInfo } from './InlineRankingInfo';\n\nexport interface IRelevanceInspectorConstructor {\n  new (element: HTMLElement, bindings: IComponentBindings): RelevanceInspector;\n}\n\nexport interface IRelevanceInspectorTab {\n  gridOptions: agGridModule.GridOptions;\n}\n\nexport class RelevanceInspector {\n  private opened = false;\n  private activeTab: string;\n  private tabs: Record<string, IRelevanceInspectorTab>;\n  private modalBoxModule = ModalBox;\n\n  constructor(public element: HTMLElement, public bindings: IComponentBindings) {\n    $$(this.element).text('Relevance Inspector');\n    $$(this.element).addClass('coveo-button coveo-relevance-inspector');\n    $$(this.bindings.root).on(\n      this.bindings.queryStateModel.getEventName(QueryStateModel.eventTypes.changeOne + QueryStateModel.attributesEnum.debug),\n      (e, args: IAttributeChangedEventArg) => this.toggleFromState(args.value)\n    );\n    $$(this.element).on('click', () => this.open());\n    $$(this.bindings.root).on(ResultListEvents.newResultDisplayed, (e, args: IDisplayedNewResultEventArgs) =>\n      this.handleNewResultDisplayed(args)\n    );\n    this.bindings.queryStateModel.get(QueryStateModel.attributesEnum.debug) ? this.show() : this.hide();\n  }\n\n  public get modalBox() {\n    return this.modalBoxModule;\n  }\n\n  public set modalBox(modalBoxModule) {\n    this.modalBoxModule = modalBoxModule;\n  }\n\n  public hide() {\n    $$(this.element).addClass('coveo-hidden');\n  }\n\n  public show() {\n    $$(this.element).removeClass('coveo-hidden');\n  }\n\n  public async open() {\n    if (this.opened) {\n      return;\n    }\n    this.opened = true;\n\n    const content = $$('div');\n    const animation = DomUtils.getBasicLoadingAnimation();\n    content.append(animation);\n    this.modalBox.open(content.el, this.modalBoxOptions);\n    const rows = await this.buildTabs();\n    if (rows) {\n      animation.remove();\n      content.append(rows.el);\n    } else {\n      this.modalBox.close();\n    }\n  }\n\n  private handleNewResultDisplayed(args: IDisplayedNewResultEventArgs) {\n    if (this.bindings.queryStateModel.get(QueryStateModel.attributesEnum.debug)) {\n      $$(args.item).addClass('coveo-with-inline-ranking-info');\n      if ($$(args.item).hasClass('coveo-table-layout')) {\n        $$(args.item).append(new InlineRankingInfo(args.result).build().el);\n      } else {\n        $$(args.item).prepend(new InlineRankingInfo(args.result).build().el);\n      }\n    }\n  }\n\n  private get modalBoxOptions() {\n    return {\n      title: 'Relevance Inspector',\n      titleClose: false,\n      overlayClose: true,\n      sizeMod: 'big',\n      className: 'relevance-inspector-modal',\n      validation: () => {\n        this.opened = false;\n        return true;\n      },\n      body: document.getElementsByClassName('CoveoSearchInterface')[0] // Will return undefined if no CoveoSearchInterface is present\n    };\n  }\n\n  private toggleFromState(stateValue: number) {\n    stateValue != 0 ? this.show() : this.hide();\n    this.modalBox.close();\n  }\n\n  private async buildTabs() {\n    const lastResults = this.bindings.queryController.getLastResults().results;\n    if (!lastResults || lastResults.length == 0) {\n      new Logger(this).error(\n        'Could not open Relevance Inspector because there is no results to display. Please execute a query beforehand',\n        lastResults\n      );\n      return;\n    }\n    if (!lastResults[0].rankingInfo) {\n      new Logger(this).error(\n        'Could not open Relevance Inspector because there is no ranking info returned on the results. Please execute a query in debug mode beforehad',\n        lastResults\n      );\n      return;\n    }\n\n    const container = $$('div');\n\n    const rankingInfoTable = new RankingInfoTable(lastResults, this.bindings);\n    const metadataTable = new MetaDataTable(lastResults, this.bindings);\n    const executionReport = new ExecutionReport(this.bindings.queryController.getLastResults(), this.bindings);\n    const availableFields = new AvailableFieldsTable(this.bindings);\n\n    this.tabs = {\n      relevanceInspectorRankingInfo: rankingInfoTable,\n      relevanceInspectorMetadata: metadataTable,\n      relevanceInspectorExecutionReport: executionReport,\n      relevanceInspectorAvailableFields: availableFields\n    };\n\n    const inspectorTabs = new RelevanceInspectorTabs(tabChangedTo => {\n      this.activeTab = tabChangedTo;\n      this.resize();\n    });\n\n    const debouncedResize = debounce(() => this.resize(), 100);\n\n    window.addEventListener('resize', debouncedResize);\n\n    inspectorTabs.addSection('Ranking Information', await rankingInfoTable.build(), 'relevanceInspectorRankingInfo');\n    inspectorTabs.addSection('Metadata', await metadataTable.build(), 'relevanceInspectorMetadata');\n    inspectorTabs.addSection('Execution Report', await executionReport.build(), 'relevanceInspectorExecutionReport');\n    inspectorTabs.addSection('Available Fields', await availableFields.build(), 'relevanceInspectorAvailableFields');\n    inspectorTabs.select('relevanceInspectorRankingInfo');\n\n    container.append(inspectorTabs.navigationSection.el);\n    container.append(inspectorTabs.tabContentSection.el);\n\n    return container;\n  }\n\n  private resize() {\n    if (!this.activeTab) {\n      return;\n    }\n    if (!this.tabs[this.activeTab]) {\n      return;\n    }\n    this.tabs[this.activeTab].gridOptions.api.sizeColumnsToFit();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/RelevanceInspector.ts","import { Component } from '../Base/Component';\nimport { ComponentOptions } from '../Base/ComponentOptions';\nimport { ComponentOptionsModel } from '../../models/ComponentOptionsModel';\nimport { IResultsComponentBindings } from '../Base/ResultsComponentBindings';\nimport { analyticsActionCauseList } from '../Analytics/AnalyticsActionListMeta';\nimport { IResultLinkOptions } from './ResultLinkOptions';\nimport { ResultListEvents } from '../../events/ResultListEvents';\nimport { HighlightUtils } from '../../utils/HighlightUtils';\nimport { IQueryResult } from '../../rest/QueryResult';\nimport { DeviceUtils } from '../../utils/DeviceUtils';\nimport { OS_NAME, OSUtils } from '../../utils/OSUtils';\nimport { Initialization } from '../Base/Initialization';\nimport { QueryUtils } from '../../utils/QueryUtils';\nimport { Assert } from '../../misc/Assert';\nimport { Utils } from '../../utils/Utils';\nimport { Defer } from '../../misc/Defer';\nimport { $$ } from '../../utils/Dom';\nimport { StreamHighlightUtils } from '../../utils/StreamHighlightUtils';\nimport { StringUtils } from '../../utils/StringUtils';\nimport { once, debounce, extend, escape } from 'underscore';\nimport { exportGlobally } from '../../GlobalExports';\n\nimport 'styling/_ResultLink';\nimport { AccessibleButton } from '../../utils/AccessibleButton';\n\n/**\n * The `ResultLink` component automatically transform a search result title into a clickable link pointing to the\n * original item.\n *\n * This component is a result template component (see [Result Templates](https://docs.coveo.com/en/413/)).\n */\nexport class ResultLink extends Component {\n  static ID = 'ResultLink';\n\n  static doExport = () => {\n    exportGlobally({\n      ResultLink: ResultLink\n    });\n  };\n\n  /**\n   * The options for the ResultLink\n   * @componentOptions\n   */\n  static options: IResultLinkOptions = {\n    /**\n     * Specifies the field to use to output the component `href` attribute value.\n     *\n     * **Tip:**\n     * > Instead of specifying a value for the `field` option, you can directly add an `href` attribute to the\n     * > `ResultLink` HTML element. Then, you can use a custom script to generate the `href` value.\n     *\n     * **Examples:**\n     * - With the following markup, the `ResultLink` outputs its `href` value using the `@uri` field (rather than the\n     * default field):\n     *\n     * ```html\n     * <a class=\"CoveoResultLink\" data-field=\"@uri\"></a>\n     * ```\n     *\n     * - In the following result template, the custom `getMyKBUri()` function provides the `href` value:\n     *\n     * ```html\n     * <script id=\"KnowledgeArticle\" type=\"text/underscore\" class=\"result-template\">\n     *   <div class='CoveoIcon>'></div>\n     *   <a class=\"CoveoResultLink\" href=\"<%= getMyKBUri(raw) %>\"></a>\n     *   <div class=\"CoveoExcerpt\"></div>\n     * </script>\n     * ```\n     *\n     * See also [`hrefTemplate`]{@link ResultLink.options.hrefTemplate}, which can override this option.\n     *\n     * By default, the component uses the `@clickUri` field of the item to output the value of its `href` attribute.\n     */\n    field: ComponentOptions.buildFieldOption(),\n\n    /**\n     * Specifies whether the component should try to open its link in Microsoft Outlook.\n     *\n     * Setting this option to `true` is normally useful for `ResultLink` instances related to Microsoft Exchange emails.\n     *\n     * If this option is `true`, clicking the `ResultLink` calls the\n     * [`openLinkInOutlook`]{@link ResultLink.openLinkInOutlook} method instead of the\n     * [`openLink`]{@link ResultLink.openLink} method.\n     *\n     * Default value is `false`.\n     */\n    openInOutlook: ComponentOptions.buildBooleanOption({ defaultValue: false }),\n\n    /**\n     * Specifies whether the component should open its link in the [`Quickview`]{@link Quickview} component rather than\n     * loading through the original URL.\n     *\n     * Default value is `false`.\n     */\n    openQuickview: ComponentOptions.buildBooleanOption({ defaultValue: false }),\n\n    /**\n     * Specifies whether the component should open its link in a new window instead of opening it in the current\n     * context.\n     *\n     * If this option is `true`, clicking the `ResultLink` calls the\n     * [`openLinkInNewWindow`]{@link ResultLink.openLinkInNewWindow} method instead of the\n     * [`openLink`]{@link ResultLink.openLink} method.\n     *\n     * **Note:**\n     * > If a search page contains a [`ResultPreferences`]{@link ResultsPreferences} component whose\n     * > [`enableOpenInNewWindow`]{@link ResultsPreferences.options.enableOpenInNewWindow} option is `true`, and the end\n     * > user checks the <b>Always open results in new window</b> box, `ResultLink` components in this page will always\n     * > open their links in a new window when the end user clicks them, no matter what the value of their\n     * > `alwaysOpenInNewWindow` option is.\n     *\n     * Default value is `false`.\n     */\n    alwaysOpenInNewWindow: ComponentOptions.buildBooleanOption({ defaultValue: false }),\n\n    /**\n     * Specifies a template literal from which to generate the `ResultLink` `href` attribute value (see\n     * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\n     *\n     * This option overrides the [`field`]{@link ResultLink.options.field} option value.\n     *\n     * The template literal can reference any number of fields from the parent result. It can also reference global\n     * scope properties.\n     *\n     * **Examples:**\n     *\n     * - The following markup generates an `href` value such as `http://uri.com?id=itemTitle`:\n     *\n     * ```html\n     * <a class='CoveoResultLink' data-href-template='${clickUri}?id=${raw.title}'></a>\n     * ```\n     *\n     * - The following markup generates an `href` value such as `localhost/fooBar`:\n     *\n     * ```html\n     * <a class='CoveoResultLink' data-href-template='${window.location.hostname}/{Foo.Bar}'></a>\n     * ```\n     *\n     * Default value is `undefined`.\n     */\n    hrefTemplate: ComponentOptions.buildStringOption(),\n\n    /**\n     * Specifies a template literal from which to generate the `ResultLink` display title (see\n     * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\n     *\n     * This option overrides the default `ResultLink` display title behavior.\n     *\n     * The template literal can reference any number of fields from the parent result. However, if the template literal\n     * references a key whose value is undefined in the parent result fields, the `ResultLink` title displays the\n     * name of this key instead.\n     *\n     * This option is ignored if the `ResultLink` innerHTML contains any value.\n     *\n     * **Examples:**\n     *\n     * - The following markup generates a `ResultLink` display title such as `Case number: 123456` if both the\n     * `raw.objecttype` and `raw.objectnumber` keys are defined in the parent result fields:\n     *\n     * ```html\n     * <a class=\"CoveoResultLink\" data-title-template=\"${raw.objecttype} number: ${raw.objectnumber}\"></a>\n     * ```\n     *\n     * - The following markup generates `${myField}` as a `ResultLink` display title if the `myField` key is undefined\n     * in the parent result fields:\n     *\n     * ```html\n     * <a class=\"CoveoResultLink\" data-title-template=\"${myField}\"></a>\n     * ```\n     *\n     * - The following markup generates `Foobar` as a `ResultLink` display title, because the `ResultLink` innterHTML is\n     * not empty:\n     *\n     * ```html\n     * <a class=\"CoveoResultLink\" data-title-template=\"${will} ${be} ${ignored}\">Foobar</a>\n     * ```\n     *\n     * Default value is `undefined`.\n     *\n     * @availablesince [January 2017 Release (v1.1865.9)](https://docs.coveo.com/en/396/#january-2017-release-v118659)\n     */\n    titleTemplate: ComponentOptions.buildStringOption(),\n\n    /**\n     * Specifies an event handler function to execute when the user clicks the `ResultLink` component.\n     *\n     * The handler function takes a JavaScript [`Event`](https://developer.mozilla.org/en/docs/Web/API/Event) object and\n     * an [`IQueryResult`]{@link IQueryResult} as its parameters.\n     *\n     * Overriding the default behavior of the `onClick` event can allow you to execute specific code instead.\n     *\n     * **Note:**\n     * > You cannot set this option directly in the component markup as an HTML attribute. You must either set it in the\n     * > [`init`]{@link init} call of your search interface (see\n     * > [Passing Component Options in the init Call](https://docs.coveo.com/en/346/#passing-component-options-in-the-init-call)),\n     * > or before the `init` call, using the `options` top-level function (see\n     * > [Passing Component Options Before the init Call](https://docs.coveo.com/en/346/#passing-component-options-before-the-init-call)).\n     *\n     * **Example:**\n     * ```javascript\n     * // You can set the option in the 'init' call:\n     * Coveo.init(document.querySelector(\"#search\"), {\n     *   ResultLink : {\n     *     onClick : function(e, result) {\n     *       e.preventDefault();\n     *       // Custom code to execute with the item URI and title.\n     *       openUriInASpecialTab(result.clickUri, result.title);\n     *     }\n     *   }\n     * });\n     *\n     * // Or before the 'init' call, using the 'options' top-level function:\n     * // Coveo.options(document.querySelector('#search'), {\n     * //   ResultLink : {\n     * //     onClick : function(e, result) {\n     * //       e.preventDefault();\n     * //       // Custom code to execute with the item URI and title.\n     * //       openUriInASpecialTab(result.clickUri, result.title);\n     * //     }\n     * //   }\n     * // });\n     * ```\n     */\n    onClick: ComponentOptions.buildCustomOption<(e: Event, result: IQueryResult) => any>(() => {\n      return null;\n    }),\n\n    /**\n     * Specify this option to log additional analytics when this result link is pressed.\n     *\n     * **Example:**\n     * ```javascript\n     * const resultLink = new Coveo.ResultLink(\n     *   linkElement,\n     *   {\n     *     logAnalytics: (href) => Coveo.logCustomEvent(\n     *         Coveo.analyticsActionCauseList.openSmartSnippetSource,\n     *         {\n     *           searchQueryUid: searchInterface.queryController.lastSearchUid,\n     *           documentTitle: result.title,\n     *           author: Utils.getFieldValue(result, 'author'),\n     *           documentURL: href\n     *         },\n     *         element\n     *       )\n     *   },\n     *   searchInterface.getBindings(),\n     *   result\n     * )\n     * ```\n     */\n    logAnalytics: ComponentOptions.buildCustomOption<(href: string) => void>(() => null)\n  };\n\n  private toExecuteOnOpen: (e?: Event) => void;\n\n  /**\n   * Creates a new `ResultLink` component.\n   * @param element The HTMLElement on which to instantiate the component.\n   * @param options The options for the `ResultLink` component.\n   * @param bindings The bindings that the component requires to function normally. If not set, these will be\n   * automatically resolved (with a slower execution time).\n   * @param result The result to associate the component with.\n   * @param os\n   */\n  constructor(\n    public element: HTMLElement,\n    public options: IResultLinkOptions,\n    public bindings?: IResultsComponentBindings,\n    public result?: IQueryResult,\n    public os?: OS_NAME\n  ) {\n    super(element, ResultLink.ID, bindings);\n\n    const globalOptions = this.searchInterface.options.originalOptionsObject[ResultLink.ID] || {};\n    const initialOptions = ComponentOptions.initComponentOptions(element, ResultLink, { ...globalOptions, ...options });\n    const resultLinkOptions = this.componentOptionsModel.get(ComponentOptionsModel.attributesEnum.resultLink);\n    this.options = extend({}, initialOptions, resultLinkOptions);\n\n    this.result = result || this.resolveResult();\n\n    if (this.options.openQuickview == null) {\n      this.options.openQuickview = result.raw['connectortype'] == 'ExchangeCrawler' && DeviceUtils.isMobileDevice();\n    }\n    if (!this.element.hasAttribute('tabindex')) {\n      this.element.setAttribute('tabindex', '0');\n    }\n\n    Assert.exists(this.componentOptionsModel);\n    Assert.exists(this.result);\n\n    if (!this.quickviewShouldBeOpened()) {\n      // Bind on multiple \"click\" or \"mouse\" events.\n      // Create a function that will be executed only once, so as not to log multiple events\n      // Once a result link has been opened, and that we log at least one analytics event,\n      // it should not matter if the end user open the same link multiple times with different methods.\n      // It's still only one \"click\" event as far as UA is concerned.\n      // Also need to handle \"longpress\" on mobile (the contextual menu), which we assume to be 1 s long.\n\n      const executeOnlyOnce = once(() => this.logAnalytics());\n\n      $$(element).on(['contextmenu', 'click', 'mousedown', 'mouseup'], executeOnlyOnce);\n      let longPressTimer: number;\n      $$(element).on('touchstart', () => {\n        longPressTimer = window.setTimeout(executeOnlyOnce, 1000);\n      });\n      $$(element).on('touchend', () => {\n        if (longPressTimer) {\n          clearTimeout(longPressTimer);\n        }\n      });\n    }\n    this.renderUri(element, result);\n    this.bindEventToOpen();\n  }\n  public renderUri(element: HTMLElement, result?: IQueryResult) {\n    if (/^\\s*$/.test(this.element.innerHTML)) {\n      const title = this.getDisplayedTitle();\n      this.element.innerHTML = title;\n\n      const titleAsText = this.getDisplayedTitleAsText();\n      if (!this.element.hasAttribute('aria-label')) {\n        this.element.setAttribute('aria-label', titleAsText);\n      }\n\n      if (!this.element.title) {\n        this.element.title = titleAsText;\n      }\n    }\n  }\n  /**\n   * Opens the result in the same window, no matter how the actual component is configured for the end user.\n   * @param logAnalytics Specifies whether the method should log an analytics event.\n   */\n  public openLink(logAnalytics = true) {\n    if (logAnalytics) {\n      this.logAnalytics();\n    }\n    window.location.href = this.getResultUri();\n  }\n\n  /**\n   * Opens the result in a new window, no matter how the actual component is configured for the end user.\n   * @param logAnalytics Specifies whether the method should log an analytics event.\n   */\n  public openLinkInNewWindow(logAnalytics = true) {\n    if (logAnalytics) {\n      this.logAnalytics();\n    }\n    window.open(this.getResultUri(), '_blank');\n  }\n\n  /**\n   * Tries to open the result in Microsoft Outlook if the result has an `outlookformacuri` or `outlookuri` field.\n   *\n   * Normally, this implies the result should be a link to an email.\n   *\n   * If the needed fields are not present, this method does nothing.\n   * @param logAnalytics Specifies whether the method should log an analytics event.\n   */\n  public openLinkInOutlook(logAnalytics = true) {\n    if (this.hasOutlookField()) {\n      if (logAnalytics) {\n        this.logAnalytics();\n      }\n      this.openLink();\n    }\n  }\n\n  /**\n   * Opens the link in the same manner the end user would.\n   *\n   * This essentially simulates a click on the result link.\n   *\n   * @param logAnalytics Specifies whether the method should log an analytics event.\n   */\n  public openLinkAsConfigured(logAnalytics = true) {\n    if (this.toExecuteOnOpen) {\n      if (logAnalytics) {\n        this.logAnalytics();\n      }\n      this.toExecuteOnOpen();\n    }\n  }\n\n  protected bindEventToOpen(): boolean {\n    return (\n      this.bindOnClickIfNotUndefined() ||\n      this.bindOpenQuickviewIfNotUndefined() ||\n      this.setHrefIfNotAlready() ||\n      this.openLinkThatIsNotAnAnchor()\n    );\n  }\n\n  private getDisplayedTitle() {\n    if (!this.options.titleTemplate) {\n      return this.result.title\n        ? HighlightUtils.highlightString(this.result.title, this.result.titleHighlights, null, 'coveo-highlight')\n        : this.escapedClickUri;\n    } else {\n      let newTitle = StringUtils.buildStringTemplateFromResult(this.options.titleTemplate, this.result);\n      return newTitle\n        ? StreamHighlightUtils.highlightStreamText(newTitle, this.result.termsToHighlight, this.result.phrasesToHighlight)\n        : this.escapedClickUri;\n    }\n  }\n\n  private getDisplayedTitleAsText() {\n    const container = $$('div');\n    container.setHtml(this.getDisplayedTitle());\n    return container.text();\n  }\n\n  private get escapedClickUri() {\n    return escape(this.result.clickUri);\n  }\n\n  private bindOnClickIfNotUndefined() {\n    if (this.options.onClick != undefined) {\n      this.toExecuteOnOpen = (e: MouseEvent) => {\n        this.options.onClick.call(this, e, this.result);\n      };\n\n      new AccessibleButton()\n        .withElement(this.element)\n        .withLabel(this.result.title)\n        .withSelectAction((e: Event) => this.toExecuteOnOpen(e))\n        .build();\n\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  private bindOpenQuickviewIfNotUndefined() {\n    if (this.quickviewShouldBeOpened()) {\n      this.toExecuteOnOpen = () => {\n        $$(this.bindings.resultElement).trigger(ResultListEvents.openQuickview);\n      };\n\n      $$(this.element).on('click', (e: Event) => {\n        e.preventDefault();\n        this.toExecuteOnOpen();\n      });\n\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  private openLinkThatIsNotAnAnchor() {\n    if (!this.elementIsAnAnchor()) {\n      this.toExecuteOnOpen = () => {\n        if (this.options.alwaysOpenInNewWindow) {\n          if (this.options.openInOutlook) {\n            this.openLinkInOutlook();\n          } else {\n            this.openLinkInNewWindow();\n          }\n        } else {\n          this.openLink();\n        }\n      };\n\n      $$(this.element).on('click', () => {\n        this.toExecuteOnOpen();\n      });\n\n      return true;\n    }\n    return false;\n  }\n\n  private setHrefIfNotAlready() {\n    // Do not erase any value put in href by the template, etc. Allows\n    // using custom click urls while still keeping analytics recording\n    // and other behavior brought by the component.\n    if (this.elementIsAnAnchor() && !Utils.isNonEmptyString($$(this.element).getAttribute('href'))) {\n      $$(this.element).setAttribute('href', this.getResultUri());\n      if (this.options.alwaysOpenInNewWindow && !(this.options.openInOutlook && this.hasOutlookField())) {\n        $$(this.element).setAttribute('target', '_blank');\n      }\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  private logDocumentOpen(href: string) {\n    this.usageAnalytics.logClickEvent(\n      analyticsActionCauseList.documentOpen,\n      {\n        documentURL: href,\n        documentTitle: this.result.title,\n        author: Utils.getFieldValue(this.result, 'author')\n      },\n      this.result,\n      this.root\n    );\n  }\n\n  private logAnalytics = debounce(\n    () => {\n      this.queryController.saveLastQuery();\n      let documentURL = $$(this.element).getAttribute('href');\n      if (documentURL == undefined || documentURL == '') {\n        documentURL = this.escapedClickUri;\n      }\n      if (this.options.logAnalytics) {\n        this.options.logAnalytics(documentURL);\n      } else {\n        this.logDocumentOpen(documentURL);\n      }\n      Defer.flush();\n    },\n    1500,\n    true\n  );\n\n  private filterProtocol(uri: string) {\n    const isAbsolute = /^(https?|ftp|file|mailto|tel):/i.test(uri);\n    const isRelative = /^(\\/|\\.\\/|\\.\\.\\/)/.test(uri);\n\n    return isAbsolute || isRelative ? uri : '';\n  }\n\n  private getResultUri(): string {\n    if (this.options.hrefTemplate) {\n      const uri = StringUtils.buildStringTemplateFromResult(this.options.hrefTemplate, this.result);\n      return this.filterProtocol(uri);\n    }\n\n    if (this.options.field == undefined && this.options.openInOutlook) {\n      this.setField();\n    }\n\n    if (this.options.field != undefined) {\n      return this.filterProtocol(Utils.getFieldValue(this.result, <string>this.options.field));\n    }\n\n    return this.filterProtocol(this.result.clickUri);\n  }\n\n  private elementIsAnAnchor() {\n    return this.element.tagName == 'A';\n  }\n\n  private setField() {\n    let os = Utils.exists(this.os) ? this.os : OSUtils.get();\n    if (os == OS_NAME.MACOSX && this.hasOutlookField()) {\n      this.options.field = '@outlookformacuri';\n    } else if (os == OS_NAME.WINDOWS && this.hasOutlookField()) {\n      this.options.field = '@outlookuri';\n    }\n  }\n\n  private hasOutlookField() {\n    let os = Utils.exists(this.os) ? this.os : OSUtils.get();\n    if (os == OS_NAME.MACOSX && this.result.raw['outlookformacuri'] != undefined) {\n      return true;\n    } else if (os == OS_NAME.WINDOWS && this.result.raw['outlookuri'] != undefined) {\n      return true;\n    }\n    return false;\n  }\n\n  private isUriThatMustBeOpenedInQuickview(): boolean {\n    return this.escapedClickUri.toLowerCase().indexOf('ldap://') == 0;\n  }\n\n  private quickviewShouldBeOpened() {\n    return (this.options.openQuickview || this.isUriThatMustBeOpenedInQuickview()) && QueryUtils.hasHTMLVersion(this.result);\n  }\n}\n\nInitialization.registerAutoCreateComponent(ResultLink);\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/ResultLink/ResultLink.ts","import { loadAgGridLibrary } from './AgGrid';\nimport { first, map, each, flatten, find } from 'underscore';\n\nimport agGridModule = require('ag-grid/main');\nimport { Dom, $$, StringUtils, StreamHighlightUtils } from '../../UtilsModules';\nimport { IQueryResult } from '../../rest/QueryResult';\nimport { IResultsComponentBindings } from '../Base/ResultsComponentBindings';\nimport ResultListModule = require('../ResultList/ResultList');\nimport { ResultLink } from '../ResultLink/ResultLink';\nimport { IComponentBindings } from '../Base/ComponentBindings';\ndeclare const agGrid: typeof agGridModule;\n\nexport interface ITableDataSource extends agGridModule.ColDef {\n  content?: any;\n  width?: number;\n  children?: Record<string, ITableDataSource>[];\n  cellRenderer?: new () => agGridModule.ICellRendererComp;\n}\n\nexport const defaultGridOptions: agGridModule.GridOptions = {\n  domLayout: 'autoHeight',\n  enableColResize: true,\n  rowHeight: 100,\n  enableRangeSelection: true,\n  suppressRowClickSelection: true,\n  suppressCellSelection: true,\n  defaultColDef: {\n    width: 100\n  },\n  enableSorting: true,\n  autoSizePadding: 10\n};\n\nexport class TableBuilder {\n  private gridOptions: agGridModule.GridOptions | undefined;\n\n  public async build(sources: Record<string, ITableDataSource>[], table: Dom, gridOptions = defaultGridOptions) {\n    const firstData = first(sources) || {};\n    const mapToAgGridFormat = (value: agGridModule.ColDef & agGridModule.ColGroupDef, key: string): any => {\n      if (value.children) {\n        return {\n          field: key,\n          headerName: key,\n          marryChildren: true,\n          children: flatten(\n            value.children.map((child: any) => {\n              return map(child, mapToAgGridFormat);\n            })\n          )\n        };\n      } else {\n        return {\n          field: key,\n          headerName: key,\n          ...value\n        };\n      }\n    };\n\n    const columnDefs = map(firstData as any, mapToAgGridFormat) as agGridModule.ColDef[];\n\n    const rowData = map(sources, source => {\n      const merged: any = {};\n\n      const extractContent = (value: ITableDataSource & agGridModule.ColGroupDef, key: string) => {\n        if (value.content) {\n          merged[key] = value.content;\n        } else if (value.children) {\n          each(value.children, (child: any) => {\n            each(child, extractContent);\n          });\n        }\n      };\n\n      each(source, extractContent as any);\n      return merged;\n    });\n\n    this.gridOptions = {\n      ...defaultGridOptions,\n      columnDefs,\n      rowData,\n      ...gridOptions\n    };\n\n    await loadAgGridLibrary();\n    const grid = new agGrid.Grid(table.el, this.gridOptions);\n\n    return { grid, gridOptions: this.gridOptions };\n  }\n\n  public static thumbnailCell(result: IQueryResult, bindings: IComponentBindings): Record<string, ITableDataSource> {\n    return {\n      Document: {\n        content: { result, bindings },\n        cellRenderer: ThumbnailHtmlRenderer,\n        width: 550,\n        getQuickFilterText: (params: agGridModule.GetQuickFilterTextParams) => {\n          return '';\n        }\n      }\n    };\n  }\n}\n\nexport class ThumbnailHtmlRenderer implements agGridModule.ICellRendererComp {\n  private element: any | undefined;\n  private currentFilter: string | undefined;\n\n  public init(params?: { value: { result: IQueryResult; bindings: IComponentBindings }; api: any }) {\n    if (params) {\n      this.element = params.value;\n      this.currentFilter = params.api.filterManager.quickFilter;\n    }\n  }\n\n  public getGui(): HTMLElement {\n    const cell = $$('div', { className: 'coveo-relevance-inspector-thumbnail-cell' });\n    if (this.element) {\n      const thumbnail = this.thumbnail(this.element.result, this.element.bindings);\n      cell.append(thumbnail.el);\n    } else {\n      cell.append($$('p', undefined, '-- NULL --').el);\n    }\n    return cell.el;\n  }\n\n  private thumbnail(result: IQueryResult, bindings: IResultsComponentBindings) {\n    let dom: Dom;\n\n    if (bindings && result) {\n      const resultLists = bindings.searchInterface.getComponents('ResultList') as ResultListModule.ResultList[];\n      const firstActiveResultList = find(resultLists, resultList => !resultList.disabled);\n\n      if (firstActiveResultList) {\n        dom = $$('div', {\n          className: 'coveo-relevance-inspector-result-thumbnail'\n        });\n        firstActiveResultList.buildResult(result).then(builtResult => {\n          dom.append(builtResult);\n        });\n      } else {\n        dom = $$('a', {\n          className: 'CoveoResultLink'\n        });\n        new ResultLink(dom.el, { alwaysOpenInNewWindow: true }, bindings, result);\n      }\n\n      if (this.currentFilter) {\n        this.highlightSearch(dom.el, this.currentFilter);\n      }\n    } else {\n      dom = $$('div', undefined, '-- NULL --');\n    }\n\n    return dom;\n  }\n\n  public refresh(params: any): boolean {\n    return true;\n  }\n\n  private highlightSearch(elementToSearch: HTMLElement, search: string) {\n    let asHTMLElement: HTMLElement = elementToSearch;\n\n    if (asHTMLElement != null && asHTMLElement.innerText != null) {\n      const match = asHTMLElement.innerText.split(new RegExp('(?=' + StringUtils.regexEncode(search) + ')', 'gi'));\n      asHTMLElement.innerHTML = '';\n      match.forEach(value => {\n        const regex = new RegExp('(' + StringUtils.regexEncode(search) + ')', 'i');\n        const group = value.match(regex);\n        let span;\n\n        if (group != null) {\n          span = $$('span', {\n            className: 'coveo-relevance-inspector-highlight'\n          });\n          span.text(group[1]);\n          asHTMLElement.appendChild(span.el);\n          span = $$('span');\n          span.text(value.substr(group[1].length));\n          asHTMLElement.appendChild(span.el);\n        } else {\n          span = $$('span');\n          span.text(value);\n          asHTMLElement.appendChild(span.el);\n        }\n      });\n    }\n  }\n}\n\nexport class GenericHtmlRenderer implements agGridModule.ICellRendererComp {\n  private element: string | undefined;\n  private currentFilter: string | undefined;\n\n  public init(params?: any) {\n    if (params && params.api) {\n      this.element = params.value;\n      this.currentFilter = params.api.filterManager.quickFilter;\n    }\n  }\n  public getGui(): HTMLElement {\n    if (this.element && this.currentFilter) {\n      return $$('div', undefined, StreamHighlightUtils.highlightStreamHTML(this.element, { Precision: ['precision'] }, {})).el;\n    } else if (this.element) {\n      return $$('div', undefined, this.element).el;\n    } else {\n      return $$('div', undefined, '-- NULL --').el;\n    }\n  }\n\n  public refresh(params: any): boolean {\n    return true;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/TableBuilder.ts","import { ExecutionReportAuthenticationSection } from './ExecutionReportAuthenticationSection';\nimport { ExecutionReportResolvedPipelineSection } from './ExecutionReportResolvedPipelineSection';\nimport { ExecutionReportQueryOverrideSection } from './ExecutionReportQueryOverrideSection';\nimport { ExecutionReportSimpleSection } from './ExecutionReportSimpleSection';\nimport { ExecutionReportEffectiveIndexQuerySection } from './ExecutionReportEffectiveIndexQuerySection';\nimport { IQueryResults } from '../../rest/QueryResults';\nimport { $$, Dom } from '../../UtilsModules';\nimport { IComponentBindings } from '../Base/ComponentBindings';\nimport { IRelevanceInspectorTab } from './RelevanceInspector';\nimport agGridModule = require('ag-grid/main');\nimport { ExecutionReportRankingModifiers } from './ExecutionReportRankingModifiers';\nimport { IResultsComponentBindings, Logger } from '../../Core';\nimport { ExecutionReportITDSection } from './ExecutionReportITDSection';\n\nexport interface IExecutionReport {\n  duration: number;\n  children: IExecutionReportSection[];\n}\n\nexport interface IRankingExpressionExecutionReport {\n  expression: string;\n  modifer: number;\n  isConstant: boolean;\n}\n\nexport enum EXECUTION_REPORT_SECTION {\n  PERFORM_AUTHENTICATION = 'PerformAuthentication',\n  RESOLVE_PIPELINE = 'ResolvePipeline',\n  QUERY_PARAM_OVERRIDE = 'ApplyQueryParamOverrideFeature',\n  THESAURUS = 'ApplyThesaurusFeature',\n  PREPROCESS_QUERY_EXPRESSION = 'PreprocessQueryExpression',\n  PREPROCESS_QUERY = 'PreprocessQuery',\n  STOP_WORDS = 'ApplyStopWordFeature',\n  FILTERS = 'ApplyFilterFeature',\n  RANKING = 'ApplyRankingFeature',\n  TOP_RESULT = 'ApplyTopResultFeature',\n  RANKING_WEIGHT = 'ApplyRankingWeightFeature',\n  INDEX_QUERY = 'Send query to index',\n  TOP_CLICKS = 'EvaluatingTopClicks',\n  PARTIAL_MATCH = 'PartialMatch',\n  NONE = 'NONE'\n}\n\nexport interface IExecutionReportSection {\n  name: string;\n  duration: number;\n  result: Record<string, any>;\n  description: string;\n  children?: IExecutionReportSection[];\n  applied?: string[];\n}\n\nexport interface IExecutionReportSectionBuilder {\n  build(executionReport: IExecutionReport): Promise<{ container: Dom; gridOptions?: agGridModule.GridOptions }>;\n}\n\nexport class ExecutionReport implements IRelevanceInspectorTab {\n  public gridOptions: agGridModule.GridOptions;\n  constructor(public results: IQueryResults, public bindings: IComponentBindings) {}\n\n  public static standardSectionHeader(title: string) {\n    const container = $$('div');\n    container.append($$('h4', undefined, title).el);\n\n    const agGridElement = $$('div', {\n      className: 'ag-theme-fresh'\n    });\n    container.append(agGridElement.el);\n\n    return {\n      container,\n      agGridElement\n    };\n  }\n\n  public async build() {\n    if (!this.results.executionReport) {\n      new Logger(this).error(\n        'Could not open execution report : Missing execution report on results. Try executing the query in debug mode.'\n      );\n      return $$('div');\n    }\n\n    const container = $$('div', {\n      className: 'execution-report-debug'\n    });\n\n    const gridOptions: agGridModule.GridOptions[] = [];\n\n    const authenticationSection = await new ExecutionReportAuthenticationSection().build(this.results.executionReport);\n    container.append(authenticationSection.container.el);\n    if (authenticationSection.gridOptions) {\n      gridOptions.push(authenticationSection.gridOptions);\n    }\n\n    const resolvedPipelineSection = await new ExecutionReportResolvedPipelineSection().build(this.results.executionReport);\n    container.append(resolvedPipelineSection.container.el);\n    if (resolvedPipelineSection.gridOptions) {\n      gridOptions.push(resolvedPipelineSection.gridOptions);\n    }\n\n    const resolvedRankingModifiers = await new ExecutionReportRankingModifiers().build(\n      this.results.results,\n      this.results.rankingExpressions,\n      this.bindings as IResultsComponentBindings\n    );\n    container.append(resolvedRankingModifiers.container.el);\n    if (resolvedRankingModifiers.gridOptions) {\n      gridOptions.push(resolvedRankingModifiers.gridOptions);\n    }\n\n    const queryParamOverrideSection = await new ExecutionReportQueryOverrideSection().build(this.results.executionReport);\n    container.append(queryParamOverrideSection.container.el);\n    if (queryParamOverrideSection.gridOptions) {\n      gridOptions.push(queryParamOverrideSection.gridOptions);\n    }\n\n    const thesaurusSection = await new ExecutionReportSimpleSection(\n      EXECUTION_REPORT_SECTION.PREPROCESS_QUERY_EXPRESSION,\n      EXECUTION_REPORT_SECTION.THESAURUS,\n      'Thesaurus'\n    ).build(this.results.executionReport);\n\n    container.append(thesaurusSection.container.el);\n    if (thesaurusSection.gridOptions) {\n      gridOptions.push(thesaurusSection.gridOptions);\n    }\n\n    const stopWordsSection = await new ExecutionReportSimpleSection(\n      EXECUTION_REPORT_SECTION.PREPROCESS_QUERY_EXPRESSION,\n      EXECUTION_REPORT_SECTION.STOP_WORDS,\n      'Stop words'\n    ).build(this.results.executionReport);\n    container.append(stopWordsSection.container.el);\n    if (stopWordsSection.gridOptions) {\n      gridOptions.push(stopWordsSection.gridOptions);\n    }\n\n    const filtersSection = await new ExecutionReportSimpleSection(\n      EXECUTION_REPORT_SECTION.PREPROCESS_QUERY,\n      EXECUTION_REPORT_SECTION.FILTERS,\n      'Filters'\n    ).build(this.results.executionReport);\n    container.append(filtersSection.container.el);\n    if (filtersSection.gridOptions) {\n      gridOptions.push(filtersSection.gridOptions);\n    }\n\n    const rankingSection = await new ExecutionReportSimpleSection(\n      EXECUTION_REPORT_SECTION.PREPROCESS_QUERY,\n      EXECUTION_REPORT_SECTION.RANKING,\n      'Ranking'\n    ).build(this.results.executionReport);\n    container.append(rankingSection.container.el);\n    if (rankingSection.gridOptions) {\n      gridOptions.push(rankingSection.gridOptions);\n    }\n\n    const topResultsSection = await new ExecutionReportSimpleSection(\n      EXECUTION_REPORT_SECTION.PREPROCESS_QUERY,\n      EXECUTION_REPORT_SECTION.TOP_RESULT,\n      'Featured Results'\n    ).build(this.results.executionReport);\n    container.append(topResultsSection.container.el);\n\n    if (topResultsSection.gridOptions) {\n      gridOptions.push(topResultsSection.gridOptions);\n    }\n\n    const itdSection = await new ExecutionReportITDSection().build(this.results.executionReport);\n    container.append(itdSection.container.el);\n\n    if (itdSection.gridOptions) {\n      gridOptions.push(itdSection.gridOptions);\n    }\n\n    const rankingWeightsSection = await new ExecutionReportSimpleSection(\n      EXECUTION_REPORT_SECTION.PREPROCESS_QUERY,\n      EXECUTION_REPORT_SECTION.RANKING_WEIGHT,\n      'Ranking weights'\n    ).build(this.results.executionReport);\n    container.append(rankingWeightsSection.container.el);\n    if (rankingWeightsSection.gridOptions) {\n      gridOptions.push(rankingWeightsSection.gridOptions);\n    }\n\n    const indexQuerySection = await new ExecutionReportEffectiveIndexQuerySection().build(this.results.executionReport);\n    container.append(indexQuerySection.container.el);\n\n    this.gridOptions = {\n      api: {\n        sizeColumnsToFit: () => {\n          gridOptions.forEach(option => (option.api ? option.api.sizeColumnsToFit() : null));\n        }\n      }\n    } as any;\n\n    return container;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/ExecutionReport.ts","import { ITableDataSource, GenericHtmlRenderer } from './TableBuilder';\nimport { isArray, isObject, each } from 'underscore';\nimport { $$ } from '../../utils/Dom';\n\nexport type GenericValueOutputType = string | number | string[] | Record<string, any> | boolean | undefined;\n\nconst defaultNullOutput = '-- NULL --';\n\nexport class GenericValueOutput {\n  public output(section: GenericValueOutputType): ITableDataSource {\n    if (isArray(section)) {\n      return this.arrayJoined(section);\n    }\n    if (isObject(section)) {\n      return this.objectJoined(section as Record<string, any>);\n    }\n\n    return this.simpleValue(section as string | number | undefined);\n  }\n\n  private simpleValue(section: string | number | undefined) {\n    return {\n      content: this.valueOrNullOutput(section)\n    };\n  }\n\n  private objectJoined(section: Record<string, any>): ITableDataSource {\n    let content = '';\n    each(section, (value, key) => {\n      if (isArray(value)) {\n        const list = $$('dl');\n        list.append($$('dt', undefined, key).el);\n        const innerList = $$('dd', undefined, this.arrayJoined(value).content);\n        list.append(innerList.el);\n        content += list.el.outerHTML;\n      } else if (isObject(value)) {\n        content += this.objectJoined(value).content;\n      } else {\n        const list = $$('dl');\n        list.append($$('dt', undefined, key).el);\n        list.append($$('dd', undefined, this.valueOrNullOutput(value)).el);\n\n        content += list.el.outerHTML;\n      }\n    });\n\n    return {\n      content,\n      cellRenderer: GenericHtmlRenderer\n    };\n  }\n\n  private arrayJoined(section: string[] | undefined): ITableDataSource {\n    if (!section || section.length == 0) {\n      return {\n        content: defaultNullOutput\n      };\n    }\n\n    const list = $$('ul', {\n      className: 'relevance-inspector-list-output'\n    });\n\n    section.forEach(sectionValue => {\n      if (isObject(sectionValue)) {\n        list.append($$('li', undefined, this.objectJoined(sectionValue as any).content).el);\n      } else {\n        list.append($$('li', undefined, this.valueOrNullOutput(sectionValue)).el);\n      }\n    });\n    return {\n      content: list.el.outerHTML,\n      cellRenderer: GenericHtmlRenderer\n    };\n  }\n\n  private valueOrNullOutput(value: any) {\n    if (value != null && value !== '') {\n      return value.toString();\n    }\n    return defaultNullOutput;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/GenericValueOutput.ts","import { IExecutionReportSection } from './ExecutionReport';\nimport { GenericValueOutput } from './GenericValueOutput';\nimport { ITableDataSource } from './TableBuilder';\n\nexport class ExecutionReportGenericSection {\n  public build(executionReportSection: IExecutionReportSection): Record<string, ITableDataSource> {\n    return {\n      ...this.descriptionSection(executionReportSection),\n      ...this.durationSection(executionReportSection)\n    };\n  }\n\n  private descriptionSection(executionReportSection: IExecutionReportSection): Record<string, ITableDataSource> {\n    return {\n      Description: new GenericValueOutput().output(executionReportSection.description)\n    };\n  }\n\n  private durationSection(executionReportSection: IExecutionReportSection): Record<string, ITableDataSource> {\n    return {\n      Duration: new GenericValueOutput().output(`${executionReportSection.duration} ms`)\n    };\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/ExecutionReportGenericSection.ts","import { object, map, keys, reduce } from 'underscore';\nimport { StringUtils } from '../../utils/StringUtils';\nimport { $$, Dom } from '../../utils/Dom';\n\nexport interface IRankingInfo {\n  documentWeights: IListOfWeights;\n  totalWeight: number;\n  termsWeight: IListOfTermsWeights;\n  qreWeights: IListOfQRE[];\n}\n\nexport interface IListOfWeights {\n  Adjacency: number;\n  'Collaborative rating': number;\n  Custom: number;\n  Date: number;\n  QRE: number;\n  Quality: number;\n  'Ranking functions': number;\n  Source: number;\n  Title: number;\n  [key: string]: number;\n}\n\nexport interface IListOfQRE {\n  expression: string;\n  score: number;\n}\n\nexport type IListOfTermsWeights = Record<string, IWeightsPerTerm>;\n\nexport interface IWeightsPerTerm {\n  Weights: IWeightsPerTermBreakdown;\n  terms: Record<string, IWeightsPerTermPerDocument>;\n}\n\nexport interface IWeightsPerTermBreakdown {\n  Casing: number;\n  Concept: number;\n  Formatted: number;\n  Frequency: number;\n  Relation: number;\n  Summary: number;\n  Title: number;\n  URI: number;\n  [key: string]: number;\n}\n\nexport interface IWeightsPerTermPerDocument {\n  Correlation: number;\n  'TF-IDF': number;\n}\n\nexport const buildListOfTermsElement = (weightPerTerm: IWeightsPerTermBreakdown): Dom => {\n  const listItems = map(weightPerTerm, (value, key) => {\n    return {\n      dt: $$(\n        'dt',\n        {\n          className: 'coveo-relevance-inspector-dt'\n        },\n        `${key}`\n      ),\n      dd: $$(\n        'dd',\n        {\n          className: 'coveo-relevance-inspector-dd'\n        },\n        `${value}`\n      )\n    };\n  });\n  const total = reduce(weightPerTerm, (memo, value) => memo + value, 0);\n  const list = $$('dl');\n  listItems.forEach(item => {\n    list.append(item.dt.el);\n    list.append(item.dd.el);\n  });\n  list.append($$('dt', { className: 'coveo-relevance-inspector-dt' }, `Total`).el);\n  list.append($$('dd', { className: 'coveo-relevance-inspector-dd coveo-relevance-inspector-highlight' }, `${total}`).el);\n  return list;\n};\n\nexport const parseRankingInfo = (value: string): IRankingInfo | null => {\n  const REGEX_EXTRACT_DOCUMENT_WEIGHTS = /Document weights:\\n((?:.)*?)\\n+/g;\n  const REGEX_EXTRACT_TERMS_WEIGHTS = /Terms weights:\\n((?:.|\\n)*)\\n+/g;\n  const REGEX_EXTRACT_TOTAL_WEIGHTS = /Total weight: ([0-9]+)/g;\n\n  if (value) {\n    const docWeightsRegexResult = REGEX_EXTRACT_DOCUMENT_WEIGHTS.exec(value);\n    const termsWeightRegexResult = REGEX_EXTRACT_TERMS_WEIGHTS.exec(value);\n    const totalWeigthRegexResult = REGEX_EXTRACT_TOTAL_WEIGHTS.exec(value);\n\n    const qreWeights = parseQREWeights(value);\n    const documentWeights = parseWeights(docWeightsRegexResult ? docWeightsRegexResult[1] : null);\n    const termsWeight = parseTermsWeights(termsWeightRegexResult);\n    const totalWeight = totalWeigthRegexResult ? Number(totalWeigthRegexResult[1]) : null;\n\n    return {\n      documentWeights,\n      termsWeight,\n      totalWeight,\n      qreWeights\n    };\n  }\n  return null;\n};\n\nconst parseWeights = (value: string | null): IListOfWeights | null => {\n  const REGEX_EXTRACT_LIST_OF_WEIGHTS = /(\\w+(?:\\s\\w+)*): ([-0-9]+)/g;\n  const REGEX_EXTRACT_WEIGHT_GROUP = /^(\\w+(?:\\s\\w+)*): ([-0-9]+)$/;\n\n  if (value) {\n    const listOfWeight = value.match(REGEX_EXTRACT_LIST_OF_WEIGHTS);\n\n    if (listOfWeight) {\n      return object(\n        listOfWeight.map(weight => {\n          let weightGroup = weight.match(REGEX_EXTRACT_WEIGHT_GROUP);\n\n          if (weightGroup) {\n            const weightAppliedOn = weightGroup[1];\n            const weightValue = weightGroup[2];\n            return [weightAppliedOn, Number(weightValue)];\n          }\n          return null;\n        })\n      ) as IListOfWeights;\n    }\n  }\n\n  return null;\n};\n\nconst parseTermsWeights = (termsWeight: RegExpExecArray | null): IListOfTermsWeights | null => {\n  const REGEX_EXTRACT_GROUP_OF_TERMS = /((?:[^:]+: [0-9]+, [0-9]+; )+)\\n((?:\\w+: [0-9]+; )+)/g;\n  const REGEX_EXTRACT_SINGLE_TERM = /([^:]+): ([0-9]+), ([0-9]+); /g;\n\n  if (termsWeight && termsWeight[1]) {\n    let terms = StringUtils.match(termsWeight[1], REGEX_EXTRACT_GROUP_OF_TERMS);\n\n    return object(\n      map(terms, term => {\n        let words = object(\n          map(StringUtils.match(term[1], REGEX_EXTRACT_SINGLE_TERM), word => {\n            return [\n              word[1],\n              {\n                Correlation: Number(word[2]),\n                'TF-IDF': Number(word[3])\n              }\n            ];\n          })\n        );\n        const weights = parseWeights(term[2]);\n        return [\n          keys(words).join(', '),\n          {\n            terms: words,\n            Weights: weights\n          }\n        ];\n      })\n    ) as IListOfTermsWeights;\n  }\n  return null;\n};\n\nconst parseQREWeights = (value: string): IListOfQRE[] => {\n  const REGEX_EXTRACT_QRE_WEIGHTS = /(Expression:\\s\".*\")\\sScore:\\s(?!0)([-0-9]+)\\n+/g;\n\n  let qreWeightsRegexResult = REGEX_EXTRACT_QRE_WEIGHTS.exec(value);\n\n  const qreWeights: IListOfQRE[] = [];\n  while (qreWeightsRegexResult) {\n    qreWeights.push({\n      expression: qreWeightsRegexResult[1],\n      score: parseInt(qreWeightsRegexResult[2], 10)\n    });\n    qreWeightsRegexResult = REGEX_EXTRACT_QRE_WEIGHTS.exec(value);\n  }\n\n  return qreWeights;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/RankingInfoParser.ts","import {\n  IExecutionReportSectionBuilder,\n  EXECUTION_REPORT_SECTION,\n  IExecutionReportSection,\n  IExecutionReport,\n  ExecutionReport\n} from './ExecutionReport';\nimport { findWhere, find } from 'underscore';\nimport { ExecutionReportGenericSection } from './ExecutionReportGenericSection';\nimport { GenericValueOutput } from './GenericValueOutput';\nimport { TableBuilder } from './TableBuilder';\nimport agGridModule = require('ag-grid/main');\nimport { Dom } from '../../Core';\n\nexport interface IExecutionReportSimpleSection extends IExecutionReportSection {\n  applied: string[];\n}\n\nexport class ExecutionReportSimpleSection implements IExecutionReportSectionBuilder {\n  public constructor(\n    public topLevelProperty: EXECUTION_REPORT_SECTION,\n    public secondLevelProperty: EXECUTION_REPORT_SECTION,\n    public sectionTitle: string\n  ) {}\n\n  public async build(executionReport: IExecutionReport): Promise<{ container: Dom; gridOptions: agGridModule.GridOptions }> {\n    const { container, agGridElement } = ExecutionReport.standardSectionHeader(this.sectionTitle);\n    let gridOptions: agGridModule.GridOptions;\n    const topLevelProperty = find(executionReport.children, child => {\n      return child.name == this.topLevelProperty && child.children && findWhere(child.children, { name: this.secondLevelProperty });\n    });\n\n    if (topLevelProperty && topLevelProperty.children) {\n      const secondLevelProperty = findWhere(topLevelProperty.children, { name: this.secondLevelProperty }) as\n        | IExecutionReportSimpleSection\n        | undefined;\n\n      if (secondLevelProperty) {\n        const dataSource = [\n          {\n            ...new ExecutionReportGenericSection().build(secondLevelProperty),\n            ...{ Applied: new GenericValueOutput().output(secondLevelProperty.applied) }\n          }\n        ];\n\n        const tableBuilder = await new TableBuilder().build(dataSource, agGridElement);\n        gridOptions = tableBuilder.gridOptions;\n      }\n    } else {\n      const tableBuilder = await new TableBuilder().build(\n        [\n          {\n            [`${this.sectionTitle}`]: {\n              content: `NO DATA AVAILABLE FOR ${this.sectionTitle} IN CURRENT EXECUTION REPORT`\n            }\n          }\n        ],\n        agGridElement\n      );\n\n      gridOptions = tableBuilder.gridOptions;\n    }\n\n    return { container, gridOptions };\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/ExecutionReportSimpleSection.ts","import { parseRankingInfo, IRankingInfo, buildListOfTermsElement, IWeightsPerTerm } from './RankingInfoParser';\nimport { each, uniq, contains, chain, reduce } from 'underscore';\nimport { TableBuilder, ITableDataSource, GenericHtmlRenderer } from './TableBuilder';\nimport { $$, Dom } from '../../utils/Dom';\nimport { IQueryResult } from '../../rest/QueryResult';\nimport { IComponentBindings } from '../Base/ComponentBindings';\nimport { IResultsComponentBindings } from '../Base/ResultsComponentBindings';\nimport { IRelevanceInspectorTab } from './RelevanceInspector';\nimport agGridModule = require('ag-grid/main');\n\nexport class RankingInfoTable implements IRelevanceInspectorTab {\n  public gridOptions: agGridModule.GridOptions;\n  constructor(public results: IQueryResult[], public bindings: IComponentBindings) {}\n\n  public async build(): Promise<Dom> {\n    const container = $$('div');\n\n    const agGridElement = $$('div', {\n      className: 'ag-theme-fresh'\n    });\n    container.append(agGridElement.el);\n\n    let topLevelInfoThatHaveAtLeastANonZeroValue: string[] = [];\n    let containsKeywordRankingInfo = false;\n\n    this.results.forEach(result => {\n      const rankingInfo = parseRankingInfo(result.rankingInfo);\n      containsKeywordRankingInfo = rankingInfo.termsWeight != null;\n      if (rankingInfo && rankingInfo.documentWeights) {\n        each(rankingInfo.documentWeights, (value: number, key: string) => {\n          if (value != 0) {\n            topLevelInfoThatHaveAtLeastANonZeroValue.push(key);\n          }\n        });\n      }\n    });\n\n    topLevelInfoThatHaveAtLeastANonZeroValue = uniq(topLevelInfoThatHaveAtLeastANonZeroValue);\n\n    const data = this.results.map(result => {\n      const rankingInfo = parseRankingInfo(result.rankingInfo);\n\n      if (rankingInfo) {\n        const documentsWeights = this.buildTopLevelDocumentsWeights(rankingInfo, topLevelInfoThatHaveAtLeastANonZeroValue);\n        const breakdownPerTerm: Record<string, ITableDataSource> = {};\n\n        const onlyTopFewKeywords: Record<string, IWeightsPerTerm> = {};\n\n        chain(rankingInfo.termsWeight)\n          .keys()\n          .sortBy(key => {\n            const total = reduce(rankingInfo.termsWeight[key].Weights, (memo, value) => memo + value, 0);\n            return total;\n          })\n          .reverse()\n          .first(3)\n          .each(key => {\n            onlyTopFewKeywords[key] = rankingInfo.termsWeight[key];\n          });\n\n        each(onlyTopFewKeywords, (value, key) => {\n          const builtKey = `Keyword: ${key}`;\n          breakdownPerTerm[builtKey] = {\n            content: buildListOfTermsElement(value.Weights).el.outerHTML,\n            cellRenderer: GenericHtmlRenderer,\n            width: 200\n          };\n        });\n\n        const totalContent = rankingInfo.totalWeight ? rankingInfo.totalWeight : 0;\n        return {\n          ...TableBuilder.thumbnailCell(result, this.bindings as IResultsComponentBindings),\n          ...documentsWeights,\n          ...breakdownPerTerm,\n          ...{ Total: { content: totalContent || 0 } }\n        };\n      }\n      return {};\n    });\n\n    const { gridOptions } = await new TableBuilder().build(data, agGridElement, {\n      getRowHeight: () => {\n        return containsKeywordRankingInfo ? 400 : 250;\n      },\n      onGridReady: params => {\n        setTimeout(() => {\n          if (params) {\n            params.api.sizeColumnsToFit();\n            params.api.setSortModel([{ colId: 'Total', sort: 'desc' }]);\n          }\n        }, 0);\n      }\n    });\n\n    this.gridOptions = gridOptions;\n\n    return container;\n  }\n\n  private buildTopLevelDocumentsWeights(rankingInfo: IRankingInfo, hasAtLeastOneNonZeroValue: string[]): Record<string, ITableDataSource> {\n    const documentWeights: Record<string, ITableDataSource> = {};\n    each(rankingInfo.documentWeights || {}, (value, key) => {\n      if (contains(hasAtLeastOneNonZeroValue, key)) documentWeights[key] = { content: value || 0 };\n    });\n    return documentWeights;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/RankingInfoTable.ts","import { $$ } from '../../utils/Dom';\n\nlet isAgGridLoaded = false;\nlet isAgGridLoading: Promise<boolean> | null = null;\nconst agGridLibUrl = 'https://cdnjs.cloudflare.com/ajax/libs/ag-grid/16.0.1/ag-grid.min.noStyle.js';\nconst agGridStyleBaseUrl = 'https://cdnjs.cloudflare.com/ajax/libs/ag-grid/16.0.1/styles/ag-grid.css';\nconst agGridStyleFreshUrl = 'https://cdnjs.cloudflare.com/ajax/libs/ag-grid/16.0.1/styles/ag-theme-fresh.css';\n\ndeclare const agGrid: any;\n\n// Should only be used for UT\nexport const reset = (doc = document) => {\n  isAgGridLoaded = false;\n  isAgGridLoading = null;\n};\n\nexport const loadAgGridLibrary = (doc = document) => {\n  return new Promise((resolve, reject) => {\n    if (isAgGridLoaded) {\n      resolve(true);\n    } else if (typeof agGrid !== 'undefined') {\n      isAgGridLoaded = true;\n      resolve(true);\n    } else {\n      addAgGridScriptsToDocument(doc);\n      isAgGridLoading.then(() => resolve(true));\n      isAgGridLoading.catch(() => reject(false));\n    }\n  });\n};\n\nconst addAgGridScriptsToDocument = (doc = document) => {\n  if (!isAgGridLoading) {\n    const script = $$('script', {\n      src: agGridLibUrl,\n      type: 'text/javascript',\n      async: true\n    }).el as HTMLScriptElement;\n\n    const styleBase = $$('link', {\n      href: agGridStyleBaseUrl,\n      rel: 'stylesheet',\n      type: 'text/css'\n    }).el as HTMLLinkElement;\n\n    const style = $$('link', {\n      href: agGridStyleFreshUrl,\n      rel: 'stylesheet',\n      type: 'text/css'\n    }).el as HTMLLinkElement;\n\n    doc.head.appendChild(script);\n    doc.head.appendChild(styleBase);\n    doc.head.appendChild(style);\n\n    isAgGridLoading = new Promise((resolveScriptLoaded, rejectScriptLoaded) => {\n      script.onload = () => {\n        resolveScriptLoaded(true);\n      };\n      script.onerror = () => {\n        isAgGridLoaded = false;\n        rejectScriptLoaded(false);\n      };\n    });\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/AgGrid.ts","import { TableBuilder, ITableDataSource } from './TableBuilder';\nimport { map, each, find } from 'underscore';\nimport agGridModule = require('ag-grid/main');\nimport { IQueryResult } from '../../rest/QueryResult';\nimport { IComponentBindings } from '../Base/ComponentBindings';\nimport { $$, Dom } from '../../utils/Dom';\nimport { StringUtils } from '../../utils/StringUtils';\nimport { DateUtils } from '../../utils/DateUtils';\nimport { IResultsComponentBindings } from '../Base/ResultsComponentBindings';\nimport { IRelevanceInspectorTab } from './RelevanceInspector';\nimport { TextInput } from '../FormWidgets/TextInput';\nimport { IFieldDescription } from '../../rest/FieldDescription';\n\nexport class MetaDataTable implements IRelevanceInspectorTab {\n  public gridOptions: agGridModule.GridOptions;\n\n  constructor(public results: IQueryResult[], public bindings: IComponentBindings) {}\n\n  public async build(): Promise<Dom> {\n    if (!this.bindings.queryController) {\n      return;\n    }\n\n    const fieldsDescription = await this.bindings.queryController.getEndpoint().listFields();\n\n    const container = $$('div', {\n      className: 'metadata-table'\n    });\n\n    const builders = this.results.map(async result => {\n      const nestedContainer = $$('div');\n      container.append(nestedContainer.el);\n\n      const nestedAgGrid = $$('div', {\n        className: 'ag-theme-fresh'\n      });\n\n      nestedContainer.append(nestedAgGrid.el);\n\n      const thumbnail = TableBuilder.thumbnailCell(result, this.bindings as IResultsComponentBindings);\n      const fields: Record<string, ITableDataSource> = {};\n\n      fields[`Fields Values`] = {\n        content: { result, fieldsDescription },\n        cellRenderer: FieldValuesRenderer,\n        width: 900,\n        getQuickFilterText: (params: agGridModule.GetQuickFilterTextParams) => {\n          const allValues = map(params.value.result.raw, val => val.toString());\n          return Object.keys(params.value.result.raw)\n            .concat(allValues)\n            .join(' ');\n        },\n        onCellDoubleClicked: (params: agGridModule.CellDoubleClickedEvent) => {\n          const el = params.event ? (params.event.target as Node) : null;\n          if (el && window.getSelection && document.createRange) {\n            const selection = window.getSelection();\n            const range = document.createRange();\n            range.selectNodeContents(el);\n            selection.removeAllRanges();\n            selection.addRange(range);\n          }\n        }\n      };\n\n      return await new TableBuilder().build(\n        [\n          {\n            ...thumbnail,\n            ...fields\n          }\n        ],\n        nestedAgGrid,\n        {\n          rowHeight: 400\n        }\n      );\n    });\n\n    this.gridOptions = {\n      api: {\n        sizeColumnsToFit: () => {\n          builtTables.forEach(built => (built.gridOptions.api ? built.gridOptions.api.sizeColumnsToFit : null));\n        }\n      }\n    } as any;\n\n    const builtTables = await Promise.all(builders);\n    const textInput = new TextInput(input => {\n      builtTables.forEach(built => {\n        const api = built.gridOptions && built.gridOptions.api;\n        if (api) {\n          api.setQuickFilter(input.getValue());\n          api.onRowHeightChanged();\n        }\n      });\n    }, 'Filters on Fields Values');\n    container.prepend(textInput.getElement());\n\n    return container;\n  }\n}\n\nexport class FieldValuesRenderer implements agGridModule.ICellRendererComp {\n  private element: any | undefined;\n  private currentFilter: string | undefined;\n  private params: any;\n\n  public init(params: any) {\n    this.element = params.value;\n    this.params = params;\n    this.currentFilter = params.api.filterManager.quickFilter;\n    params.value.el = this.listAsInput(this.element.result);\n  }\n\n  public getGui(): HTMLElement {\n    if (this.element) {\n      const list = this.listAsInput(this.element.result);\n      this.params.eParentOfValue.appendChild(list.el);\n      const height = Math.max(list.height() + 50, 200);\n      const maxHeight = Math.min(height, 5000);\n      this.params.node.setRowHeight(maxHeight);\n      return $$('div', undefined, list).el;\n    }\n    return $$('div', undefined, 'N.A').el;\n  }\n\n  private listAsInput(result: IQueryResult) {\n    const container = $$('div');\n\n    each(result.raw, (value: string, fieldInResult: string) => {\n      if (fieldInResult == 'allmetadatavalues' || fieldInResult.indexOf('sys') == 0) {\n        return;\n      }\n\n      if (this.isCurrentElementFilteredOut(value, fieldInResult)) {\n        return;\n      }\n\n      const inputGroup = $$('div', { className: 'coveo-relevance-inspector-input-group' });\n      const fieldName = $$(\n        'div',\n        {\n          className: 'coveo-relevance-inspector-metadata-name'\n        },\n        fieldInResult\n      );\n\n      const fieldValue = this.convertFieldValueToReadableFormat(result, fieldInResult);\n\n      const fieldValueElement = $$(\n        'div',\n        {\n          className: 'coveo-relevance-inspector-metadata-value'\n        },\n        fieldValue\n      );\n\n      if (this.currentFilter) {\n        this.highlightSearch(fieldName.el, this.currentFilter);\n        this.highlightSearch(fieldValueElement.el, this.currentFilter);\n      }\n\n      inputGroup.append(fieldName.el);\n      inputGroup.append(fieldValueElement.el);\n      container.append(inputGroup.el);\n    });\n\n    return container;\n  }\n\n  private isCurrentElementFilteredOut(value: string, fieldInResult: string) {\n    if (this.currentFilter) {\n      const matchInFieldName = fieldInResult.toLowerCase().indexOf(this.currentFilter.toLowerCase()) != -1;\n      const matchInFieldValue = value\n        ? value\n            .toString()\n            .toLowerCase()\n            .indexOf(this.currentFilter.toLowerCase()) != -1\n        : false;\n\n      if (!matchInFieldName && !matchInFieldValue) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  private convertFieldValueToReadableFormat(result: IQueryResult, fieldInResult: string) {\n    let fieldValue = result.raw[fieldInResult].toString();\n    if (this.element.fieldsDescription) {\n      const matchingFieldDescription = find(this.element.fieldsDescription as IFieldDescription[], description => {\n        return description.name.replace('@', '').toLowerCase() == fieldInResult;\n      });\n      if (matchingFieldDescription && matchingFieldDescription.fieldType == 'Date') {\n        fieldValue = `${DateUtils.convertToStandardDate(fieldValue).toString()} ( Epoch : ${fieldValue} )`;\n      }\n    }\n    return fieldValue;\n  }\n\n  private highlightSearch(elementToSearch: HTMLElement, search: string) {\n    let asHTMLElement: HTMLElement = elementToSearch;\n\n    if (asHTMLElement != null && asHTMLElement.innerText != null) {\n      const match = asHTMLElement.innerText.split(new RegExp('(?=' + StringUtils.regexEncode(search) + ')', 'gi'));\n      asHTMLElement.innerHTML = '';\n      match.forEach(value => {\n        const regex = new RegExp('(' + StringUtils.regexEncode(search) + ')', 'i');\n        const group = value.match(regex);\n        let span;\n\n        if (group != null) {\n          span = $$('span', {\n            className: 'coveo-relevance-inspector-highlight'\n          });\n          span.text(group[1]);\n          asHTMLElement.appendChild(span.el);\n          span = $$('span');\n          span.text(value.substr(group[1].length));\n          asHTMLElement.appendChild(span.el);\n        } else {\n          span = $$('span');\n          span.text(value);\n          asHTMLElement.appendChild(span.el);\n        }\n      });\n    }\n  }\n\n  public refresh(params: any): boolean {\n    return true;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/MetaDataTable.ts","import { $$, Dom } from '../../utils/Dom';\nimport { find } from 'underscore';\n\nexport class RelevanceInspectorTabs {\n  public navigationSection: Dom;\n  public tabContentSection: Dom;\n  private navigationElements: Dom[];\n  private tabContentElements: Dom[];\n\n  constructor(public onTabChange: (id: string) => void) {\n    this.navigationSection = $$('div', {\n      className: 'coveo-relevance-inspector-tab-navigation-section'\n    });\n\n    this.tabContentSection = $$('div', {\n      className: 'coveo-relevance-inspector-tab-content-section'\n    });\n\n    this.navigationElements = [];\n    this.tabContentElements = [];\n  }\n\n  public select(id: string) {\n    const navElementToActivate = this.findNavigationById(id);\n    const tabContentToActivate = this.findTabContentById(id);\n\n    if (navElementToActivate && tabContentToActivate) {\n      this.activateTabNavigation(navElementToActivate);\n      this.activateTabContent(tabContentToActivate);\n      if (this.onTabChange) {\n        this.onTabChange(id);\n      }\n    }\n  }\n\n  public addNavigation(caption: string, id: string) {\n    const navigationElement = $$(\n      'div',\n      {\n        id,\n        className: 'coveo-relevance-inspector-tab'\n      },\n      caption\n    );\n\n    navigationElement.on('click', () => this.select(id));\n\n    this.navigationElements.push(navigationElement);\n    this.navigationSection.append(navigationElement.el);\n\n    return this;\n  }\n\n  public addContent(content: Dom, targetId: string) {\n    const tabContent = $$('div', {\n      className: 'coveo-relevance-inspector-tab-content',\n      'data-target-tab': targetId\n    });\n    tabContent.append(content.el);\n\n    this.tabContentElements.push(tabContent);\n    this.tabContentSection.append(tabContent.el);\n\n    return this;\n  }\n\n  public addSection(caption: string, content: Dom, id: string) {\n    return this.addNavigation(caption, id).addContent(content, id);\n  }\n\n  private findNavigationById(id: string) {\n    return find(this.navigationElements, element => element.getAttribute('id') == id);\n  }\n\n  private findTabContentById(id: string) {\n    return find(this.tabContentElements, tabContentElement => tabContentElement.getAttribute('data-target-tab') == id);\n  }\n\n  private activateTabNavigation(navigationElement: Dom) {\n    this.navigationElements.forEach(element => {\n      element.removeClass('coveo-selected');\n    });\n    navigationElement.addClass('coveo-selected');\n  }\n\n  private activateTabContent(contentElement: Dom) {\n    this.tabContentElements.forEach(element => {\n      element.removeClass('coveo-selected');\n    });\n    contentElement.addClass('coveo-selected');\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/RelevanceInspectorTabs.ts","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../node_modules/css-loader/index.js??ref--0-2!../node_modules/resolve-url-loader/index.js??ref--0-3!../node_modules/sass-loader/lib/loader.js??ref--0-4!./_RelevanceInspector.scss\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {\"hmr\":true}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../node_modules/css-loader/index.js??ref--0-2!../node_modules/resolve-url-loader/index.js??ref--0-3!../node_modules/sass-loader/lib/loader.js??ref--0-4!./_RelevanceInspector.scss\", function() {\n\t\t\tvar newContent = require(\"!!../node_modules/css-loader/index.js??ref--0-2!../node_modules/resolve-url-loader/index.js??ref--0-3!../node_modules/sass-loader/lib/loader.js??ref--0-4!./_RelevanceInspector.scss\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sass/_RelevanceInspector.scss\n// module id = 817\n// module chunks = 0","exports = module.exports = require(\"../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \"@keyframes fadeout{0%{opacity:1}to{opacity:0}}@keyframes fadein{0%{opacity:0}to{opacity:1}}@keyframes slideInLeft{0%{transform:translateX(-2000px);opacity:0}to{transform:translateX(0);opacity:1}}@keyframes coveo-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes loadingFade{0%{opacity:0}50%{opacity:.8}to{opacity:0}}.coveo-relevance-inspector{text-align:center;padding:10px;line-height:20px;height:40px;top:0;z-index:1000}.coveo-relevance-inspector.coveo-hidden{display:none}.relevance-inspector-modal .coveo-logo{height:64px;width:178px}.ag-theme-fresh .ag-cell{overflow:auto;white-space:normal;word-break:break-word}.ag-theme-fresh .ag-font-style{user-select:auto}.coveo-relevance-inspector-tab-navigation-section{margin-bottom:20px}.coveo-relevance-inspector-tab-content{display:none}.coveo-relevance-inspector-tab-content.coveo-selected{display:block;animation:slideInLeft .3s ease-in}.coveo-relevance-inspector-tab{display:-moz-flex;display:-ms-flexbox;display:flex;box-align:center;-moz-align-items:center;-ms-align-items:center;-o-align-items:center;align-items:center;-ms-flex-align:center;font-size:12px;font-weight:700;padding:0 5px 10px;border-bottom:1px solid #bcc3ca;text-transform:uppercase;border-bottom:2px solid #bcc3ca;display:inline-block;margin-right:10px}.coveo-relevance-inspector-tab.coveo-selected,.coveo-relevance-inspector-tab.coveo-selected:hover{border-bottom:2px solid #263e55}.coveo-relevance-inspector-tab:hover{color:#263e55}.coveo-relevance-inspector-highlight{display:inline-block;font-weight:700}.coveo-relevance-inspector-result-thumbnail{min-width:500px;white-space:normal}.coveo-relevance-inspector-dt{font-weight:700}.coveo-relevance-inspector-dd,.coveo-relevance-inspector-dt{font-size:14px;line-height:14px;padding:2px 0 4px}.coveo-relevance-inspector-metadata-name,.coveo-relevance-inspector-metadata-value{background-color:#e9ecef;display:block;padding:10px;line-height:1.5;border:1px solid #ced4da;border-radius:2px;position:relative;flex:1 1 auto;margin-bottom:0}.coveo-relevance-inspector-metadata-name{max-width:25%;min-width:25%}.coveo-relevance-inspector-metadata-value{width:75%;overflow:auto}.coveo-relevance-inspector-input-group{position:relative;display:flex;flex-wrap:wrap;align-items:stretch;width:100%}.coveo-relevance-inspector-tab-content .coveo-input{margin:40px 0 10px}.coveo-relevance-inspector-available-fields-popup{background:#fff;border:1px solid #bcc3ca;border-radius:2px;padding:10px 5px 10px 20px;width:200px;overflow:hidden;list-style-type:none}.coveo-relevance-inspector-available-fields-popup-value{padding:0 0 10px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.coveo-available-fields-table-button{overflow:hidden;display:inline-block;position:relative;top:50%;transform:translateY(-50%)}.coveo-relevance-inspector-effective-query-collapsible{display:none}.coveo-relevance-inspector-effective-query-collapsible.coveo-active{display:inherit}.coveo-relevance-inspector-table{width:100%;text-align:left;border:none;border-spacing:0}.coveo-relevance-inspector-table tr{height:37px;font-size:15px;line-height:18px}.coveo-relevance-inspector-table tr:first-child{padding-left:10px}.coveo-relevance-inspector-table tr:hover td{background-color:#e6ecf0}.coveo-relevance-inspector-table td{position:relative;vertical-align:middle;padding:9px 15px;margin-left:15px;text-align:left;border-bottom:1px solid #bcc3ca}.coveo-relevance-inspector-table td:first-child{border-left:5px solid transparent}.coveo-relevance-inspector-inline-ranking{border:1px solid #bcc3ca;border-radius:2px;display:-moz-flex;display:-ms-flexbox;display:flex;-webkit-box-lines:multiple;-moz-box-lines:multiple;box-lines:multiple;-ms-flex-wrap:wrap;flex-wrap:wrap;padding:10px;margin-bottom:10px}.coveo-relevance-inspector-inline-ranking-section{margin:10px}.coveo-relevance-inspector-inline-ranking-terms{display:none;padding:10px;width:100%}.coveo-relevance-inspector-inline-ranking-terms.coveo-active{display:block;animation:fadein .5s}.coveo-relevance-inspector-inline-ranking-terms h2{border-bottom:1px solid #bcc3ca}.coveo-relevance-inspector-inline-ranking-terms dl{display:-moz-flex;display:-ms-flexbox;display:flex;-webkit-box-lines:multiple;-moz-box-lines:multiple;box-lines:multiple;-ms-flex-wrap:wrap;flex-wrap:wrap;box-align:center;-moz-align-items:center;-ms-align-items:center;-o-align-items:center;align-items:center;-ms-flex-align:center}.coveo-relevance-inspector-inline-ranking-terms dt{margin:10px 20px}.coveo-relevance-inspector-inline-ranking-terms dd{margin-left:0}.coveo-relevance-inspector-inline-ranking-button{height:35px;margin:5px 0}.relevance-inspector-list-output{padding-left:5px;margin-top:0}.coveo-relevance-inspector-inline-ranking-qre-expression{font-weight:700;word-break:break-all}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader??ref--0-2!./node_modules/resolve-url-loader??ref--0-3!./node_modules/sass-loader/lib/loader.js??ref--0-4!./sass/_RelevanceInspector.scss\n// module id = 818\n// module chunks = 0","import {\n  IExecutionReport,\n  EXECUTION_REPORT_SECTION,\n  IExecutionReportSection,\n  IExecutionReportSectionBuilder,\n  ExecutionReport\n} from './ExecutionReport';\nimport { TableBuilder } from './TableBuilder';\nimport { find, map } from 'underscore';\nimport { ExecutionReportGenericSection } from './ExecutionReportGenericSection';\nimport { GenericValueOutput, GenericValueOutputType } from './GenericValueOutput';\nimport agGridModule = require('ag-grid/main');\nimport { Dom } from '../../utils/Dom';\n\nexport interface IUserIDExecutionReport {\n  name: string;\n  kind: string;\n  provider: string;\n  info: Record<string, string>;\n}\n\nexport interface IExecutionReportAuthenticationSection extends IExecutionReportSection {\n  name: 'PerformAuthentication';\n  configured: {\n    primary: string;\n    secondary: string[];\n    mandatory: string[];\n  };\n  result: {\n    userIds: IUserIDExecutionReport[];\n    queryRestrictions: Record<string, string>;\n    roles: string[];\n    userGroups: string[];\n  };\n}\n\nexport class ExecutionReportAuthenticationSection implements IExecutionReportSectionBuilder {\n  public async build(executionReport: IExecutionReport): Promise<{ container: Dom; gridOptions: agGridModule.GridOptions }> {\n    const { container, agGridElement } = ExecutionReport.standardSectionHeader('Authentication');\n    let gridOptions: agGridModule.GridOptions;\n    const authenticationSection = find(executionReport.children, child => child.name == EXECUTION_REPORT_SECTION.PERFORM_AUTHENTICATION) as\n      | IExecutionReportAuthenticationSection\n      | undefined;\n\n    if (authenticationSection) {\n      const dataSource = [\n        {\n          ...new ExecutionReportGenericSection().build(authenticationSection),\n          ...this.configurationSection(authenticationSection),\n          ...this.pipelineOuputSection(authenticationSection)\n        }\n      ];\n\n      const tableBuilder = await new TableBuilder().build(dataSource, agGridElement, {\n        rowHeight: 150\n      });\n      gridOptions = tableBuilder.gridOptions;\n    }\n\n    return { container, gridOptions };\n  }\n\n  private configurationSection(authenticationSection: IExecutionReportAuthenticationSection) {\n    return {\n      Configured: {\n        children: [\n          {\n            Primary: this.genericOutput(authenticationSection.configured.primary),\n            Secondary: this.genericOutput(authenticationSection.configured.secondary),\n            Mandatory: this.genericOutput(authenticationSection.configured.mandatory)\n          }\n        ]\n      }\n    };\n  }\n\n  private pipelineOuputSection(authenticationSection: IExecutionReportAuthenticationSection) {\n    return {\n      'Pipeline Output': {\n        children: [\n          {\n            'User ids': {\n              children: this.usersIds(authenticationSection.result.userIds)\n            },\n            'Query restriction': {\n              children: this.queryRestrictions(authenticationSection.result.queryRestrictions)\n            },\n            Roles: { ...this.genericOutput(authenticationSection.result.roles), width: 200 },\n            'User groups': this.genericOutput(authenticationSection.result.userGroups)\n          }\n        ]\n      }\n    };\n  }\n\n  private usersIds(userIds: IUserIDExecutionReport[]) {\n    return map(userIds, userId => {\n      return {\n        [userId.name]: {\n          children: [\n            {\n              Kind: this.genericOutput(userId.kind),\n              Provider: { ...this.genericOutput(userId.provider), width: 150 },\n              Info: { content: userId.info }\n            }\n          ]\n        }\n      };\n    });\n  }\n\n  private genericOutput(section: GenericValueOutputType) {\n    return new GenericValueOutput().output(section);\n  }\n\n  private queryRestrictions(queryRestrictions: Record<string, string>) {\n    return map(queryRestrictions, (value, key) => {\n      return {\n        [key]: this.genericOutput(value)\n      };\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/ExecutionReportAuthenticationSection.ts","import {\n  IExecutionReportSection,\n  IExecutionReport,\n  EXECUTION_REPORT_SECTION,\n  IExecutionReportSectionBuilder,\n  ExecutionReport\n} from './ExecutionReport';\nimport { find } from 'underscore';\nimport { ExecutionReportGenericSection } from './ExecutionReportGenericSection';\nimport { TableBuilder } from './TableBuilder';\nimport { GenericValueOutput } from './GenericValueOutput';\nimport agGridModule = require('ag-grid/main');\nimport { Dom } from '../../utils/Dom';\n\nexport interface IExecutionReportResolvePipelineSection extends IExecutionReportSection {\n  result: {\n    pipeline: string;\n    splitTest: {\n      name: string;\n      ratio: number;\n    };\n  };\n}\n\nexport class ExecutionReportResolvedPipelineSection implements IExecutionReportSectionBuilder {\n  public async build(executionReport: IExecutionReport): Promise<{ container: Dom; gridOptions: agGridModule.GridOptions }> {\n    const { container, agGridElement } = ExecutionReport.standardSectionHeader('Pipeline');\n    let gridOptions: agGridModule.GridOptions;\n\n    const resolvedPipelineSection = find(executionReport.children, child => child.name == EXECUTION_REPORT_SECTION.RESOLVE_PIPELINE) as\n      | IExecutionReportResolvePipelineSection\n      | undefined;\n\n    if (resolvedPipelineSection) {\n      const dataSource = [\n        {\n          ...new ExecutionReportGenericSection().build(resolvedPipelineSection),\n          ...{ Pipeline: new GenericValueOutput().output(resolvedPipelineSection.result.pipeline) },\n          ...{ 'Split Test': new GenericValueOutput().output(resolvedPipelineSection.result.splitTest) }\n        }\n      ];\n\n      const tableBuilder = await new TableBuilder().build(dataSource, agGridElement);\n      gridOptions = tableBuilder.gridOptions;\n    }\n\n    return { container, gridOptions };\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/ExecutionReportResolvedPipelineSection.ts","import {\n  IExecutionReportSection,\n  IExecutionReportSectionBuilder,\n  IExecutionReport,\n  EXECUTION_REPORT_SECTION,\n  ExecutionReport\n} from './ExecutionReport';\nimport { find } from 'underscore';\nimport { ExecutionReportGenericSection } from './ExecutionReportGenericSection';\nimport { TableBuilder } from './TableBuilder';\nimport { GenericValueOutput } from './GenericValueOutput';\nimport agGridModule = require('ag-grid/main');\nimport { Dom } from '../../utils/Dom';\n\nexport interface IExecutionReportQueryOverrideSection extends IExecutionReportSection {\n  applied: string[];\n}\n\nexport class ExecutionReportQueryOverrideSection implements IExecutionReportSectionBuilder {\n  public async build(executionReport: IExecutionReport): Promise<{ container: Dom; gridOptions: agGridModule.GridOptions }> {\n    const { container, agGridElement } = ExecutionReport.standardSectionHeader('Query Params Override');\n    let gridOptions: agGridModule.GridOptions;\n\n    const queryOverrideSection = find(executionReport.children, child => child.name == EXECUTION_REPORT_SECTION.QUERY_PARAM_OVERRIDE) as\n      | IExecutionReportQueryOverrideSection\n      | undefined;\n\n    if (queryOverrideSection) {\n      const dataSource = [\n        {\n          ...new ExecutionReportGenericSection().build(queryOverrideSection),\n          Applied: new GenericValueOutput().output(queryOverrideSection.applied)\n        }\n      ];\n\n      const tableBuilder = await new TableBuilder().build(dataSource, agGridElement);\n      gridOptions = tableBuilder.gridOptions;\n    }\n\n    return { container, gridOptions };\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/ExecutionReportQueryOverrideSection.ts","import { IExecutionReport, IExecutionReportSectionBuilder, EXECUTION_REPORT_SECTION, ExecutionReport } from './ExecutionReport';\nimport { findWhere, each, contains } from 'underscore';\nimport { GenericValueOutput } from './GenericValueOutput';\nimport { $$, Dom } from '../../utils/Dom';\n\nexport interface IExecutionReportEffectiveIndexQuerySection {\n  result: {\n    in: Record<string, any>;\n  };\n}\n\nconst collapsibleSectionsInReport: string[] = ['Facets', 'RankingOverrides', 'RankingExpressions'];\n\nexport class ExecutionReportEffectiveIndexQuerySection implements IExecutionReportSectionBuilder {\n  public async build(executionReport: IExecutionReport): Promise<{ container: Dom }> {\n    const { container } = ExecutionReport.standardSectionHeader('Query sent to index');\n\n    const table = $$('table', {\n      className: 'coveo-relevance-inspector-table'\n    });\n\n    container.append(table.el);\n\n    const indexQuerySection = findWhere(executionReport.children, { description: EXECUTION_REPORT_SECTION.INDEX_QUERY });\n\n    if (indexQuerySection) {\n      each(indexQuerySection.result.in, (paramValue: string, paramKey: string) => {\n        const row = $$('tr');\n        table.append(row.el);\n\n        const id = `executionReportIndexExecution${paramKey}`;\n\n        if (contains(collapsibleSectionsInReport, paramKey) && paramValue) {\n          const btn = $$(\n            'button',\n            {\n              className: 'coveo-button',\n              type: 'button'\n            },\n            paramKey\n          );\n\n          const tdTarget = $$(\n            'td',\n            {\n              id,\n              className: 'coveo-relevance-inspector-effective-query-collapsible'\n            },\n            new GenericValueOutput().output(paramValue).content\n          );\n\n          btn.on('click', () => {\n            tdTarget.toggleClass('coveo-active');\n          });\n\n          row.append($$('td', undefined, btn).el);\n          row.append(tdTarget.el);\n        } else {\n          row.append($$('td', undefined, paramKey).el);\n          row.append($$('td', undefined, new GenericValueOutput().output(paramValue).content).el);\n        }\n      });\n    }\n    return { container };\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/ExecutionReportEffectiveIndexQuerySection.ts","import { ExecutionReport } from './ExecutionReport';\nimport { TableBuilder, ITableDataSource } from './TableBuilder';\nimport { IQueryResult } from '../../rest/QueryResult';\nimport { IRankingExpression } from '../../rest/RankingExpression';\nimport { map, find } from 'underscore';\nimport { GenericValueOutput } from './GenericValueOutput';\nimport { Dom } from '../../utils/Dom';\nimport { IComponentBindings } from '../Base/ComponentBindings';\nimport agGridModule = require('ag-grid/main');\nimport { QueryBuilder } from '../Base/QueryBuilder';\n\nexport class ExecutionReportRankingModifiers {\n  public async build(\n    results: IQueryResult[],\n    rankingExpressions: IRankingExpression[],\n    bindings: IComponentBindings\n  ): Promise<{ container: Dom; gridOptions: agGridModule.GridOptions }> {\n    const { container, agGridElement } = ExecutionReport.standardSectionHeader('Ranking Modifiers & Machine Learning Boosts');\n\n    const dataSourcePromises = map(rankingExpressions, async rankingExpression => {\n      const isAutomaticBoostRegex = /^(@permanentid|@urihash)=\"?([a-zA-Z0-9]+)\"?$/;\n\n      let thumbnailPreview: Record<string, ITableDataSource> = TableBuilder.thumbnailCell(null, null);\n      let returnedByIndexForCurrentQuery = '-- NULL --';\n      let result: IQueryResult = null;\n\n      const isAutomaticBoost = rankingExpression.expression.match(isAutomaticBoostRegex);\n      if (isAutomaticBoost) {\n        const permanentIDUsedInAutomaticBoost = isAutomaticBoost[2];\n        const extracted = await this.extractDocumentInfoFromBoost(results, permanentIDUsedInAutomaticBoost, rankingExpression, bindings);\n        thumbnailPreview = TableBuilder.thumbnailCell(extracted.result, bindings);\n        result = extracted.result;\n        returnedByIndexForCurrentQuery = extracted.returnedByIndexForCurrentQuery.toString();\n      }\n\n      return {\n        ...thumbnailPreview,\n        ReturnedByIndexForCurrentQuery: new GenericValueOutput().output(returnedByIndexForCurrentQuery),\n        IsRecommendation: new GenericValueOutput().output(result ? result.isRecommendation : '-- NULL --'),\n        Expression: { ...new GenericValueOutput().output(rankingExpression.expression), width: 150 },\n        Modifier: new GenericValueOutput().output(rankingExpression.modifier)\n      };\n    });\n\n    const dataSource = await Promise.all(dataSourcePromises);\n\n    const { gridOptions } = await new TableBuilder().build(dataSource, agGridElement, {\n      rowHeight: 150\n    });\n\n    return {\n      container,\n      gridOptions\n    };\n  }\n\n  private async extractDocumentInfoFromBoost(\n    results: IQueryResult[],\n    permanentID: string,\n    rankingExpression: IRankingExpression,\n    bindings: IComponentBindings\n  ) {\n    let matchingResult = {\n      result: null,\n      returnedByIndexForCurrentQuery: false\n    };\n\n    const resultInResultSet = find(results, result => {\n      return result.raw.permanentid == permanentID || result.raw.urihash == permanentID;\n    });\n\n    if (resultInResultSet) {\n      matchingResult = {\n        result: resultInResultSet,\n        returnedByIndexForCurrentQuery: true\n      };\n      return matchingResult;\n    }\n\n    const queryBuilder = new QueryBuilder();\n    queryBuilder.advancedExpression.add(rankingExpression.expression);\n    const resultsFromIndex = await bindings.queryController.getEndpoint().search(queryBuilder.build());\n    matchingResult = {\n      result: resultsFromIndex.results[0],\n      returnedByIndexForCurrentQuery: false\n    };\n\n    return matchingResult;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/ExecutionReportRankingModifiers.ts","import agGridModule = require('ag-grid/main');\nimport {\n  IExecutionReportSectionBuilder,\n  IExecutionReport,\n  ExecutionReport,\n  EXECUTION_REPORT_SECTION,\n  IExecutionReportSection\n} from './ExecutionReport';\nimport { find, chain, each } from 'underscore';\nimport { TableBuilder, ITableDataSource, GenericHtmlRenderer } from './TableBuilder';\nimport { Dom, $$ } from '../../utils/Dom';\nimport { Utils } from '../../utils/Utils';\nimport { StreamHighlightUtils } from '../../utils/StreamHighlightUtils';\nimport { ExecutionReportSimpleSection } from './ExecutionReportSimpleSection';\n\nexport type IRefinedQueriesFromTopClicks = { q: string; score: number };\n\nexport interface IExecutionReportITDSection extends IExecutionReportSection {\n  refinedQueries: IRefinedQueriesFromTopClicks[];\n}\n\nexport interface IExecutionReportMLTopClicksInput extends IExecutionReportSection {\n  largeQueryKeywords: string[];\n}\n\nexport class ExecutionReportITDSection implements IExecutionReportSectionBuilder {\n  public async build(executionReport: IExecutionReport): Promise<{ container: Dom; gridOptions: agGridModule.GridOptions }> {\n    const preprocessQuerySection = find(executionReport.children, child => child.name == EXECUTION_REPORT_SECTION.PREPROCESS_QUERY);\n    if (!preprocessQuerySection) {\n      return this.buildFallbackEmptyTable(executionReport);\n    }\n\n    const originalLongQuery = preprocessQuerySection.result.in.lq;\n    const topClicksSection = find(preprocessQuerySection.children, child => child.name == EXECUTION_REPORT_SECTION.TOP_CLICKS) as\n      | IExecutionReportITDSection\n      | undefined;\n\n    if (!topClicksSection || !originalLongQuery) {\n      return this.buildFallbackEmptyTable(executionReport);\n    }\n\n    const { container, agGridElement } = ExecutionReport.standardSectionHeader('Large Query Intelligent Term Detection (ITD)');\n    let gridOptions: agGridModule.GridOptions;\n\n    const dataSource = [\n      {\n        'Original large query': this.buildOriginalLongQueryCell(originalLongQuery, topClicksSection.refinedQueries),\n        'Keyword(s) extracted': this.buildRefinedQueryCell(executionReport, topClicksSection.refinedQueries, preprocessQuerySection)\n      }\n    ];\n\n    const tableBuilder = await new TableBuilder().build(dataSource, agGridElement, {\n      rowHeight: 300\n    });\n    gridOptions = tableBuilder.gridOptions;\n\n    return { container, gridOptions };\n  }\n\n  private doHighlights(originalLongQuery: string, refinedQueries: IRefinedQueriesFromTopClicks[]) {\n    const termsToHighlight = {};\n    each(refinedQueries, refined => {\n      termsToHighlight[refined.q] = [];\n    });\n    return StreamHighlightUtils.highlightStreamText(originalLongQuery, termsToHighlight, {});\n  }\n\n  private buildOriginalLongQueryCell(originalLongQuery: string, refinedQueries: IRefinedQueriesFromTopClicks[]): ITableDataSource {\n    return {\n      content: this.doHighlights(originalLongQuery, refinedQueries),\n      cellRenderer: GenericHtmlRenderer\n    };\n  }\n\n  private buildRefinedQueryCell(\n    executionReport: IExecutionReport,\n    refinedQueries: IRefinedQueriesFromTopClicks[],\n    preprocessSection: IExecutionReportSection\n  ): ITableDataSource {\n    if (Utils.isNonEmptyArray(refinedQueries)) {\n      return this.buildRefinedQueryByMLCell(refinedQueries);\n    }\n\n    const fallbackIndexPartialMatch = find(preprocessSection.children, child => child.name == EXECUTION_REPORT_SECTION.PARTIAL_MATCH);\n    const isUsingPartialMatch = fallbackIndexPartialMatch ? fallbackIndexPartialMatch.result.out.match(/^PartialMatch/) : false;\n    if (isUsingPartialMatch) {\n      return this.buildRefinedQueryByPartialMatchCell(fallbackIndexPartialMatch);\n    }\n\n    return this.buildRefinedQueryNoExtraction();\n  }\n\n  private buildRefinedQueryByMLCell(refinedQueries: IRefinedQueriesFromTopClicks[]): ITableDataSource {\n    const topLevelContainer = $$('div', undefined, $$('h2', undefined, 'Extraction and scoring performed using Coveo Machine Learning:'));\n\n    const keywordsList = $$('ul');\n    topLevelContainer.append(keywordsList.el);\n\n    chain(refinedQueries)\n      .map(refinedQuery => {\n        const content = this.doHighlights(`Keyword: ${refinedQuery.q} ==> Score: ${refinedQuery.score}`, [refinedQuery]);\n        const container = $$('li', null, content);\n        return container;\n      })\n      .each(refinedQueryContainer => {\n        keywordsList.append(refinedQueryContainer.el);\n      });\n\n    return {\n      content: topLevelContainer,\n      cellRenderer: GenericHtmlRenderer\n    };\n  }\n\n  private buildRefinedQueryByPartialMatchCell(partialMatch: IExecutionReportSection) {\n    const topLevelContainer = $$('div');\n    topLevelContainer.append($$('h2', undefined, 'Coveo Machine learning was unable to suggest any refined keywords').el);\n    topLevelContainer.append($$('h4', undefined, 'Fallback on Coveo Index partial match feature').el);\n    const content = $$('code', undefined, partialMatch.result.out);\n    topLevelContainer.append(content.el);\n    return {\n      content: topLevelContainer,\n      cellRenderer: GenericHtmlRenderer\n    };\n  }\n\n  private buildRefinedQueryNoExtraction(): ITableDataSource {\n    const topLevelContainer = $$('div');\n    topLevelContainer.append($$('h2', undefined, 'No keywords were extracted').el);\n    topLevelContainer.append(\n      $$('h4', undefined, 'The query is probably too small, or Coveo is lacking usage analytics data to return any meaningful suggestions.')\n        .el\n    );\n    return {\n      content: topLevelContainer,\n      cellRenderer: GenericHtmlRenderer\n    };\n  }\n\n  private buildFallbackEmptyTable(executionReport: IExecutionReport) {\n    return new ExecutionReportSimpleSection(\n      EXECUTION_REPORT_SECTION.NONE,\n      EXECUTION_REPORT_SECTION.NONE,\n      'Large Query Intelligent Term Detection (ITD)'\n    ).build(executionReport);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/ExecutionReportITDSection.ts","import { TableBuilder, ITableDataSource } from './TableBuilder';\nimport { map, each, where, reject, filter } from 'underscore';\nimport agGridModule = require('ag-grid/main');\nimport { GenericValueOutput } from './GenericValueOutput';\nimport { IComponentBindings } from '../Base/ComponentBindings';\nimport { $$, Dom, Utils, PopupUtils } from '../../UtilsModules';\nimport { IFieldDescription } from '../../rest/FieldDescription';\nimport { QueryBuilder } from '../Base/QueryBuilder';\nimport { IIndexFieldValue } from '../../rest/FieldValue';\nimport { PopupHorizontalAlignment, PopupVerticalAlignment } from '../../utils/PopupUtils';\nimport { IRelevanceInspectorTab } from './RelevanceInspector';\n\nexport class AvailableFieldsTable implements IRelevanceInspectorTab {\n  public gridOptions: agGridModule.GridOptions;\n\n  public constructor(public bindings: IComponentBindings) {}\n\n  public async build() {\n    const container = $$('div');\n\n    const agGridElement = $$('div', {\n      className: 'ag-theme-fresh'\n    });\n    container.append(agGridElement.el);\n\n    const allFieldsDescription = this.bindings.queryController ? await this.bindings.queryController.getEndpoint().listFields() : null;\n\n    if (allFieldsDescription) {\n      const dataSource: Record<string, ITableDataSource>[] = map(allFieldsDescription, description => {\n        return {\n          Name: new GenericValueOutput().output(description.name),\n          Description: { ...new GenericValueOutput().output(description.description), width: 150 },\n          'Default Value': new GenericValueOutput().output(description.defaultValue),\n          'Field Type': new GenericValueOutput().output(description.fieldType),\n          'Field Source Type': new GenericValueOutput().output(description.fieldSourceType),\n          'Include In Query': new GenericValueOutput().output(description.includeInQuery),\n          'Include In Results': new GenericValueOutput().output(description.includeInResults),\n          'Group By Field': new GenericValueOutput().output(description.groupByField),\n          'Split Group By Field': new GenericValueOutput().output(description.splitGroupByField),\n          'Sort By Field': new GenericValueOutput().output(description.sortByField),\n          'Sample Of Available Values': {\n            content: {\n              content: {\n                description,\n                bindings: this.bindings,\n                container\n              }\n            },\n            width: 200,\n            suppressSorting: true,\n            suppressFilter: true,\n            cellRenderer: AvailableFieldsSampleValue\n          }\n        };\n      });\n\n      const { gridOptions } = await new TableBuilder().build(dataSource, agGridElement, {\n        enableFilter: true,\n        rowModelType: 'infinite',\n        pagination: true,\n        paginationPageSize: 25,\n        rowHeight: 100,\n        enableServerSideFilter: true,\n        enableServerSideSorting: true,\n        datasource: new AvailableFieldsDatasource(dataSource)\n      });\n\n      this.gridOptions = gridOptions;\n    }\n\n    return container;\n  }\n}\n\nexport class AvailableFieldsSampleValue implements agGridModule.ICellRendererComp {\n  private description: IFieldDescription | undefined;\n  private bindings: IComponentBindings | undefined;\n  private container: Dom | undefined;\n\n  public init(params: any) {\n    if (params.value && params.value.content) {\n      this.description = params.value.content.description;\n      this.bindings = params.value.content.bindings;\n      this.container = params.value.content.container;\n    }\n  }\n\n  public getGui() {\n    const btn = $$(\n      'button',\n      {\n        className: 'coveo-button coveo-available-fields-table-button',\n        type: 'button'\n      },\n      'Hover For Sample Values'\n    );\n\n    let popperElement: Dom | undefined;\n    let userHoveringButtonWithHisMouse = false;\n\n    btn.on('mouseover', async () => {\n      userHoveringButtonWithHisMouse = true;\n      if (this.description && this.container && userHoveringButtonWithHisMouse) {\n        const values = await this.getFieldsValues(this.description);\n        if (userHoveringButtonWithHisMouse) {\n          popperElement = this.renderFieldValues(values);\n          this.container.append(popperElement.el);\n          PopupUtils.positionPopup(popperElement.el, btn.el, document.body, {\n            horizontal: PopupHorizontalAlignment.LEFT,\n            vertical: PopupVerticalAlignment.MIDDLE\n          });\n        }\n        userHoveringButtonWithHisMouse = false;\n      }\n    });\n\n    btn.on('mouseout', () => {\n      if (popperElement) {\n        popperElement.remove();\n      }\n      userHoveringButtonWithHisMouse = false;\n    });\n\n    return btn.el;\n  }\n\n  private async getFieldsValues(fieldDesciption: IFieldDescription) {\n    if (!this.bindings || !this.description || !this.bindings.queryController || !this.container) {\n      return [];\n    }\n\n    if (fieldDesciption.groupByField) {\n      return await this.bindings.queryController.getEndpoint().listFieldValues({\n        field: this.description.name\n      });\n    } else {\n      const queryBuilder = new QueryBuilder();\n      queryBuilder.advancedExpression.add(fieldDesciption.name);\n      const queryResults = this.bindings ? await this.bindings.queryController.getEndpoint().search(queryBuilder.build()) : null;\n      if (queryResults) {\n        return map(queryResults.results, result => {\n          return { value: Utils.getFieldValue(result, fieldDesciption.name) } as IIndexFieldValue;\n        });\n      } else {\n        return [];\n      }\n    }\n  }\n\n  private renderFieldValues(fieldValues: IIndexFieldValue[]) {\n    const list = $$('ul', { className: 'coveo-relevance-inspector-available-fields-popup' });\n    list.el.style.background = 'white';\n    if (fieldValues.length == 0) {\n      list.append($$('li', undefined, 'No Values Available ...').el);\n    } else {\n      fieldValues.forEach(fieldValue => {\n        const listItem = $$(\n          'li',\n          {\n            className: 'coveo-relevance-inspector-available-fields-popup-value'\n          },\n          new GenericValueOutput().output(fieldValue.value).content\n        );\n\n        list.append(listItem.el);\n      });\n    }\n\n    return list;\n  }\n\n  public refresh() {\n    return true;\n  }\n}\n\ninterface IFilterModel {\n  type: 'equals' | 'notEqual' | 'startsWith' | 'endsWith' | 'contains' | 'notContains';\n  filter: string;\n}\n\ninterface ISortModel {\n  colId: string;\n  sort: 'asc' | 'desc';\n}\n\nexport class AvailableFieldsDatasource implements agGridModule.IDatasource {\n  private rowsData: any[] = [];\n  constructor(public dataSource: Record<string, ITableDataSource>[]) {\n    this.rowsData = map(this.dataSource, source => {\n      const merged: any = {};\n\n      const extractContent = (value: ITableDataSource & agGridModule.ColGroupDef, key: string) => {\n        if (value.content != null) {\n          merged[key] = value.content;\n        } else if (value.children) {\n          each(value.children, (child: any) => {\n            each(child, extractContent);\n          });\n        }\n      };\n\n      each(source, extractContent as any);\n      return merged;\n    });\n  }\n\n  public getRows(params: agGridModule.IGetRowsParams) {\n    const filtered = this.filter(this.rowsData, params.filterModel);\n    const filteredAndSorted = this.sort(filtered, params.sortModel);\n\n    params.successCallback(filteredAndSorted.slice(params.startRow, params.endRow), filteredAndSorted.length);\n  }\n\n  private filter(rows: any[], filterModel: Record<string, IFilterModel>) {\n    each(filterModel, (value, key) => {\n      switch (value.type) {\n        case 'equals':\n          rows = where(rows, { [key]: value.filter });\n          break;\n\n        case 'notEqual':\n          rows = reject(rows, possibleReturn => {\n            return possibleReturn[key] == value.filter;\n          });\n          break;\n\n        case 'startsWith':\n          rows = filter(rows, possibleReturn => {\n            return possibleReturn[key].toLowerCase().indexOf(value.filter) == 0;\n          });\n          break;\n\n        case 'endsWith':\n          rows = filter(rows, possibleReturn => {\n            return possibleReturn[key].toLowerCase().indexOf(value.filter) == possibleReturn[key].length - value.filter.length;\n          });\n          break;\n\n        case 'contains':\n          rows = filter(rows, possibleReturn => {\n            return possibleReturn[key].toLowerCase().indexOf(value.filter) != -1;\n          });\n          break;\n\n        case 'notContains':\n          rows = filter(rows, possibleReturn => {\n            return possibleReturn[key].toLowerCase().indexOf(value.filter) == -1;\n          });\n          break;\n      }\n    });\n\n    return rows;\n  }\n\n  private sort(rows: any[], sortModels: ISortModel[]) {\n    if (sortModels && sortModels[0]) {\n      const sortModel = sortModels[0];\n      return rows.sort((first, second) => {\n        const firstValue = first[sortModel.colId];\n        const secondValue = second[sortModel.colId];\n\n        const ascendingOrDescendingMultiplier = sortModel.sort == 'asc' ? 1 : -1;\n\n        if (Utils.isNullOrEmptyString(firstValue) && Utils.isNullOrEmptyString(secondValue)) {\n          return 0;\n        }\n\n        if (Utils.isNullOrEmptyString(firstValue)) {\n          return -1 * ascendingOrDescendingMultiplier;\n        }\n\n        if (Utils.isNullOrEmptyString(secondValue)) {\n          return 1 * ascendingOrDescendingMultiplier;\n        }\n\n        if (isNaN(firstValue) || isNaN(secondValue)) {\n          return firstValue.localeCompare(secondValue) * ascendingOrDescendingMultiplier;\n        } else {\n          return (Number(firstValue) - Number(secondValue)) * ascendingOrDescendingMultiplier;\n        }\n      });\n    }\n    return rows;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/AvailableFieldsTable.ts","import { IQueryResult } from '../../rest/QueryResult';\nimport { parseRankingInfo, IRankingInfo, buildListOfTermsElement } from './RankingInfoParser';\nimport { $$, Dom } from '../../utils/Dom';\nimport { each } from 'underscore';\nimport { Utils } from '../../utils/Utils';\n\nexport class InlineRankingInfo {\n  private rankingInfo: IRankingInfo;\n  constructor(public result: IQueryResult) {\n    this.rankingInfo = parseRankingInfo(result.rankingInfo);\n  }\n\n  public build(): Dom {\n    const container = $$('div', {\n      className: 'coveo-relevance-inspector-inline-ranking'\n    });\n\n    each(this.rankingInfo.documentWeights, (value: any, key: string) => {\n      const section = $$('div', { className: 'coveo-relevance-inspector-inline-ranking-section' }, `${key}: ${value}`);\n      container.append(section.el);\n    });\n\n    const total = $$(\n      'div',\n      { className: 'coveo-relevance-inspector-highlight coveo-relevance-inspector-inline-ranking-section' },\n      `Total: ${this.rankingInfo.totalWeight}`\n    );\n    container.append(total.el);\n\n    if (this.rankingInfo.termsWeight) {\n      this.buildTogglableTermsSection(container);\n    }\n\n    if (Utils.isNonEmptyArray(this.rankingInfo.qreWeights)) {\n      this.buildTogglableQRESection(container);\n    }\n\n    return container;\n  }\n\n  private buildTogglableTermsSection(container: Dom) {\n    const termsButton = $$(\n      'button',\n      { className: 'coveo-button coveo-relevance-inspector-inline-ranking-button', type: 'button' },\n      'Toggle Terms Relevancy Breakdown'\n    );\n    container.append(termsButton.el);\n\n    const termsSection = $$('div', { className: 'coveo-relevance-inspector-inline-ranking-terms' });\n\n    container.append(termsSection.el);\n    each(this.rankingInfo.termsWeight || {}, (value, key) => {\n      const builtKey = `Keyword: ${key}`;\n      termsSection.append($$('h2', undefined, builtKey).el);\n      termsSection.append(buildListOfTermsElement(value.Weights).el);\n    });\n\n    termsButton.on('click', () => termsSection.toggleClass('coveo-active'));\n  }\n\n  private buildTogglableQRESection(container: Dom) {\n    const qreButton = $$(\n      'button',\n      { className: 'coveo-button coveo-relevance-inspector-inline-ranking-button', type: 'button' },\n      'Toggle QRE Breakdown'\n    );\n    container.append(qreButton.el);\n    const qreSection = $$('ul', { className: 'coveo-relevance-inspector-inline-ranking-terms' });\n\n    container.append(qreSection.el);\n    each(this.rankingInfo.qreWeights, value => {\n      qreSection.append($$('dd', { className: 'coveo-relevance-inspector-inline-ranking-qre-expression' }, `${value.expression}`).el);\n      qreSection.append($$('dt', undefined, `Score: ${value.score}`).el);\n    });\n\n    qreButton.on('click', () => qreSection.toggleClass('coveo-active'));\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/RelevanceInspector/InlineRankingInfo.ts"],"sourceRoot":""}