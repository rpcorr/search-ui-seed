{"version":3,"sources":["SmartSnippet.min__d6b9bcc2bfcb024de483.js","./src/utils/AccessibleModal.ts","./src/ui/SmartSnippet/SmartSnippet.ts","./src/ui/FocusTrap/FocusTrap.ts","./src/misc/AttachShadowPolyfill.ts","./src/ui/SmartSnippet/SmartSnippetCommon.ts","./src/ui/ResultLink/ResultLink.ts","./src/ui/SmartSnippet/UserFeedbackBanner.ts","./src/ui/SmartSnippet/HeightLimiter.ts","./src/ui/SmartSnippet/ExplanationModal.ts","./src/ui/FormWidgets/RadioButton.ts"],"names":["webpackJsonpCoveo__temporary","177","module","exports","__webpack_require__","__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","defineProperty","value","className","ownerElement","modalboxModule","options","ModalBox","sizeMod","get","focusTrap","enumerable","configurable","activeModal","modalBox","content","wrapper","element","querySelector","openResult","parameters","isOpen","openModalAndTrap","validation","origin","title","DomUtils","getQuickviewHeader","result","bindings","el","makeAccessible","open","initiallyFocusedElement","document","activeElement","onModalClose","body","overlayClose","FocusTrap","close","setAttribute","headerElement","makeCloseButtonAccessible","updateFocus","closeButton","l","tabIndex","$$","on","KeyboardUtils","keypressAction","KEYBOARD","ENTER","click","focusOnOpen","focus","disable","contains","AccessibleModal","295","__extends","extendStatics","setPrototypeOf","__proto__","Array","d","b","__","constructor","create","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","done","then","apply","__generator","verb","v","op","f","TypeError","_","y","label","ops","pop","trys","push","g","sent","throw","return","Symbol","iterator","reasons","analytics","AnalyticsSmartSnippetFeedbackReason","DoesNotAnswer","localeKey","PartiallyAnswers","WasNotAQuestion","Other","hasDetails","BASE_CLASSNAME","CONTENT_CLASSNAME","SOURCE_CLASSNAME","SmartSnippetClassNames","QUESTION_CLASSNAME","ANSWER_CONTAINER_CLASSNAME","HAS_ANSWER_CLASSNAME","SHADOW_CLASSNAME","SOURCE_TITLE_CLASSNAME","SOURCE_URL_CLASSNAME","SmartSnippet","ID","lastRenderedResult","ComponentOptions","initComponentOptions","bind","onRootElement","QueryEvents","deferredQuerySuccess","data","handleQuerySuccess","_this","shadowLoading","styles","children","filter","HTMLScriptElement","type","toLowerCase","map","innerHTML","join","set","hasAnswer","toggleClass","createDom","appendChild","buildAnswerContainer","feedbackBanner","UserFeedbackBanner","isUseful","sendLikeSmartSnippetAnalytics","sendDislikeSmartSnippetAnalytics","openExplanationModal","build","explanationModal","ExplanationModal","reason","id","replace","onSelect","sendExplanationAnalytics","details","onClosed","sendCloseFeedbackModalAnalytics","searchInterface","modalContainer","modalBoxModule","buildQuestion","buildShadow","buildHeightLimiter","buildSourceContainer","questionContainer","shadowContainer","snippetContainer","attachShadow","mode","onSizeChanged","handleAnswerSizeChanged","useIFrame","shadow","style","buildStyle","heightLimiter","HeightLimiter","childNodes","item","maximumSnippetHeight","isExpanded","sendExpandSmartSnippetAnalytics","sendCollapseSmartSnippetAnalytics","toggleButton","sourceContainer","Utils","isNullOrUndefined","getDefaultSnippetStyle","styleTag","createElement","onContentHeightChanged","getCorrespondingResult","questionAnswer","lastResults","queryController","getLastResults","results","childResults","flatten","lastResult","attachments","find","compact","concat","raw","documentId","contentIdKey","contentIdValue","_a","containsQuestionAnswer","searchUid","render","question","answerSnippet","ensureDom","reset","innerText","renderSnippet","renderSource","container","empty","append","renderSourceUrl","renderSourceTitle","link","buildLink","text","getFieldValue","titleField","href","addClass","ResultLink","hrefTemplate","logAnalytics","sendClickSourceAnalytics","alwaysOpenInNewWindow","getBindings","resultElement","sendOpenFeedbackModalAnalytics","explainWhy","usageAnalytics","logCustomEvent","analyticsActionCauseList","likeSmartSnippet","searchQueryUid","dislikeSmartSnippet","expandSmartSnippet","collapseSmartSnippet","openSmartSnippetFeedbackModal","closeSmartSnippetFeedbackModal","sendSmartSnippetReason","logClickEvent","openSmartSnippetSource","documentTitle","author","documentURL","doExport","exportGlobally","buildNumberOption","defaultValue","min","buildFieldOption","buildStringOption","buildBooleanOption","Component","Initialization","registerAutoCreateComponent","467","focusableSelector","hiddenElements","enable","chain","Dom","nodeListToArray","querySelectorAll","isVisible","sortBy","removeEventListener","focusInEvent","focusOutEvent","showHiddenElements","enabled","addEventListener","onFocusIn","onFocusOut","hideAllExcept","removeAttribute","hideElement","getAttribute","hideSiblings","allowedElement","parent","parentElement","without","forEach","elementToHide","getFocusableSibling","previous","elements","focusableElements","currentIndex","indexOf","focusSibling","sibling","focusFirstElement","elementIsBefore","oldElement","newElement","compareDocumentPosition","Node","DOCUMENT_POSITION_PRECEDING","onLosingFocus","Defer","defer","focusIsAllowed","elementIsInPage","relatedTarget","target","519","elementOptions","autoUpdateContainer","contentBody","onLoad","shadowRootContainer","scrolling","contentDocument","margin","autoUpdateHeight","elementToResize","onUpdate","lastWidth","clientWidth","lastHeight","clientHeight","MutationObserver","width","height","observe","attributes","characterData","childList","subtree","520","contentClassName","532","558","585","69","os","debounce","saveLastQuery","undefined","escapedClickUri","logDocumentOpen","flush","globalOptions","originalOptionsObject","initialOptions","resultLinkOptions","componentOptionsModel","ComponentOptionsModel","attributesEnum","resultLink","extend","resolveResult","openQuickview","DeviceUtils","isMobileDevice","hasAttribute","Assert","exists","quickviewShouldBeOpened","once","window","setTimeout","clearTimeout","renderUri","bindEventToOpen","test","getDisplayedTitle","titleAsText","getDisplayedTitleAsText","openLink","location","getResultUri","openLinkInNewWindow","openLinkInOutlook","hasOutlookField","openLinkAsConfigured","toExecuteOnOpen","bindOnClickIfNotUndefined","bindOpenQuickviewIfNotUndefined","setHrefIfNotAlready","openLinkThatIsNotAnAnchor","titleTemplate","newTitle","StringUtils","buildStringTemplateFromResult","StreamHighlightUtils","highlightStreamText","termsToHighlight","phrasesToHighlight","HighlightUtils","highlightString","titleHighlights","setHtml","escape","clickUri","onClick","AccessibleButton","withElement","withLabel","withSelectAction","trigger","ResultListEvents","preventDefault","elementIsAnAnchor","openInOutlook","isNonEmptyString","documentOpen","root","filterProtocol","uri","isAbsolute","isRelative","field","setField","tagName","OSUtils","OS_NAME","MACOSX","WINDOWS","isUriThatMustBeOpenedInQuickview","QueryUtils","hasHTMLVersion","buildCustomOption","701","702","UsefulState","ROOT_CLASSNAME","LABEL_CLASSNAME","BUTTON_ACTIVE_CLASSNAME","ICON_CLASSNAME","THANK_YOU_BANNER_CLASSNAME","UserFeedbackBannerClassNames","CONTAINER_CLASSNAME","BUTTONS_CONTAINER_CLASSNAME","YES_BUTTON_CLASSNAME","NO_BUTTON_CLASSNAME","THANK_YOU_BANNER_ACTIVE_CLASSNAME","EXPLAIN_WHY_CLASSNAME","EXPLAIN_WHY_ACTIVE_CLASSNAME","sendUsefulnessAnalytics","onExplainWhyPressed","Unknown","labelId","uniqueId","ariaLive","buildContainer","buildThankYouBanner","yesButton","removeClass","noButton","thankYouBanner","ariaLabelledby","buildLabel","buildButtons","buildButton","action","requestExplaination","buttonsContainer","showThankYouBanner","icon","SVGIcons","icons","checkYes","ariaPressed","ariaDescribedby","clearSmall","button","Yes","No","703","BUTTON_CLASSNAME","HeightLimiterClassNames","CONTAINER_ACTIVE_CLASSNAME","CONTAINER_EXPANDED_CLASSNAME","BUTTON_LABEL_CLASSNAME","BUTTON_ICON_CLASSNAME","containerElement","contentElement","heightLimit","onToggle","updateActiveAppearance","ariaLabel","ariaHidden","buttonLabel","buttonIcon","toggle","updateButton","shouldBeActive","contentHeight","updateExpandedAppearance","arrowUp","arrowDown","704","EXPLANATION_SECTION_CLASSNAME","REASONS_CLASSNAME","REASONS_LABEL_CLASSNAME","DETAILS_SECTION_CLASSNAME","DETAILS_TEXTAREA_CLASSNAME","DETAILS_LABEL_CLASSNAME","BUTTONS_SECTION_CLASSNAME","SEND_BUTTON_CLASSNAME","CANCEL_BUTTON_CLASSNAME","DETAILS_ID","ExplanationModalClassNames","shouldCallCloseEvent","modal","sendButton","selectedReason","detailsTextArea","buildContent","buildExplanationSection","buildButtonsSection","detailsSection","buildDetailsSection","buildReasons","buildSendButton","buildCancelButton","reasonsContainer","buildReasonsLabel","buildReasonRadioButton","select","radioButton","getElement","for","disabled","RadioButton","isSelected","705","97","onChange","name","currentlySelected","getRadio","checked","triggerChange","getValue","getLabel","radioOption","radioInput","labelInput"],"mappings":"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","file":"SmartSnippet.min__d6b9bcc2bfcb024de483.js","sourcesContent":["webpackJsonpCoveo__temporary([19,55,65],{\n\n/***/ 177:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ExternalModulesShim_1 = __webpack_require__(26);\nvar FocusTrap_1 = __webpack_require__(467);\nvar Strings_1 = __webpack_require__(6);\nvar Dom_1 = __webpack_require__(1);\nvar KeyboardUtils_1 = __webpack_require__(25);\nvar Core_1 = __webpack_require__(20);\nvar AccessibleModal = /** @class */ (function () {\n    function AccessibleModal(className, ownerElement, modalboxModule, options) {\n        if (modalboxModule === void 0) { modalboxModule = ExternalModulesShim_1.ModalBox; }\n        if (options === void 0) { options = {}; }\n        this.className = className;\n        this.ownerElement = ownerElement;\n        this.modalboxModule = modalboxModule;\n        this.options = __assign({\n            sizeMod: 'big'\n        }, options);\n    }\n    Object.defineProperty(AccessibleModal.prototype, \"isOpen\", {\n        get: function () {\n            return !!this.focusTrap;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AccessibleModal.prototype, \"element\", {\n        get: function () {\n            return this.activeModal && this.activeModal.modalBox;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AccessibleModal.prototype, \"content\", {\n        get: function () {\n            return this.activeModal && this.activeModal.content;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AccessibleModal.prototype, \"wrapper\", {\n        get: function () {\n            return this.activeModal && this.activeModal.wrapper;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AccessibleModal.prototype, \"headerElement\", {\n        get: function () {\n            return this.element && this.element.querySelector('.coveo-modal-header h1');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AccessibleModal.prototype.openResult = function (parameters) {\n        if (this.isOpen) {\n            return;\n        }\n        this.openModalAndTrap({\n            content: parameters.content,\n            validation: parameters.validation,\n            origin: parameters.origin,\n            title: Core_1.DomUtils.getQuickviewHeader(parameters.result, parameters.options, parameters.bindings).el\n        });\n        this.makeAccessible(parameters.options.title || parameters.result.title);\n    };\n    AccessibleModal.prototype.open = function (parameters) {\n        if (this.isOpen) {\n            return;\n        }\n        this.openModalAndTrap(parameters);\n        this.makeAccessible();\n    };\n    AccessibleModal.prototype.openModalAndTrap = function (parameters) {\n        var _this = this;\n        this.initiallyFocusedElement = parameters.origin || document.activeElement;\n        this.activeModal = this.modalboxModule.open(parameters.content, {\n            title: parameters.title,\n            className: this.className,\n            validation: function () {\n                _this.onModalClose();\n                return parameters.validation();\n            },\n            body: this.ownerElement,\n            sizeMod: this.options.sizeMod,\n            overlayClose: this.options.overlayClose\n        });\n        this.focusTrap = new FocusTrap_1.FocusTrap(this.element);\n    };\n    AccessibleModal.prototype.close = function () {\n        if (!this.isOpen) {\n            return;\n        }\n        this.activeModal.close();\n        this.activeModal = null;\n    };\n    AccessibleModal.prototype.makeAccessible = function (title) {\n        this.element.setAttribute('aria-modal', 'true');\n        if (title) {\n            this.headerElement.setAttribute('aria-label', title);\n        }\n        this.makeCloseButtonAccessible();\n        this.updateFocus();\n    };\n    Object.defineProperty(AccessibleModal.prototype, \"closeButton\", {\n        get: function () {\n            return this.element.querySelector('.coveo-small-close');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AccessibleModal.prototype.makeCloseButtonAccessible = function () {\n        var closeButton = this.closeButton;\n        closeButton.setAttribute('aria-label', Strings_1.l('Close'));\n        closeButton.setAttribute('role', 'button');\n        closeButton.tabIndex = 0;\n        Dom_1.$$(closeButton).on('keyup', KeyboardUtils_1.KeyboardUtils.keypressAction(KeyboardUtils_1.KEYBOARD.ENTER, function () { return closeButton.click(); }));\n    };\n    AccessibleModal.prototype.updateFocus = function () {\n        var focusOnElement = (this.options.focusOnOpen && this.options.focusOnOpen()) || this.closeButton;\n        focusOnElement.focus();\n    };\n    AccessibleModal.prototype.onModalClose = function () {\n        this.focusTrap.disable();\n        this.focusTrap = null;\n        if (this.initiallyFocusedElement && document.body.contains(this.initiallyFocusedElement)) {\n            this.initiallyFocusedElement.focus();\n        }\n    };\n    return AccessibleModal;\n}());\nexports.AccessibleModal = AccessibleModal;\n\n\n/***/ }),\n\n/***/ 295:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ExternalModulesShim_1 = __webpack_require__(26);\nvar GlobalExports_1 = __webpack_require__(3);\nvar Component_1 = __webpack_require__(7);\nvar Core_1 = __webpack_require__(20);\n__webpack_require__(701);\nvar underscore_1 = __webpack_require__(0);\nvar UserFeedbackBanner_1 = __webpack_require__(702);\nvar AnalyticsActionListMeta_1 = __webpack_require__(10);\nvar HeightLimiter_1 = __webpack_require__(703);\nvar ExplanationModal_1 = __webpack_require__(704);\nvar Strings_1 = __webpack_require__(6);\nvar AttachShadowPolyfill_1 = __webpack_require__(519);\nvar Utils_1 = __webpack_require__(4);\nvar ComponentOptions_1 = __webpack_require__(8);\nvar SmartSnippetCommon_1 = __webpack_require__(520);\nvar ResultLink_1 = __webpack_require__(69);\nvar reasons = [\n    {\n        analytics: AnalyticsActionListMeta_1.AnalyticsSmartSnippetFeedbackReason.DoesNotAnswer,\n        localeKey: 'UsefulnessFeedbackDoesNotAnswer'\n    },\n    {\n        analytics: AnalyticsActionListMeta_1.AnalyticsSmartSnippetFeedbackReason.PartiallyAnswers,\n        localeKey: 'UsefulnessFeedbackPartiallyAnswers'\n    },\n    {\n        analytics: AnalyticsActionListMeta_1.AnalyticsSmartSnippetFeedbackReason.WasNotAQuestion,\n        localeKey: 'UsefulnessFeedbackWasNotAQuestion'\n    },\n    {\n        analytics: AnalyticsActionListMeta_1.AnalyticsSmartSnippetFeedbackReason.Other,\n        localeKey: 'Other',\n        hasDetails: true\n    }\n];\nvar BASE_CLASSNAME = 'coveo-smart-snippet';\nvar QUESTION_CLASSNAME = BASE_CLASSNAME + \"-question\";\nvar ANSWER_CONTAINER_CLASSNAME = BASE_CLASSNAME + \"-answer\";\nvar HAS_ANSWER_CLASSNAME = BASE_CLASSNAME + \"-has-answer\";\nvar SHADOW_CLASSNAME = BASE_CLASSNAME + \"-content\";\nvar CONTENT_CLASSNAME = BASE_CLASSNAME + \"-content-wrapper\";\nvar SOURCE_CLASSNAME = BASE_CLASSNAME + \"-source\";\nvar SOURCE_TITLE_CLASSNAME = SOURCE_CLASSNAME + \"-title\";\nvar SOURCE_URL_CLASSNAME = SOURCE_CLASSNAME + \"-url\";\nexports.SmartSnippetClassNames = {\n    QUESTION_CLASSNAME: QUESTION_CLASSNAME,\n    ANSWER_CONTAINER_CLASSNAME: ANSWER_CONTAINER_CLASSNAME,\n    HAS_ANSWER_CLASSNAME: HAS_ANSWER_CLASSNAME,\n    SHADOW_CLASSNAME: SHADOW_CLASSNAME,\n    CONTENT_CLASSNAME: CONTENT_CLASSNAME,\n    SOURCE_CLASSNAME: SOURCE_CLASSNAME,\n    SOURCE_TITLE_CLASSNAME: SOURCE_TITLE_CLASSNAME,\n    SOURCE_URL_CLASSNAME: SOURCE_URL_CLASSNAME\n};\n/**\n * The SmartSnippet component displays the excerpt of a document that would be most likely to answer a particular query.\n *\n * This excerpt can be visually customized using inline styling.\n */\nvar SmartSnippet = /** @class */ (function (_super) {\n    __extends(SmartSnippet, _super);\n    function SmartSnippet(element, options, bindings, ModalBox) {\n        if (ModalBox === void 0) { ModalBox = ExternalModulesShim_1.ModalBox; }\n        var _this = _super.call(this, element, SmartSnippet.ID, bindings) || this;\n        _this.element = element;\n        _this.options = options;\n        _this.ModalBox = ModalBox;\n        _this.lastRenderedResult = null;\n        _this.options = ComponentOptions_1.ComponentOptions.initComponentOptions(element, SmartSnippet, options);\n        _this.bind.onRootElement(Core_1.QueryEvents.deferredQuerySuccess, function (data) { return _this.handleQuerySuccess(data); });\n        return _this;\n    }\n    Object.defineProperty(SmartSnippet.prototype, \"loading\", {\n        get: function () {\n            return this.shadowLoading;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SmartSnippet.prototype, \"style\", {\n        get: function () {\n            var styles = Core_1.$$(this.element)\n                .children()\n                .filter(function (element) { return element instanceof HTMLScriptElement && element.type.toLowerCase() === 'text/css'; })\n                .map(function (element) { return element.innerHTML; });\n            return styles.length ? styles.join('\\n') : null;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SmartSnippet.prototype, \"hasAnswer\", {\n        set: function (hasAnswer) {\n            Core_1.$$(this.element).toggleClass(HAS_ANSWER_CLASSNAME, hasAnswer);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SmartSnippet.prototype.createDom = function () {\n        var _this = this;\n        this.element.appendChild(this.buildAnswerContainer());\n        this.feedbackBanner = new UserFeedbackBanner_1.UserFeedbackBanner(function (isUseful) { return (isUseful ? _this.sendLikeSmartSnippetAnalytics() : _this.sendDislikeSmartSnippetAnalytics()); }, function () { return _this.openExplanationModal(); });\n        this.element.appendChild(this.feedbackBanner.build());\n        this.explanationModal = new ExplanationModal_1.ExplanationModal({\n            reasons: reasons.map(function (reason) {\n                return ({\n                    label: Strings_1.l(reason.localeKey),\n                    id: reason.analytics.replace(/_/g, '-'),\n                    onSelect: function () { return _this.sendExplanationAnalytics(reason.analytics, _this.explanationModal.details); },\n                    hasDetails: reason.hasDetails\n                });\n            }),\n            onClosed: function () { return _this.sendCloseFeedbackModalAnalytics(); },\n            ownerElement: this.searchInterface.options.modalContainer,\n            modalBoxModule: this.ModalBox\n        });\n    };\n    SmartSnippet.prototype.buildAnswerContainer = function () {\n        return Core_1.$$('div', {\n            className: ANSWER_CONTAINER_CLASSNAME\n        }, this.buildQuestion(), this.buildShadow(), this.buildHeightLimiter(), this.buildSourceContainer()).el;\n    };\n    SmartSnippet.prototype.buildQuestion = function () {\n        return (this.questionContainer = Core_1.$$('div', { className: QUESTION_CLASSNAME }).el);\n    };\n    SmartSnippet.prototype.buildShadow = function () {\n        var _this = this;\n        this.shadowContainer = Core_1.$$('div', { className: SHADOW_CLASSNAME }).el;\n        this.snippetContainer = Core_1.$$('section', { className: CONTENT_CLASSNAME }).el;\n        this.shadowLoading = AttachShadowPolyfill_1.attachShadow(this.shadowContainer, {\n            mode: 'open',\n            title: Strings_1.l('AnswerSnippet'),\n            onSizeChanged: function () { return _this.handleAnswerSizeChanged(); },\n            useIFrame: this.options.useIFrame\n        }).then(function (shadow) {\n            shadow.appendChild(_this.snippetContainer);\n            var style = _this.buildStyle();\n            shadow.appendChild(style);\n            return shadow;\n        });\n        return this.shadowContainer;\n    };\n    SmartSnippet.prototype.buildHeightLimiter = function () {\n        var _this = this;\n        return (this.heightLimiter = new HeightLimiter_1.HeightLimiter(this.shadowContainer, this.shadowContainer.childNodes.item(0), this.options.maximumSnippetHeight, function (isExpanded) { return (isExpanded ? _this.sendExpandSmartSnippetAnalytics() : _this.sendCollapseSmartSnippetAnalytics()); })).toggleButton;\n    };\n    SmartSnippet.prototype.buildSourceContainer = function () {\n        return (this.sourceContainer = Core_1.$$('div', { className: SOURCE_CLASSNAME }).el);\n    };\n    SmartSnippet.prototype.buildStyle = function () {\n        var style = Utils_1.Utils.isNullOrUndefined(this.style) ? SmartSnippetCommon_1.getDefaultSnippetStyle(CONTENT_CLASSNAME) : this.style;\n        var styleTag = document.createElement('style');\n        styleTag.innerHTML = style;\n        return styleTag;\n    };\n    SmartSnippet.prototype.handleAnswerSizeChanged = function () {\n        this.heightLimiter.onContentHeightChanged();\n    };\n    /**\n     * @warning This method only works for the demo. In practice, the source of the answer will not always be part of the results.\n     */\n    SmartSnippet.prototype.getCorrespondingResult = function (questionAnswer) {\n        var lastResults = this.queryController.getLastResults().results;\n        var childResults = underscore_1.flatten(underscore_1.map(lastResults, function (lastResult) { return lastResult.childResults; }));\n        var attachments = underscore_1.flatten(underscore_1.map(lastResults, function (lastResult) { return lastResult.attachments; }));\n        return underscore_1.find(underscore_1.compact(lastResults.concat(childResults, attachments)), function (result) { return result.raw[questionAnswer.documentId.contentIdKey] === questionAnswer.documentId.contentIdValue; });\n    };\n    SmartSnippet.prototype.handleQuerySuccess = function (data) {\n        return __awaiter(this, void 0, void 0, function () {\n            var questionAnswer;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        questionAnswer = data.results.questionAnswer;\n                        if (!this.containsQuestionAnswer(questionAnswer)) {\n                            this.hasAnswer = false;\n                            return [2 /*return*/];\n                        }\n                        this.hasAnswer = true;\n                        this.searchUid = data.results.searchUid;\n                        return [4 /*yield*/, this.render(questionAnswer)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    SmartSnippet.prototype.containsQuestionAnswer = function (questionAnswer) {\n        return questionAnswer && questionAnswer.question && questionAnswer.answerSnippet;\n    };\n    SmartSnippet.prototype.render = function (questionAnswer) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                this.ensureDom();\n                this.feedbackBanner.reset();\n                this.questionContainer.innerText = questionAnswer.question;\n                this.renderSnippet(questionAnswer.answerSnippet);\n                this.lastRenderedResult = this.getCorrespondingResult(questionAnswer);\n                if (this.lastRenderedResult) {\n                    this.renderSource();\n                }\n                else {\n                    this.lastRenderedResult = null;\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    SmartSnippet.prototype.renderSnippet = function (content) {\n        this.snippetContainer.innerHTML = content;\n    };\n    SmartSnippet.prototype.renderSource = function () {\n        var container = Core_1.$$(this.sourceContainer);\n        container.empty();\n        container.append(this.renderSourceUrl().el);\n        container.append(this.renderSourceTitle().el);\n    };\n    SmartSnippet.prototype.renderSourceTitle = function () {\n        var link = this.buildLink(SOURCE_TITLE_CLASSNAME);\n        link.text(Utils_1.Utils.getFieldValue(this.lastRenderedResult, this.options.titleField));\n        return link;\n    };\n    SmartSnippet.prototype.renderSourceUrl = function () {\n        var link = this.buildLink(SOURCE_URL_CLASSNAME);\n        link.text(link.el.href);\n        return link;\n    };\n    SmartSnippet.prototype.buildLink = function (className) {\n        var _this = this;\n        var element = Core_1.$$('a', { className: 'CoveoResultLink' });\n        element.addClass(className);\n        new ResultLink_1.ResultLink(element.el, {\n            hrefTemplate: this.options.hrefTemplate,\n            logAnalytics: function (href) { return _this.sendClickSourceAnalytics(element.el, href); },\n            alwaysOpenInNewWindow: this.options.alwaysOpenInNewWindow\n        }, __assign({}, this.getBindings(), { resultElement: this.element }), this.lastRenderedResult);\n        return element;\n    };\n    SmartSnippet.prototype.openExplanationModal = function () {\n        this.sendOpenFeedbackModalAnalytics();\n        this.explanationModal.open(this.feedbackBanner.explainWhy);\n    };\n    SmartSnippet.prototype.sendLikeSmartSnippetAnalytics = function () {\n        return this.usageAnalytics.logCustomEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.likeSmartSnippet, { searchQueryUid: this.searchUid }, this.element);\n    };\n    SmartSnippet.prototype.sendDislikeSmartSnippetAnalytics = function () {\n        return this.usageAnalytics.logCustomEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.dislikeSmartSnippet, { searchQueryUid: this.searchUid }, this.element);\n    };\n    SmartSnippet.prototype.sendExpandSmartSnippetAnalytics = function () {\n        return this.usageAnalytics.logCustomEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.expandSmartSnippet, { searchQueryUid: this.searchUid }, this.element);\n    };\n    SmartSnippet.prototype.sendCollapseSmartSnippetAnalytics = function () {\n        return this.usageAnalytics.logCustomEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.collapseSmartSnippet, { searchQueryUid: this.searchUid }, this.element);\n    };\n    SmartSnippet.prototype.sendOpenFeedbackModalAnalytics = function () {\n        return this.usageAnalytics.logCustomEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.openSmartSnippetFeedbackModal, { searchQueryUid: this.searchUid }, this.element);\n    };\n    SmartSnippet.prototype.sendCloseFeedbackModalAnalytics = function () {\n        return this.usageAnalytics.logCustomEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.closeSmartSnippetFeedbackModal, { searchQueryUid: this.searchUid }, this.element);\n    };\n    SmartSnippet.prototype.sendExplanationAnalytics = function (reason, details) {\n        return this.usageAnalytics.logCustomEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.sendSmartSnippetReason, {\n            searchQueryUid: this.searchUid,\n            reason: reason,\n            details: details\n        }, this.element);\n    };\n    SmartSnippet.prototype.sendClickSourceAnalytics = function (element, href) {\n        return this.usageAnalytics.logClickEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.openSmartSnippetSource, {\n            searchQueryUid: this.searchUid,\n            documentTitle: this.lastRenderedResult.title,\n            author: Utils_1.Utils.getFieldValue(this.lastRenderedResult, 'author'),\n            documentURL: href\n        }, this.lastRenderedResult, element);\n    };\n    SmartSnippet.ID = 'SmartSnippet';\n    SmartSnippet.doExport = function () {\n        GlobalExports_1.exportGlobally({\n            SmartSnippet: SmartSnippet\n        });\n    };\n    /**\n     * The options for the SmartSnippet\n     * @componentOptions\n     */\n    SmartSnippet.options = {\n        /**\n         * The maximum height an answer can have in pixels.\n         * Any part of an answer exceeding this height will be hidden by default and expendable via a \"show more\" button.\n         * Default value is `250`.\n         */\n        maximumSnippetHeight: ComponentOptions_1.ComponentOptions.buildNumberOption({ defaultValue: 250, min: 0 }),\n        /**\n         * The field to display for the title.\n         */\n        titleField: ComponentOptions_1.ComponentOptions.buildFieldOption({ defaultValue: '@title' }),\n        /**\n         * Specifies a template literal from which to generate the title and URI's `href` attribute value (see\n         * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\n         *\n         * This option overrides the [`field`]{@link SmartSnippet.options.uriField} option value.\n         *\n         * The template literal can reference any number of fields from the parent result. It can also reference global\n         * scope properties.\n         *\n         * **Examples:**\n         *\n         * - The following markup generates an `href` value such as `http://uri.com?id=itemTitle`:\n         *\n         * ```html\n         * <a class='CoveoSmartSnippet' data-href-template='${clickUri}?id=${raw.title}'></a>\n         * ```\n         *\n         * - The following markup generates an `href` value such as `localhost/fooBar`:\n         *\n         * ```html\n         * <a class='CoveoSmartSnippet' data-href-template='${window.location.hostname}/{Foo.Bar}'></a>\n         * ```\n         *\n         * Default value is `undefined`.\n         */\n        hrefTemplate: ComponentOptions_1.ComponentOptions.buildStringOption(),\n        /**\n         * Specifies whether the component should open its links in a new window instead of opening them in the current\n         * context.\n         *\n         * Default value is `false`.\n         */\n        alwaysOpenInNewWindow: ComponentOptions_1.ComponentOptions.buildBooleanOption({ defaultValue: false }),\n        /**\n         * Specify if the SmartSnippet should be displayed inside an iframe or not.\n         *\n         * Use this option in specific cases where your environment has limitations around iframe usage.\n         *\n         * **Examples:**\n         *\n         * ```html\n         * <div class='CoveoSmartSnippet' data-use-i-frame='true'></div>\n         * ```\n         *\n         * Default value is `true`.\n         */\n        useIFrame: ComponentOptions_1.ComponentOptions.buildBooleanOption({ defaultValue: true })\n    };\n    return SmartSnippet;\n}(Component_1.Component));\nexports.SmartSnippet = SmartSnippet;\nCore_1.Initialization.registerAutoCreateComponent(SmartSnippet);\n\n\n/***/ }),\n\n/***/ 467:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Defer_1 = __webpack_require__(31);\nvar underscore_1 = __webpack_require__(0);\nvar Dom_1 = __webpack_require__(1);\nvar FocusTrap = /** @class */ (function () {\n    function FocusTrap(container, options) {\n        if (options === void 0) { options = {\n            focusableSelector: '[tabindex], button'\n        }; }\n        this.container = container;\n        this.options = options;\n        this.hiddenElements = [];\n        this.enable();\n    }\n    Object.defineProperty(FocusTrap.prototype, \"focusableElements\", {\n        get: function () {\n            return underscore_1.chain(Dom_1.Dom.nodeListToArray(this.container.querySelectorAll(this.options.focusableSelector)))\n                .filter(function (element) { return Dom_1.$$(element).isVisible(); })\n                .sortBy(function (element) { return element.tabIndex; })\n                .value();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    FocusTrap.prototype.disable = function () {\n        document.removeEventListener('focusin', this.focusInEvent);\n        document.removeEventListener('focusout', this.focusOutEvent);\n        this.showHiddenElements();\n        this.enabled = false;\n    };\n    FocusTrap.prototype.enable = function () {\n        var _this = this;\n        document.addEventListener('focusin', (this.focusInEvent = function (e) { return _this.onFocusIn(e); }));\n        document.addEventListener('focusout', (this.focusOutEvent = function (e) { return _this.onFocusOut(e); }));\n        this.hideAllExcept(this.container);\n        this.enabled = true;\n    };\n    FocusTrap.prototype.showHiddenElements = function () {\n        while (this.hiddenElements.length) {\n            this.hiddenElements.pop().removeAttribute('aria-hidden');\n        }\n    };\n    FocusTrap.prototype.hideElement = function (element) {\n        if (element.getAttribute('aria-hidden')) {\n            return;\n        }\n        this.hiddenElements.push(element);\n        element.setAttribute('aria-hidden', \"\" + true);\n    };\n    FocusTrap.prototype.hideSiblings = function (allowedElement) {\n        var _this = this;\n        var parent = allowedElement.parentElement;\n        if (parent) {\n            underscore_1.without(Dom_1.$$(parent).children(), allowedElement).forEach(function (elementToHide) {\n                _this.hideElement(elementToHide);\n            });\n        }\n    };\n    FocusTrap.prototype.hideAllExcept = function (allowedElement) {\n        this.hideSiblings(allowedElement);\n        var parent = allowedElement.parentElement;\n        if (parent && parent !== document.body) {\n            this.hideAllExcept(parent);\n        }\n    };\n    FocusTrap.prototype.getFocusableSibling = function (element, previous) {\n        if (previous === void 0) { previous = false; }\n        var elements = this.focusableElements;\n        var currentIndex = elements.indexOf(element);\n        if (currentIndex === -1) {\n            return null;\n        }\n        return elements[(currentIndex + (previous ? -1 : 1) + elements.length) % elements.length];\n    };\n    FocusTrap.prototype.focusSibling = function (element, previous) {\n        if (previous === void 0) { previous = false; }\n        var sibling = this.getFocusableSibling(element, previous);\n        if (sibling) {\n            sibling.focus();\n        }\n    };\n    FocusTrap.prototype.focusFirstElement = function () {\n        var elements = this.focusableElements;\n        if (elements.length) {\n            elements[0].focus();\n        }\n    };\n    FocusTrap.prototype.elementIsBefore = function (oldElement, newElement) {\n        if (!newElement) {\n            return false;\n        }\n        return oldElement.compareDocumentPosition(newElement) === Node.DOCUMENT_POSITION_PRECEDING;\n    };\n    FocusTrap.prototype.onLosingFocus = function (oldElement, newElement) {\n        var _this = this;\n        Defer_1.Defer.defer(function () {\n            if (!_this.enabled) {\n                return;\n            }\n            _this.enabled = false;\n            if (oldElement && _this.focusIsAllowed(oldElement)) {\n                _this.focusSibling(oldElement, _this.elementIsBefore(oldElement, newElement));\n            }\n            else {\n                _this.focusFirstElement();\n            }\n            _this.enabled = true;\n        });\n    };\n    FocusTrap.prototype.focusIsAllowed = function (element) {\n        return this.container.contains(element);\n    };\n    FocusTrap.prototype.elementIsInPage = function (element) {\n        return element && element !== document.body.parentElement;\n    };\n    FocusTrap.prototype.onFocusIn = function (e) {\n        if (!this.enabled) {\n            return;\n        }\n        var oldElement = e.relatedTarget;\n        var handledByFocusOut = this.elementIsInPage(oldElement);\n        if (handledByFocusOut) {\n            return;\n        }\n        var newElement = e.target;\n        if (!this.elementIsInPage(newElement)) {\n            return;\n        }\n        if (!this.focusIsAllowed(newElement)) {\n            this.onLosingFocus(null, newElement);\n        }\n    };\n    FocusTrap.prototype.onFocusOut = function (e) {\n        if (!this.enabled) {\n            return;\n        }\n        var newElement = e.relatedTarget;\n        if (!this.elementIsInPage(newElement)) {\n            return;\n        }\n        if (!newElement || !this.focusIsAllowed(newElement)) {\n            this.onLosingFocus(e.target, newElement);\n        }\n    };\n    return FocusTrap;\n}());\nexports.FocusTrap = FocusTrap;\n\n\n/***/ }),\n\n/***/ 519:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Dom_1 = __webpack_require__(1);\n__webpack_require__(585);\nfunction attachShadow(element, options) {\n    return __awaiter(this, void 0, void 0, function () {\n        var elementOptions, autoUpdateContainer, contentBody, onLoad, shadowRootContainer;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    elementOptions = { className: 'coveo-shadow-iframe', scrolling: 'no', title: options.title };\n                    if (!options.useIFrame) return [3 /*break*/, 2];\n                    autoUpdateContainer = Dom_1.$$('iframe', elementOptions).el;\n                    onLoad = new Promise(function (resolve) { return autoUpdateContainer.addEventListener('load', function () { return resolve(); }); });\n                    element.appendChild(autoUpdateContainer);\n                    return [4 /*yield*/, onLoad];\n                case 1:\n                    _a.sent();\n                    contentBody = autoUpdateContainer.contentDocument.body;\n                    return [3 /*break*/, 3];\n                case 2:\n                    autoUpdateContainer = Dom_1.$$('div', elementOptions).el;\n                    contentBody = autoUpdateContainer;\n                    element.appendChild(autoUpdateContainer);\n                    _a.label = 3;\n                case 3:\n                    contentBody.style.margin = '0';\n                    shadowRootContainer = Dom_1.$$('div', { style: 'overflow: auto;' }).el;\n                    contentBody.appendChild(shadowRootContainer);\n                    autoUpdateHeight(autoUpdateContainer, shadowRootContainer, options.onSizeChanged);\n                    if (options.mode === 'open') {\n                        Object.defineProperty(element, 'shadowRoot', { get: function () { return shadowRootContainer; } });\n                    }\n                    return [2 /*return*/, shadowRootContainer];\n            }\n        });\n    });\n}\nexports.attachShadow = attachShadow;\nfunction autoUpdateHeight(elementToResize, content, onUpdate) {\n    var lastWidth = content.clientWidth;\n    var lastHeight = content.clientHeight;\n    var heightObserver = new MutationObserver(function () {\n        if (lastWidth === content.clientWidth && lastHeight === content.clientHeight) {\n            return;\n        }\n        lastWidth = content.clientWidth;\n        lastHeight = content.clientHeight;\n        elementToResize.style.width = content.clientWidth + \"px\";\n        elementToResize.style.height = content.clientHeight + \"px\";\n        if (onUpdate) {\n            onUpdate();\n        }\n    });\n    heightObserver.observe(content, {\n        attributes: true,\n        characterData: true,\n        childList: true,\n        subtree: true\n    });\n}\n\n\n/***/ }),\n\n/***/ 520:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getDefaultSnippetStyle = function (contentClassName) { return \"\\n  body {\\n    font-family: \\\"Lato\\\", \\\"Helvetica Neue\\\", Helvetica, Arial, sans-serif, sans-serif;\\n  }\\n\\n  .\" + contentClassName + \" > :first-child {\\n    margin-top: 0;\\n  }\\n\\n  .\" + contentClassName + \" > :last-child {\\n    margin-bottom: 0;\\n  }\\n\"; };\n\n\n/***/ }),\n\n/***/ 532:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 558:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 585:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 69:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Component_1 = __webpack_require__(7);\nvar ComponentOptions_1 = __webpack_require__(8);\nvar ComponentOptionsModel_1 = __webpack_require__(28);\nvar AnalyticsActionListMeta_1 = __webpack_require__(10);\nvar ResultListEvents_1 = __webpack_require__(29);\nvar HighlightUtils_1 = __webpack_require__(67);\nvar DeviceUtils_1 = __webpack_require__(24);\nvar OSUtils_1 = __webpack_require__(178);\nvar Initialization_1 = __webpack_require__(2);\nvar QueryUtils_1 = __webpack_require__(21);\nvar Assert_1 = __webpack_require__(5);\nvar Utils_1 = __webpack_require__(4);\nvar Defer_1 = __webpack_require__(31);\nvar Dom_1 = __webpack_require__(1);\nvar StreamHighlightUtils_1 = __webpack_require__(118);\nvar StringUtils_1 = __webpack_require__(22);\nvar underscore_1 = __webpack_require__(0);\nvar GlobalExports_1 = __webpack_require__(3);\n__webpack_require__(532);\nvar AccessibleButton_1 = __webpack_require__(15);\n/**\n * The `ResultLink` component automatically transform a search result title into a clickable link pointing to the\n * original item.\n *\n * This component is a result template component (see [Result Templates](https://docs.coveo.com/en/413/)).\n */\nvar ResultLink = /** @class */ (function (_super) {\n    __extends(ResultLink, _super);\n    /**\n     * Creates a new `ResultLink` component.\n     * @param element The HTMLElement on which to instantiate the component.\n     * @param options The options for the `ResultLink` component.\n     * @param bindings The bindings that the component requires to function normally. If not set, these will be\n     * automatically resolved (with a slower execution time).\n     * @param result The result to associate the component with.\n     * @param os\n     */\n    function ResultLink(element, options, bindings, result, os) {\n        var _this = _super.call(this, element, ResultLink.ID, bindings) || this;\n        _this.element = element;\n        _this.options = options;\n        _this.bindings = bindings;\n        _this.result = result;\n        _this.os = os;\n        _this.logAnalytics = underscore_1.debounce(function () {\n            _this.queryController.saveLastQuery();\n            var documentURL = Dom_1.$$(_this.element).getAttribute('href');\n            if (documentURL == undefined || documentURL == '') {\n                documentURL = _this.escapedClickUri;\n            }\n            if (_this.options.logAnalytics) {\n                _this.options.logAnalytics(documentURL);\n            }\n            else {\n                _this.logDocumentOpen(documentURL);\n            }\n            Defer_1.Defer.flush();\n        }, 1500, true);\n        var globalOptions = _this.searchInterface.options.originalOptionsObject[ResultLink.ID] || {};\n        var initialOptions = ComponentOptions_1.ComponentOptions.initComponentOptions(element, ResultLink, __assign({}, globalOptions, options));\n        var resultLinkOptions = _this.componentOptionsModel.get(ComponentOptionsModel_1.ComponentOptionsModel.attributesEnum.resultLink);\n        _this.options = underscore_1.extend({}, initialOptions, resultLinkOptions);\n        _this.result = result || _this.resolveResult();\n        if (_this.options.openQuickview == null) {\n            _this.options.openQuickview = result.raw['connectortype'] == 'ExchangeCrawler' && DeviceUtils_1.DeviceUtils.isMobileDevice();\n        }\n        if (!_this.element.hasAttribute('tabindex')) {\n            _this.element.setAttribute('tabindex', '0');\n        }\n        Assert_1.Assert.exists(_this.componentOptionsModel);\n        Assert_1.Assert.exists(_this.result);\n        if (!_this.quickviewShouldBeOpened()) {\n            // Bind on multiple \"click\" or \"mouse\" events.\n            // Create a function that will be executed only once, so as not to log multiple events\n            // Once a result link has been opened, and that we log at least one analytics event,\n            // it should not matter if the end user open the same link multiple times with different methods.\n            // It's still only one \"click\" event as far as UA is concerned.\n            // Also need to handle \"longpress\" on mobile (the contextual menu), which we assume to be 1 s long.\n            var executeOnlyOnce_1 = underscore_1.once(function () { return _this.logAnalytics(); });\n            Dom_1.$$(element).on(['contextmenu', 'click', 'mousedown', 'mouseup'], executeOnlyOnce_1);\n            var longPressTimer_1;\n            Dom_1.$$(element).on('touchstart', function () {\n                longPressTimer_1 = window.setTimeout(executeOnlyOnce_1, 1000);\n            });\n            Dom_1.$$(element).on('touchend', function () {\n                if (longPressTimer_1) {\n                    clearTimeout(longPressTimer_1);\n                }\n            });\n        }\n        _this.renderUri(element, result);\n        _this.bindEventToOpen();\n        return _this;\n    }\n    ResultLink.prototype.renderUri = function (element, result) {\n        if (/^\\s*$/.test(this.element.innerHTML)) {\n            var title = this.getDisplayedTitle();\n            this.element.innerHTML = title;\n            var titleAsText = this.getDisplayedTitleAsText();\n            if (!this.element.hasAttribute('aria-label')) {\n                this.element.setAttribute('aria-label', titleAsText);\n            }\n            if (!this.element.title) {\n                this.element.title = titleAsText;\n            }\n        }\n    };\n    /**\n     * Opens the result in the same window, no matter how the actual component is configured for the end user.\n     * @param logAnalytics Specifies whether the method should log an analytics event.\n     */\n    ResultLink.prototype.openLink = function (logAnalytics) {\n        if (logAnalytics === void 0) { logAnalytics = true; }\n        if (logAnalytics) {\n            this.logAnalytics();\n        }\n        window.location.href = this.getResultUri();\n    };\n    /**\n     * Opens the result in a new window, no matter how the actual component is configured for the end user.\n     * @param logAnalytics Specifies whether the method should log an analytics event.\n     */\n    ResultLink.prototype.openLinkInNewWindow = function (logAnalytics) {\n        if (logAnalytics === void 0) { logAnalytics = true; }\n        if (logAnalytics) {\n            this.logAnalytics();\n        }\n        window.open(this.getResultUri(), '_blank');\n    };\n    /**\n     * Tries to open the result in Microsoft Outlook if the result has an `outlookformacuri` or `outlookuri` field.\n     *\n     * Normally, this implies the result should be a link to an email.\n     *\n     * If the needed fields are not present, this method does nothing.\n     * @param logAnalytics Specifies whether the method should log an analytics event.\n     */\n    ResultLink.prototype.openLinkInOutlook = function (logAnalytics) {\n        if (logAnalytics === void 0) { logAnalytics = true; }\n        if (this.hasOutlookField()) {\n            if (logAnalytics) {\n                this.logAnalytics();\n            }\n            this.openLink();\n        }\n    };\n    /**\n     * Opens the link in the same manner the end user would.\n     *\n     * This essentially simulates a click on the result link.\n     *\n     * @param logAnalytics Specifies whether the method should log an analytics event.\n     */\n    ResultLink.prototype.openLinkAsConfigured = function (logAnalytics) {\n        if (logAnalytics === void 0) { logAnalytics = true; }\n        if (this.toExecuteOnOpen) {\n            if (logAnalytics) {\n                this.logAnalytics();\n            }\n            this.toExecuteOnOpen();\n        }\n    };\n    ResultLink.prototype.bindEventToOpen = function () {\n        return (this.bindOnClickIfNotUndefined() ||\n            this.bindOpenQuickviewIfNotUndefined() ||\n            this.setHrefIfNotAlready() ||\n            this.openLinkThatIsNotAnAnchor());\n    };\n    ResultLink.prototype.getDisplayedTitle = function () {\n        if (!this.options.titleTemplate) {\n            return this.result.title\n                ? HighlightUtils_1.HighlightUtils.highlightString(this.result.title, this.result.titleHighlights, null, 'coveo-highlight')\n                : this.escapedClickUri;\n        }\n        else {\n            var newTitle = StringUtils_1.StringUtils.buildStringTemplateFromResult(this.options.titleTemplate, this.result);\n            return newTitle\n                ? StreamHighlightUtils_1.StreamHighlightUtils.highlightStreamText(newTitle, this.result.termsToHighlight, this.result.phrasesToHighlight)\n                : this.escapedClickUri;\n        }\n    };\n    ResultLink.prototype.getDisplayedTitleAsText = function () {\n        var container = Dom_1.$$('div');\n        container.setHtml(this.getDisplayedTitle());\n        return container.text();\n    };\n    Object.defineProperty(ResultLink.prototype, \"escapedClickUri\", {\n        get: function () {\n            return underscore_1.escape(this.result.clickUri);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ResultLink.prototype.bindOnClickIfNotUndefined = function () {\n        var _this = this;\n        if (this.options.onClick != undefined) {\n            this.toExecuteOnOpen = function (e) {\n                _this.options.onClick.call(_this, e, _this.result);\n            };\n            new AccessibleButton_1.AccessibleButton()\n                .withElement(this.element)\n                .withLabel(this.result.title)\n                .withSelectAction(function (e) { return _this.toExecuteOnOpen(e); })\n                .build();\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    ResultLink.prototype.bindOpenQuickviewIfNotUndefined = function () {\n        var _this = this;\n        if (this.quickviewShouldBeOpened()) {\n            this.toExecuteOnOpen = function () {\n                Dom_1.$$(_this.bindings.resultElement).trigger(ResultListEvents_1.ResultListEvents.openQuickview);\n            };\n            Dom_1.$$(this.element).on('click', function (e) {\n                e.preventDefault();\n                _this.toExecuteOnOpen();\n            });\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    ResultLink.prototype.openLinkThatIsNotAnAnchor = function () {\n        var _this = this;\n        if (!this.elementIsAnAnchor()) {\n            this.toExecuteOnOpen = function () {\n                if (_this.options.alwaysOpenInNewWindow) {\n                    if (_this.options.openInOutlook) {\n                        _this.openLinkInOutlook();\n                    }\n                    else {\n                        _this.openLinkInNewWindow();\n                    }\n                }\n                else {\n                    _this.openLink();\n                }\n            };\n            Dom_1.$$(this.element).on('click', function () {\n                _this.toExecuteOnOpen();\n            });\n            return true;\n        }\n        return false;\n    };\n    ResultLink.prototype.setHrefIfNotAlready = function () {\n        // Do not erase any value put in href by the template, etc. Allows\n        // using custom click urls while still keeping analytics recording\n        // and other behavior brought by the component.\n        if (this.elementIsAnAnchor() && !Utils_1.Utils.isNonEmptyString(Dom_1.$$(this.element).getAttribute('href'))) {\n            Dom_1.$$(this.element).setAttribute('href', this.getResultUri());\n            if (this.options.alwaysOpenInNewWindow && !(this.options.openInOutlook && this.hasOutlookField())) {\n                Dom_1.$$(this.element).setAttribute('target', '_blank');\n            }\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    ResultLink.prototype.logDocumentOpen = function (href) {\n        this.usageAnalytics.logClickEvent(AnalyticsActionListMeta_1.analyticsActionCauseList.documentOpen, {\n            documentURL: href,\n            documentTitle: this.result.title,\n            author: Utils_1.Utils.getFieldValue(this.result, 'author')\n        }, this.result, this.root);\n    };\n    ResultLink.prototype.filterProtocol = function (uri) {\n        var isAbsolute = /^(https?|ftp|file|mailto|tel):/i.test(uri);\n        var isRelative = /^(\\/|\\.\\/|\\.\\.\\/)/.test(uri);\n        return isAbsolute || isRelative ? uri : '';\n    };\n    ResultLink.prototype.getResultUri = function () {\n        if (this.options.hrefTemplate) {\n            var uri = StringUtils_1.StringUtils.buildStringTemplateFromResult(this.options.hrefTemplate, this.result);\n            return this.filterProtocol(uri);\n        }\n        if (this.options.field == undefined && this.options.openInOutlook) {\n            this.setField();\n        }\n        if (this.options.field != undefined) {\n            return this.filterProtocol(Utils_1.Utils.getFieldValue(this.result, this.options.field));\n        }\n        return this.filterProtocol(this.result.clickUri);\n    };\n    ResultLink.prototype.elementIsAnAnchor = function () {\n        return this.element.tagName == 'A';\n    };\n    ResultLink.prototype.setField = function () {\n        var os = Utils_1.Utils.exists(this.os) ? this.os : OSUtils_1.OSUtils.get();\n        if (os == OSUtils_1.OS_NAME.MACOSX && this.hasOutlookField()) {\n            this.options.field = '@outlookformacuri';\n        }\n        else if (os == OSUtils_1.OS_NAME.WINDOWS && this.hasOutlookField()) {\n            this.options.field = '@outlookuri';\n        }\n    };\n    ResultLink.prototype.hasOutlookField = function () {\n        var os = Utils_1.Utils.exists(this.os) ? this.os : OSUtils_1.OSUtils.get();\n        if (os == OSUtils_1.OS_NAME.MACOSX && this.result.raw['outlookformacuri'] != undefined) {\n            return true;\n        }\n        else if (os == OSUtils_1.OS_NAME.WINDOWS && this.result.raw['outlookuri'] != undefined) {\n            return true;\n        }\n        return false;\n    };\n    ResultLink.prototype.isUriThatMustBeOpenedInQuickview = function () {\n        return this.escapedClickUri.toLowerCase().indexOf('ldap://') == 0;\n    };\n    ResultLink.prototype.quickviewShouldBeOpened = function () {\n        return (this.options.openQuickview || this.isUriThatMustBeOpenedInQuickview()) && QueryUtils_1.QueryUtils.hasHTMLVersion(this.result);\n    };\n    ResultLink.ID = 'ResultLink';\n    ResultLink.doExport = function () {\n        GlobalExports_1.exportGlobally({\n            ResultLink: ResultLink\n        });\n    };\n    /**\n     * The options for the ResultLink\n     * @componentOptions\n     */\n    ResultLink.options = {\n        /**\n         * Specifies the field to use to output the component `href` attribute value.\n         *\n         * **Tip:**\n         * > Instead of specifying a value for the `field` option, you can directly add an `href` attribute to the\n         * > `ResultLink` HTML element. Then, you can use a custom script to generate the `href` value.\n         *\n         * **Examples:**\n         * - With the following markup, the `ResultLink` outputs its `href` value using the `@uri` field (rather than the\n         * default field):\n         *\n         * ```html\n         * <a class=\"CoveoResultLink\" data-field=\"@uri\"></a>\n         * ```\n         *\n         * - In the following result template, the custom `getMyKBUri()` function provides the `href` value:\n         *\n         * ```html\n         * <script id=\"KnowledgeArticle\" type=\"text/underscore\" class=\"result-template\">\n         *   <div class='CoveoIcon>'></div>\n         *   <a class=\"CoveoResultLink\" href=\"<%= getMyKBUri(raw) %>\"></a>\n         *   <div class=\"CoveoExcerpt\"></div>\n         * </script>\n         * ```\n         *\n         * See also [`hrefTemplate`]{@link ResultLink.options.hrefTemplate}, which can override this option.\n         *\n         * By default, the component uses the `@clickUri` field of the item to output the value of its `href` attribute.\n         */\n        field: ComponentOptions_1.ComponentOptions.buildFieldOption(),\n        /**\n         * Specifies whether the component should try to open its link in Microsoft Outlook.\n         *\n         * Setting this option to `true` is normally useful for `ResultLink` instances related to Microsoft Exchange emails.\n         *\n         * If this option is `true`, clicking the `ResultLink` calls the\n         * [`openLinkInOutlook`]{@link ResultLink.openLinkInOutlook} method instead of the\n         * [`openLink`]{@link ResultLink.openLink} method.\n         *\n         * Default value is `false`.\n         */\n        openInOutlook: ComponentOptions_1.ComponentOptions.buildBooleanOption({ defaultValue: false }),\n        /**\n         * Specifies whether the component should open its link in the [`Quickview`]{@link Quickview} component rather than\n         * loading through the original URL.\n         *\n         * Default value is `false`.\n         */\n        openQuickview: ComponentOptions_1.ComponentOptions.buildBooleanOption({ defaultValue: false }),\n        /**\n         * Specifies whether the component should open its link in a new window instead of opening it in the current\n         * context.\n         *\n         * If this option is `true`, clicking the `ResultLink` calls the\n         * [`openLinkInNewWindow`]{@link ResultLink.openLinkInNewWindow} method instead of the\n         * [`openLink`]{@link ResultLink.openLink} method.\n         *\n         * **Note:**\n         * > If a search page contains a [`ResultPreferences`]{@link ResultsPreferences} component whose\n         * > [`enableOpenInNewWindow`]{@link ResultsPreferences.options.enableOpenInNewWindow} option is `true`, and the end\n         * > user checks the <b>Always open results in new window</b> box, `ResultLink` components in this page will always\n         * > open their links in a new window when the end user clicks them, no matter what the value of their\n         * > `alwaysOpenInNewWindow` option is.\n         *\n         * Default value is `false`.\n         */\n        alwaysOpenInNewWindow: ComponentOptions_1.ComponentOptions.buildBooleanOption({ defaultValue: false }),\n        /**\n         * Specifies a template literal from which to generate the `ResultLink` `href` attribute value (see\n         * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\n         *\n         * This option overrides the [`field`]{@link ResultLink.options.field} option value.\n         *\n         * The template literal can reference any number of fields from the parent result. It can also reference global\n         * scope properties.\n         *\n         * **Examples:**\n         *\n         * - The following markup generates an `href` value such as `http://uri.com?id=itemTitle`:\n         *\n         * ```html\n         * <a class='CoveoResultLink' data-href-template='${clickUri}?id=${raw.title}'></a>\n         * ```\n         *\n         * - The following markup generates an `href` value such as `localhost/fooBar`:\n         *\n         * ```html\n         * <a class='CoveoResultLink' data-href-template='${window.location.hostname}/{Foo.Bar}'></a>\n         * ```\n         *\n         * Default value is `undefined`.\n         */\n        hrefTemplate: ComponentOptions_1.ComponentOptions.buildStringOption(),\n        /**\n         * Specifies a template literal from which to generate the `ResultLink` display title (see\n         * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\n         *\n         * This option overrides the default `ResultLink` display title behavior.\n         *\n         * The template literal can reference any number of fields from the parent result. However, if the template literal\n         * references a key whose value is undefined in the parent result fields, the `ResultLink` title displays the\n         * name of this key instead.\n         *\n         * This option is ignored if the `ResultLink` innerHTML contains any value.\n         *\n         * **Examples:**\n         *\n         * - The following markup generates a `ResultLink` display title such as `Case number: 123456` if both the\n         * `raw.objecttype` and `raw.objectnumber` keys are defined in the parent result fields:\n         *\n         * ```html\n         * <a class=\"CoveoResultLink\" data-title-template=\"${raw.objecttype} number: ${raw.objectnumber}\"></a>\n         * ```\n         *\n         * - The following markup generates `${myField}` as a `ResultLink` display title if the `myField` key is undefined\n         * in the parent result fields:\n         *\n         * ```html\n         * <a class=\"CoveoResultLink\" data-title-template=\"${myField}\"></a>\n         * ```\n         *\n         * - The following markup generates `Foobar` as a `ResultLink` display title, because the `ResultLink` innterHTML is\n         * not empty:\n         *\n         * ```html\n         * <a class=\"CoveoResultLink\" data-title-template=\"${will} ${be} ${ignored}\">Foobar</a>\n         * ```\n         *\n         * Default value is `undefined`.\n         *\n         * @availablesince [January 2017 Release (v1.1865.9)](https://docs.coveo.com/en/396/#january-2017-release-v118659)\n         */\n        titleTemplate: ComponentOptions_1.ComponentOptions.buildStringOption(),\n        /**\n         * Specifies an event handler function to execute when the user clicks the `ResultLink` component.\n         *\n         * The handler function takes a JavaScript [`Event`](https://developer.mozilla.org/en/docs/Web/API/Event) object and\n         * an [`IQueryResult`]{@link IQueryResult} as its parameters.\n         *\n         * Overriding the default behavior of the `onClick` event can allow you to execute specific code instead.\n         *\n         * **Note:**\n         * > You cannot set this option directly in the component markup as an HTML attribute. You must either set it in the\n         * > [`init`]{@link init} call of your search interface (see\n         * > [Passing Component Options in the init Call](https://docs.coveo.com/en/346/#passing-component-options-in-the-init-call)),\n         * > or before the `init` call, using the `options` top-level function (see\n         * > [Passing Component Options Before the init Call](https://docs.coveo.com/en/346/#passing-component-options-before-the-init-call)).\n         *\n         * **Example:**\n         * ```javascript\n         * // You can set the option in the 'init' call:\n         * Coveo.init(document.querySelector(\"#search\"), {\n         *   ResultLink : {\n         *     onClick : function(e, result) {\n         *       e.preventDefault();\n         *       // Custom code to execute with the item URI and title.\n         *       openUriInASpecialTab(result.clickUri, result.title);\n         *     }\n         *   }\n         * });\n         *\n         * // Or before the 'init' call, using the 'options' top-level function:\n         * // Coveo.options(document.querySelector('#search'), {\n         * //   ResultLink : {\n         * //     onClick : function(e, result) {\n         * //       e.preventDefault();\n         * //       // Custom code to execute with the item URI and title.\n         * //       openUriInASpecialTab(result.clickUri, result.title);\n         * //     }\n         * //   }\n         * // });\n         * ```\n         */\n        onClick: ComponentOptions_1.ComponentOptions.buildCustomOption(function () {\n            return null;\n        }),\n        /**\n         * Specify this option to log additional analytics when this result link is pressed.\n         *\n         * **Example:**\n         * ```javascript\n         * const resultLink = new Coveo.ResultLink(\n         *   linkElement,\n         *   {\n         *     logAnalytics: (href) => Coveo.logCustomEvent(\n         *         Coveo.analyticsActionCauseList.openSmartSnippetSource,\n         *         {\n         *           searchQueryUid: searchInterface.queryController.lastSearchUid,\n         *           documentTitle: result.title,\n         *           author: Utils.getFieldValue(result, 'author'),\n         *           documentURL: href\n         *         },\n         *         element\n         *       )\n         *   },\n         *   searchInterface.getBindings(),\n         *   result\n         * )\n         * ```\n         */\n        logAnalytics: ComponentOptions_1.ComponentOptions.buildCustomOption(function () { return null; })\n    };\n    return ResultLink;\n}(Component_1.Component));\nexports.ResultLink = ResultLink;\nInitialization_1.Initialization.registerAutoCreateComponent(ResultLink);\n\n\n/***/ }),\n\n/***/ 701:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 702:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Dom_1 = __webpack_require__(1);\nvar Strings_1 = __webpack_require__(6);\nvar SVGIcons_1 = __webpack_require__(12);\nvar underscore_1 = __webpack_require__(0);\nvar ROOT_CLASSNAME = 'coveo-user-feedback-banner';\nvar CONTAINER_CLASSNAME = ROOT_CLASSNAME + \"-container\";\nvar LABEL_CLASSNAME = ROOT_CLASSNAME + \"-label\";\nvar BUTTONS_CONTAINER_CLASSNAME = ROOT_CLASSNAME + \"-buttons\";\nvar YES_BUTTON_CLASSNAME = ROOT_CLASSNAME + \"-yes-button\";\nvar NO_BUTTON_CLASSNAME = ROOT_CLASSNAME + \"-no-button\";\nvar BUTTON_ACTIVE_CLASSNAME = ROOT_CLASSNAME + \"-button-active\";\nvar THANK_YOU_BANNER_CLASSNAME = ROOT_CLASSNAME + \"-thanks\";\nvar THANK_YOU_BANNER_ACTIVE_CLASSNAME = THANK_YOU_BANNER_CLASSNAME + \"-active\";\nvar ICON_CLASSNAME = THANK_YOU_BANNER_CLASSNAME + \"-icon\";\nvar EXPLAIN_WHY_CLASSNAME = ROOT_CLASSNAME + \"-explain-why\";\nvar EXPLAIN_WHY_ACTIVE_CLASSNAME = EXPLAIN_WHY_CLASSNAME + \"-active\";\nvar UsefulState;\n(function (UsefulState) {\n    UsefulState[UsefulState[\"Unknown\"] = 0] = \"Unknown\";\n    UsefulState[UsefulState[\"Yes\"] = 1] = \"Yes\";\n    UsefulState[UsefulState[\"No\"] = 2] = \"No\";\n})(UsefulState || (UsefulState = {}));\nexports.UserFeedbackBannerClassNames = {\n    ROOT_CLASSNAME: ROOT_CLASSNAME,\n    CONTAINER_CLASSNAME: CONTAINER_CLASSNAME,\n    LABEL_CLASSNAME: LABEL_CLASSNAME,\n    BUTTONS_CONTAINER_CLASSNAME: BUTTONS_CONTAINER_CLASSNAME,\n    YES_BUTTON_CLASSNAME: YES_BUTTON_CLASSNAME,\n    NO_BUTTON_CLASSNAME: NO_BUTTON_CLASSNAME,\n    BUTTON_ACTIVE_CLASSNAME: BUTTON_ACTIVE_CLASSNAME,\n    THANK_YOU_BANNER_CLASSNAME: THANK_YOU_BANNER_CLASSNAME,\n    THANK_YOU_BANNER_ACTIVE_CLASSNAME: THANK_YOU_BANNER_ACTIVE_CLASSNAME,\n    ICON_CLASSNAME: ICON_CLASSNAME,\n    EXPLAIN_WHY_CLASSNAME: EXPLAIN_WHY_CLASSNAME,\n    EXPLAIN_WHY_ACTIVE_CLASSNAME: EXPLAIN_WHY_ACTIVE_CLASSNAME\n};\nvar UserFeedbackBanner = /** @class */ (function () {\n    function UserFeedbackBanner(sendUsefulnessAnalytics, onExplainWhyPressed) {\n        this.sendUsefulnessAnalytics = sendUsefulnessAnalytics;\n        this.onExplainWhyPressed = onExplainWhyPressed;\n        this.isUseful = UsefulState.Unknown;\n        this.labelId = underscore_1.uniqueId(LABEL_CLASSNAME);\n    }\n    UserFeedbackBanner.prototype.build = function () {\n        return Dom_1.$$('div', {\n            className: ROOT_CLASSNAME,\n            ariaLive: 'polite'\n        }, this.buildContainer(), this.buildThankYouBanner()).el;\n    };\n    UserFeedbackBanner.prototype.reset = function () {\n        this.isUseful = UsefulState.Unknown;\n        Dom_1.$$(this.yesButton).removeClass(BUTTON_ACTIVE_CLASSNAME);\n        Dom_1.$$(this.yesButton).setAttribute('aria-pressed', 'false');\n        Dom_1.$$(this.noButton).removeClass(BUTTON_ACTIVE_CLASSNAME);\n        Dom_1.$$(this.noButton).setAttribute('aria-pressed', 'false');\n        Dom_1.$$(this.thankYouBanner).removeClass(THANK_YOU_BANNER_ACTIVE_CLASSNAME);\n        Dom_1.$$(this.explainWhy).removeClass(EXPLAIN_WHY_ACTIVE_CLASSNAME);\n    };\n    UserFeedbackBanner.prototype.buildContainer = function () {\n        return Dom_1.$$('div', {\n            className: CONTAINER_CLASSNAME,\n            ariaLabelledby: this.labelId\n        }, this.buildLabel(), this.buildButtons()).el;\n    };\n    UserFeedbackBanner.prototype.buildLabel = function () {\n        return Dom_1.$$('span', { className: LABEL_CLASSNAME, id: this.labelId }, Strings_1.l('UsefulnessFeedbackRequest')).el;\n    };\n    UserFeedbackBanner.prototype.buildThankYouBanner = function () {\n        var _this = this;\n        this.thankYouBanner = Dom_1.$$('div', { className: THANK_YOU_BANNER_CLASSNAME }).el;\n        var text = Dom_1.$$('span', {}, Strings_1.l('UsefulnessFeedbackThankYou')).el;\n        this.thankYouBanner.appendChild(text);\n        this.explainWhy = this.buildButton({\n            text: Strings_1.l('UsefulnessFeedbackExplainWhy'),\n            className: EXPLAIN_WHY_CLASSNAME,\n            action: function () { return _this.requestExplaination(); }\n        });\n        this.thankYouBanner.appendChild(this.explainWhy);\n        return this.thankYouBanner;\n    };\n    UserFeedbackBanner.prototype.buildButtons = function () {\n        var _this = this;\n        var buttonsContainer = Dom_1.$$('div', { className: BUTTONS_CONTAINER_CLASSNAME }).el;\n        this.yesButton = this.buildButton({\n            text: Strings_1.l('Yes'),\n            className: YES_BUTTON_CLASSNAME,\n            action: function () { return _this.showThankYouBanner(true); },\n            icon: {\n                className: ICON_CLASSNAME,\n                content: SVGIcons_1.SVGIcons.icons.checkYes\n            },\n            attributes: {\n                ariaPressed: false,\n                ariaDescribedby: this.labelId\n            }\n        });\n        this.yesButton.setAttribute('aria-pressed', 'false');\n        buttonsContainer.appendChild(this.yesButton);\n        this.noButton = this.buildButton({\n            text: Strings_1.l('No'),\n            className: NO_BUTTON_CLASSNAME,\n            action: function () { return _this.showThankYouBanner(false); },\n            icon: {\n                className: ICON_CLASSNAME,\n                content: SVGIcons_1.SVGIcons.icons.clearSmall\n            },\n            attributes: {\n                ariaPressed: false,\n                ariaDescribedby: this.labelId\n            }\n        });\n        buttonsContainer.appendChild(this.noButton);\n        return buttonsContainer;\n    };\n    UserFeedbackBanner.prototype.buildButton = function (options) {\n        var button = Dom_1.$$('button', __assign({}, (options.attributes || {}), { className: options.className, type: 'button' })).el;\n        if (options.icon) {\n            var icon = Dom_1.$$('span', { className: options.icon.className }, options.icon.content).el;\n            button.appendChild(icon);\n            var text = Dom_1.$$('span', {}, options.text).el;\n            button.appendChild(text);\n        }\n        else {\n            button.innerText = options.text;\n        }\n        button.addEventListener('click', function () { return options.action(); });\n        return button;\n    };\n    UserFeedbackBanner.prototype.showThankYouBanner = function (isUseful) {\n        if (this.isUseful !== UsefulState.Unknown && isUseful === (this.isUseful === UsefulState.Yes)) {\n            return;\n        }\n        this.isUseful = isUseful ? UsefulState.Yes : UsefulState.No;\n        Dom_1.$$(this.yesButton).toggleClass(BUTTON_ACTIVE_CLASSNAME, isUseful);\n        Dom_1.$$(this.yesButton).setAttribute('aria-pressed', \"\" + isUseful);\n        Dom_1.$$(this.noButton).toggleClass(BUTTON_ACTIVE_CLASSNAME, !isUseful);\n        Dom_1.$$(this.noButton).setAttribute('aria-pressed', \"\" + !isUseful);\n        Dom_1.$$(this.thankYouBanner).addClass(THANK_YOU_BANNER_ACTIVE_CLASSNAME);\n        Dom_1.$$(this.explainWhy).toggleClass(EXPLAIN_WHY_ACTIVE_CLASSNAME, !isUseful);\n        this.sendUsefulnessAnalytics(isUseful);\n    };\n    UserFeedbackBanner.prototype.requestExplaination = function () {\n        this.onExplainWhyPressed();\n    };\n    return UserFeedbackBanner;\n}());\nexports.UserFeedbackBanner = UserFeedbackBanner;\n\n\n/***/ }),\n\n/***/ 703:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Dom_1 = __webpack_require__(1);\nvar SVGIcons_1 = __webpack_require__(12);\nvar Strings_1 = __webpack_require__(6);\nvar BASE_CLASSNAME = 'coveo-height-limiter';\nvar CONTAINER_ACTIVE_CLASSNAME = BASE_CLASSNAME + \"-container-active\";\nvar CONTAINER_EXPANDED_CLASSNAME = BASE_CLASSNAME + \"-container-expanded\";\nvar BUTTON_CLASSNAME = BASE_CLASSNAME + \"-button\";\nvar BUTTON_LABEL_CLASSNAME = BUTTON_CLASSNAME + \"-label\";\nvar BUTTON_ICON_CLASSNAME = BUTTON_CLASSNAME + \"-icon\";\nvar BUTTON_ACTIVE_CLASSNAME = BUTTON_CLASSNAME + \"-active\";\nexports.HeightLimiterClassNames = {\n    CONTAINER_ACTIVE_CLASSNAME: CONTAINER_ACTIVE_CLASSNAME,\n    CONTAINER_EXPANDED_CLASSNAME: CONTAINER_EXPANDED_CLASSNAME,\n    BUTTON_CLASSNAME: BUTTON_CLASSNAME,\n    BUTTON_LABEL_CLASSNAME: BUTTON_LABEL_CLASSNAME,\n    BUTTON_ICON_CLASSNAME: BUTTON_ICON_CLASSNAME,\n    BUTTON_ACTIVE_CLASSNAME: BUTTON_ACTIVE_CLASSNAME\n};\nvar HeightLimiter = /** @class */ (function () {\n    function HeightLimiter(containerElement, contentElement, heightLimit, onToggle) {\n        this.containerElement = containerElement;\n        this.contentElement = contentElement;\n        this.heightLimit = heightLimit;\n        this.onToggle = onToggle;\n        this.isExpanded = false;\n        this.buildButton();\n        this.updateActiveAppearance();\n    }\n    Object.defineProperty(HeightLimiter.prototype, \"toggleButton\", {\n        get: function () {\n            return this.button;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HeightLimiter.prototype, \"height\", {\n        set: function (height) {\n            this.containerElement.style.height = height + \"px\";\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HeightLimiter.prototype, \"contentHeight\", {\n        get: function () {\n            return this.contentElement.clientHeight;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    HeightLimiter.prototype.onContentHeightChanged = function () {\n        this.updateActiveAppearance();\n    };\n    HeightLimiter.prototype.buildButton = function () {\n        var _this = this;\n        this.button = Dom_1.$$('button', { className: BUTTON_CLASSNAME, type: 'button', ariaLabel: Strings_1.l('ShowMore'), ariaPressed: 'false', ariaHidden: 'true' }, (this.buttonLabel = Dom_1.$$('span', { className: BUTTON_LABEL_CLASSNAME }).el), (this.buttonIcon = Dom_1.$$('span', { className: BUTTON_ICON_CLASSNAME }).el)).el;\n        this.button.addEventListener('click', function () { return _this.toggle(); });\n        this.updateButton();\n        return this.button;\n    };\n    HeightLimiter.prototype.updateActiveAppearance = function () {\n        var shouldBeActive = this.contentHeight > this.heightLimit;\n        Dom_1.$$(this.containerElement).toggleClass(CONTAINER_ACTIVE_CLASSNAME, shouldBeActive);\n        Dom_1.$$(this.button).toggleClass(BUTTON_ACTIVE_CLASSNAME, shouldBeActive);\n        if (shouldBeActive) {\n            this.updateExpandedAppearance();\n        }\n        else {\n            this.isExpanded = false;\n            this.updateExpandedAppearance();\n            this.containerElement.style.height = '';\n        }\n    };\n    HeightLimiter.prototype.updateButton = function () {\n        this.buttonLabel.innerText = this.isExpanded ? Strings_1.l('ShowLess') : Strings_1.l('ShowMore');\n        this.button.setAttribute('aria-pressed', \"\" + this.isExpanded);\n        this.buttonIcon.innerHTML = this.isExpanded ? SVGIcons_1.SVGIcons.icons.arrowUp : SVGIcons_1.SVGIcons.icons.arrowDown;\n    };\n    HeightLimiter.prototype.updateExpandedAppearance = function () {\n        this.updateButton();\n        Dom_1.$$(this.containerElement).toggleClass(CONTAINER_EXPANDED_CLASSNAME, this.isExpanded);\n        this.height = this.isExpanded ? this.contentHeight : this.heightLimit;\n    };\n    HeightLimiter.prototype.toggle = function () {\n        this.isExpanded = !this.isExpanded;\n        this.updateExpandedAppearance();\n        if (this.onToggle) {\n            this.onToggle(this.isExpanded);\n        }\n    };\n    return HeightLimiter;\n}());\nexports.HeightLimiter = HeightLimiter;\n\n\n/***/ }),\n\n/***/ 704:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar AccessibleModal_1 = __webpack_require__(177);\nvar Strings_1 = __webpack_require__(6);\nvar Dom_1 = __webpack_require__(1);\nvar RadioButton_1 = __webpack_require__(97);\n__webpack_require__(705);\nvar ROOT_CLASSNAME = 'coveo-user-explanation-modal';\nvar CONTENT_CLASSNAME = ROOT_CLASSNAME + \"-content\";\nvar EXPLANATION_SECTION_CLASSNAME = ROOT_CLASSNAME + \"-explanation-section\";\nvar REASONS_CLASSNAME = ROOT_CLASSNAME + \"-explanations\";\nvar REASONS_LABEL_CLASSNAME = REASONS_CLASSNAME + \"-label\";\nvar DETAILS_SECTION_CLASSNAME = ROOT_CLASSNAME + \"-details\";\nvar DETAILS_TEXTAREA_CLASSNAME = DETAILS_SECTION_CLASSNAME + \"-textarea\";\nvar DETAILS_LABEL_CLASSNAME = DETAILS_SECTION_CLASSNAME + \"-label\";\nvar BUTTONS_SECTION_CLASSNAME = ROOT_CLASSNAME + \"-buttons-section\";\nvar SEND_BUTTON_CLASSNAME = ROOT_CLASSNAME + \"-send-button\";\nvar CANCEL_BUTTON_CLASSNAME = ROOT_CLASSNAME + \"-cancel-button\";\nvar DETAILS_ID = DETAILS_SECTION_CLASSNAME;\nexports.ExplanationModalClassNames = {\n    ROOT_CLASSNAME: ROOT_CLASSNAME,\n    CONTENT_CLASSNAME: CONTENT_CLASSNAME,\n    EXPLANATION_SECTION_CLASSNAME: EXPLANATION_SECTION_CLASSNAME,\n    REASONS_CLASSNAME: REASONS_CLASSNAME,\n    REASONS_LABEL_CLASSNAME: REASONS_LABEL_CLASSNAME,\n    DETAILS_SECTION_CLASSNAME: DETAILS_SECTION_CLASSNAME,\n    DETAILS_TEXTAREA_CLASSNAME: DETAILS_TEXTAREA_CLASSNAME,\n    DETAILS_LABEL_CLASSNAME: DETAILS_LABEL_CLASSNAME,\n    BUTTONS_SECTION_CLASSNAME: BUTTONS_SECTION_CLASSNAME,\n    SEND_BUTTON_CLASSNAME: SEND_BUTTON_CLASSNAME,\n    CANCEL_BUTTON_CLASSNAME: CANCEL_BUTTON_CLASSNAME\n};\nvar ExplanationModal = /** @class */ (function () {\n    function ExplanationModal(options) {\n        var _this = this;\n        this.options = options;\n        this.shouldCallCloseEvent = false;\n        this.modal = new AccessibleModal_1.AccessibleModal(ROOT_CLASSNAME, this.options.ownerElement, this.options.modalBoxModule, {\n            focusOnOpen: function () { return _this.sendButton(); }\n        });\n    }\n    ExplanationModal.prototype.sendButton = function () {\n        return this.modal.element.querySelector(\".\" + REASONS_CLASSNAME + \" input\");\n    };\n    Object.defineProperty(ExplanationModal.prototype, \"details\", {\n        get: function () {\n            if (!this.selectedReason || !this.selectedReason.hasDetails) {\n                return null;\n            }\n            return this.detailsTextArea.value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ExplanationModal.prototype.open = function (origin) {\n        var _this = this;\n        this.modal.open({\n            origin: origin,\n            title: Dom_1.$$('span', {}, Strings_1.l('UsefulnessFeedbackExplainWhyImperative')).el,\n            content: this.buildContent(),\n            validation: function () {\n                if (_this.shouldCallCloseEvent) {\n                    _this.options.onClosed();\n                    _this.shouldCallCloseEvent = false;\n                }\n                return true;\n            }\n        });\n        this.shouldCallCloseEvent = true;\n    };\n    ExplanationModal.prototype.buildContent = function () {\n        return Dom_1.$$('div', {\n            className: CONTENT_CLASSNAME\n        }, this.buildExplanationSection(), this.buildButtonsSection()).el;\n    };\n    ExplanationModal.prototype.buildExplanationSection = function () {\n        var detailsSection = this.buildDetailsSection();\n        return Dom_1.$$('div', {\n            className: EXPLANATION_SECTION_CLASSNAME\n        }, this.buildReasons(), detailsSection).el;\n    };\n    ExplanationModal.prototype.buildButtonsSection = function () {\n        return Dom_1.$$('div', {\n            className: BUTTONS_SECTION_CLASSNAME\n        }, this.buildSendButton(), this.buildCancelButton());\n    };\n    ExplanationModal.prototype.buildReasons = function () {\n        var _this = this;\n        var reasonsContainer = Dom_1.$$('fieldset', { className: REASONS_CLASSNAME }, this.buildReasonsLabel()).el;\n        this.reasons = this.options.reasons.map(function (reason) { return _this.buildReasonRadioButton(reason); });\n        this.reasons[0].select();\n        this.reasons.forEach(function (radioButton) { return reasonsContainer.appendChild(radioButton.getElement()); });\n        return reasonsContainer;\n    };\n    ExplanationModal.prototype.buildReasonsLabel = function () {\n        return Dom_1.$$('legend', { className: REASONS_LABEL_CLASSNAME }, Strings_1.l('UsefulnessFeedbackReason')).el;\n    };\n    ExplanationModal.prototype.buildDetailsSection = function () {\n        return (this.detailsSection = Dom_1.$$('div', { className: \"coveo-hidden \" + DETAILS_SECTION_CLASSNAME }, Dom_1.$$('label', { className: DETAILS_LABEL_CLASSNAME, for: DETAILS_ID }, Strings_1.l('Details')).el, (this.detailsTextArea = Dom_1.$$('textarea', { className: DETAILS_TEXTAREA_CLASSNAME, id: DETAILS_ID, disabled: true })\n            .el)));\n    };\n    ExplanationModal.prototype.buildSendButton = function () {\n        var _this = this;\n        var button = Dom_1.$$('button', { className: SEND_BUTTON_CLASSNAME, type: 'button' }, Strings_1.l('Send'));\n        button.on('click', function () {\n            _this.selectedReason.onSelect();\n            _this.shouldCallCloseEvent = false;\n            _this.modal.close();\n        });\n        return button.el;\n    };\n    ExplanationModal.prototype.buildCancelButton = function () {\n        var _this = this;\n        var button = Dom_1.$$('button', { className: CANCEL_BUTTON_CLASSNAME, type: 'button' }, Strings_1.l('Cancel'));\n        button.on('click', function () { return _this.modal.close(); });\n        return button.el;\n    };\n    ExplanationModal.prototype.buildReasonRadioButton = function (reason) {\n        var _this = this;\n        return new RadioButton_1.RadioButton(function (radioButton) {\n            if (!radioButton.isSelected()) {\n                return;\n            }\n            _this.detailsSection.toggleClass('coveo-hidden', !reason.hasDetails);\n            _this.detailsTextArea.disabled = !reason.hasDetails;\n            _this.selectedReason = reason;\n        }, reason.label, 'reason', \"coveo-reason-\" + reason.id);\n    };\n    return ExplanationModal;\n}());\nexports.ExplanationModal = ExplanationModal;\n\n\n/***/ }),\n\n/***/ 705:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 97:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Dom_1 = __webpack_require__(1);\n__webpack_require__(558);\nvar GlobalExports_1 = __webpack_require__(3);\n/**\n * A radio button widget with standard styling.\n */\nvar RadioButton = /** @class */ (function () {\n    /**\n     * Creates a new `RadioButton`.\n     * @param onChange The function to call when the radio button value changes. This function takes the current\n     * `RadioButton` instance as an argument.\n     * @param label The label to display next to the radio button.\n     * @param name The value to set the `input` HTMLElement `name` attribute to.\n     */\n    function RadioButton(onChange, label, name, id) {\n        if (onChange === void 0) { onChange = function (radioButton) { }; }\n        if (id === void 0) { id = label; }\n        this.onChange = onChange;\n        this.label = label;\n        this.name = name;\n        this.id = id;\n        this.buildContent();\n    }\n    RadioButton.doExport = function () {\n        GlobalExports_1.exportGlobally({\n            RadioButton: RadioButton\n        });\n    };\n    /**\n     * Resets the radio button.\n     */\n    RadioButton.prototype.reset = function () {\n        var currentlySelected = this.isSelected();\n        this.getRadio().checked = false;\n        if (currentlySelected) {\n            this.onChange(this);\n        }\n    };\n    /**\n     * Select the radio button\n     * @param triggerChange will trigger change event if specified and the radio button is not already selected\n     */\n    RadioButton.prototype.select = function (triggerChange) {\n        if (triggerChange === void 0) { triggerChange = true; }\n        var currentlySelected = this.isSelected();\n        this.getRadio().checked = true;\n        if (!currentlySelected && triggerChange) {\n            this.onChange(this);\n        }\n    };\n    /**\n     * Gets the element on which the radio button is bound.\n     * @returns {HTMLElement} The radio button element.\n     */\n    RadioButton.prototype.build = function () {\n        return this.element;\n    };\n    /**\n     * Gets the element on which the radio button is bound.\n     * @returns {HTMLElement} The radio button element.\n     */\n    RadioButton.prototype.getElement = function () {\n        return this.element;\n    };\n    RadioButton.prototype.getValue = function () {\n        return this.label;\n    };\n    /**\n     * Indicates whether the radio button is selected.\n     * @returns {boolean} `true` if the radio button is selected, `false` otherwise.\n     */\n    RadioButton.prototype.isSelected = function () {\n        return this.getRadio().checked;\n    };\n    /**\n     * Gets the `input` element (the radio button itself).\n     * @returns {HTMLInputElement} The `input` element.\n     */\n    RadioButton.prototype.getRadio = function () {\n        return Dom_1.$$(this.element).find('input');\n    };\n    /**\n     * Gets the radio button [`label`]{@link RadioButton.label} element.\n     * @returns {HTMLLabelElement} The `label` element.\n     */\n    RadioButton.prototype.getLabel = function () {\n        return Dom_1.$$(this.element).find('label');\n    };\n    RadioButton.prototype.buildContent = function () {\n        var _this = this;\n        var radioOption = Dom_1.$$('div', { className: 'coveo-radio' });\n        var radioInput = Dom_1.$$('input', { type: 'radio', name: this.name, id: this.id });\n        var labelInput = Dom_1.$$('label', { className: 'coveo-radio-input-label', for: this.id });\n        labelInput.text(this.label);\n        radioInput.on('change', function () {\n            _this.onChange(_this);\n        });\n        radioOption.append(radioInput.el);\n        radioOption.append(labelInput.el);\n        this.element = radioOption.el;\n    };\n    return RadioButton;\n}());\nexports.RadioButton = RadioButton;\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// SmartSnippet.min__d6b9bcc2bfcb024de483.js","import { ModalBox as ModalBoxModule } from '../ExternalModulesShim';\nimport { FocusTrap } from '../ui/FocusTrap/FocusTrap';\nimport { l } from '../strings/Strings';\nimport { $$ } from './Dom';\nimport { KeyboardUtils, KEYBOARD } from './KeyboardUtils';\nimport { IQuickViewHeaderOptions } from './DomUtils';\nimport { IQueryResult } from '../rest/QueryResult';\nimport { IComponentBindings } from '../ui/Base/ComponentBindings';\nimport { DomUtils } from '../Core';\n\nexport interface IAccessibleModalOptions {\n  overlayClose?: boolean;\n  sizeMod: 'small' | 'normal' | 'big';\n  focusOnOpen?(): HTMLElement;\n}\n\nexport interface IAccessibleModalOpenParameters {\n  content: HTMLElement;\n  validation: () => boolean;\n  origin: HTMLElement;\n}\n\nexport interface IAccessibleModalOpenResultParameters extends IAccessibleModalOpenParameters {\n  result: IQueryResult;\n  options: IQuickViewHeaderOptions;\n  bindings: IComponentBindings;\n}\n\nexport interface IAccessibleModalOpenNormalParameters extends IAccessibleModalOpenParameters {\n  title: HTMLElement;\n}\n\nexport class AccessibleModal {\n  private focusTrap: FocusTrap;\n  private activeModal: Coveo.ModalBox.ModalBox;\n  private options: IAccessibleModalOptions;\n  private initiallyFocusedElement: HTMLElement;\n\n  public get isOpen() {\n    return !!this.focusTrap;\n  }\n\n  public get element() {\n    return this.activeModal && this.activeModal.modalBox;\n  }\n\n  public get content() {\n    return this.activeModal && this.activeModal.content;\n  }\n\n  public get wrapper() {\n    return this.activeModal && this.activeModal.wrapper;\n  }\n\n  private get headerElement() {\n    return this.element && this.element.querySelector<HTMLElement>('.coveo-modal-header h1');\n  }\n\n  constructor(\n    private className: string,\n    private ownerElement: HTMLElement,\n    private modalboxModule: Coveo.ModalBox.ModalBox = ModalBoxModule,\n    options: Partial<IAccessibleModalOptions> = {}\n  ) {\n    this.options = {\n      ...{\n        sizeMod: 'big'\n      },\n      ...options\n    };\n  }\n\n  public openResult(parameters: IAccessibleModalOpenResultParameters) {\n    if (this.isOpen) {\n      return;\n    }\n    this.openModalAndTrap({\n      content: parameters.content,\n      validation: parameters.validation,\n      origin: parameters.origin,\n      title: DomUtils.getQuickviewHeader(parameters.result, parameters.options, parameters.bindings).el\n    });\n    this.makeAccessible(parameters.options.title || parameters.result.title);\n  }\n\n  public open(parameters: IAccessibleModalOpenNormalParameters) {\n    if (this.isOpen) {\n      return;\n    }\n    this.openModalAndTrap(parameters);\n    this.makeAccessible();\n  }\n\n  private openModalAndTrap(parameters: IAccessibleModalOpenNormalParameters) {\n    this.initiallyFocusedElement = parameters.origin || (document.activeElement as HTMLElement);\n    this.activeModal = this.modalboxModule.open(parameters.content, {\n      title: parameters.title,\n      className: this.className,\n      validation: () => {\n        this.onModalClose();\n        return parameters.validation();\n      },\n      body: this.ownerElement,\n      sizeMod: this.options.sizeMod,\n      overlayClose: this.options.overlayClose\n    });\n    this.focusTrap = new FocusTrap(this.element);\n  }\n\n  public close() {\n    if (!this.isOpen) {\n      return;\n    }\n    this.activeModal.close();\n    this.activeModal = null;\n  }\n\n  private makeAccessible(title?: string) {\n    this.element.setAttribute('aria-modal', 'true');\n    if (title) {\n      this.headerElement.setAttribute('aria-label', title);\n    }\n    this.makeCloseButtonAccessible();\n    this.updateFocus();\n  }\n\n  private get closeButton(): HTMLElement {\n    return this.element.querySelector('.coveo-small-close');\n  }\n\n  private makeCloseButtonAccessible() {\n    const closeButton = this.closeButton;\n    closeButton.setAttribute('aria-label', l('Close'));\n    closeButton.setAttribute('role', 'button');\n    closeButton.tabIndex = 0;\n    $$(closeButton).on(\n      'keyup',\n      KeyboardUtils.keypressAction(KEYBOARD.ENTER, () => closeButton.click())\n    );\n  }\n\n  private updateFocus() {\n    const focusOnElement: HTMLElement = (this.options.focusOnOpen && this.options.focusOnOpen()) || this.closeButton;\n    focusOnElement.focus();\n  }\n\n  private onModalClose() {\n    this.focusTrap.disable();\n    this.focusTrap = null;\n    if (this.initiallyFocusedElement && document.body.contains(this.initiallyFocusedElement)) {\n      this.initiallyFocusedElement.focus();\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/AccessibleModal.ts","import { ModalBox as ModalBoxModule } from '../../ExternalModulesShim';\nimport { exportGlobally } from '../../GlobalExports';\nimport { Component } from '../Base/Component';\nimport { IComponentBindings } from '../Base/ComponentBindings';\nimport { QueryEvents, Initialization, $$ } from '../../Core';\nimport { IQuerySuccessEventArgs } from '../../events/QueryEvents';\nimport { IQuestionAnswerResponse } from '../../rest/QuestionAnswerResponse';\nimport 'styling/_SmartSnippet';\nimport { find, map, flatten, compact } from 'underscore';\nimport { IQueryResult } from '../../rest/QueryResult';\nimport { UserFeedbackBanner } from './UserFeedbackBanner';\nimport {\n  analyticsActionCauseList,\n  IAnalyticsNoMeta,\n  IAnalyticsSmartSnippetFeedbackMeta,\n  AnalyticsSmartSnippetFeedbackReason,\n  IAnalyticsSmartSnippetOpenSourceMeta\n} from '../Analytics/AnalyticsActionListMeta';\nimport { HeightLimiter } from './HeightLimiter';\nimport { ExplanationModal, IReason } from './ExplanationModal';\nimport { l } from '../../strings/Strings';\nimport { attachShadow } from '../../misc/AttachShadowPolyfill';\nimport { Utils } from '../../utils/Utils';\nimport { ComponentOptions } from '../Base/ComponentOptions';\nimport { getDefaultSnippetStyle } from './SmartSnippetCommon';\nimport { ResultLink } from '../ResultLink/ResultLink';\nimport { IFieldOption } from '../Base/IComponentOptions';\n\ninterface ISmartSnippetReason {\n  analytics: AnalyticsSmartSnippetFeedbackReason;\n  localeKey: string;\n  hasDetails?: boolean;\n}\n\nconst reasons: ISmartSnippetReason[] = [\n  {\n    analytics: AnalyticsSmartSnippetFeedbackReason.DoesNotAnswer,\n    localeKey: 'UsefulnessFeedbackDoesNotAnswer'\n  },\n  {\n    analytics: AnalyticsSmartSnippetFeedbackReason.PartiallyAnswers,\n    localeKey: 'UsefulnessFeedbackPartiallyAnswers'\n  },\n  {\n    analytics: AnalyticsSmartSnippetFeedbackReason.WasNotAQuestion,\n    localeKey: 'UsefulnessFeedbackWasNotAQuestion'\n  },\n  {\n    analytics: AnalyticsSmartSnippetFeedbackReason.Other,\n    localeKey: 'Other',\n    hasDetails: true\n  }\n];\n\nconst BASE_CLASSNAME = 'coveo-smart-snippet';\nconst QUESTION_CLASSNAME = `${BASE_CLASSNAME}-question`;\nconst ANSWER_CONTAINER_CLASSNAME = `${BASE_CLASSNAME}-answer`;\nconst HAS_ANSWER_CLASSNAME = `${BASE_CLASSNAME}-has-answer`;\nconst SHADOW_CLASSNAME = `${BASE_CLASSNAME}-content`;\nconst CONTENT_CLASSNAME = `${BASE_CLASSNAME}-content-wrapper`;\nconst SOURCE_CLASSNAME = `${BASE_CLASSNAME}-source`;\nconst SOURCE_TITLE_CLASSNAME = `${SOURCE_CLASSNAME}-title`;\nconst SOURCE_URL_CLASSNAME = `${SOURCE_CLASSNAME}-url`;\n\nexport const SmartSnippetClassNames = {\n  QUESTION_CLASSNAME,\n  ANSWER_CONTAINER_CLASSNAME,\n  HAS_ANSWER_CLASSNAME,\n  SHADOW_CLASSNAME,\n  CONTENT_CLASSNAME,\n  SOURCE_CLASSNAME,\n  SOURCE_TITLE_CLASSNAME,\n  SOURCE_URL_CLASSNAME\n};\n\nexport interface ISmartSnippetOptions {\n  maximumSnippetHeight: number;\n  titleField: IFieldOption;\n  hrefTemplate?: string;\n  alwaysOpenInNewWindow?: boolean;\n  useIFrame?: boolean;\n}\n/**\n * The SmartSnippet component displays the excerpt of a document that would be most likely to answer a particular query.\n *\n * This excerpt can be visually customized using inline styling.\n */\nexport class SmartSnippet extends Component {\n  static ID = 'SmartSnippet';\n\n  static doExport = () => {\n    exportGlobally({\n      SmartSnippet\n    });\n  };\n\n  /**\n   * The options for the SmartSnippet\n   * @componentOptions\n   */\n  static options: ISmartSnippetOptions = {\n    /**\n     * The maximum height an answer can have in pixels.\n     * Any part of an answer exceeding this height will be hidden by default and expendable via a \"show more\" button.\n     * Default value is `250`.\n     */\n    maximumSnippetHeight: ComponentOptions.buildNumberOption({ defaultValue: 250, min: 0 }),\n\n    /**\n     * The field to display for the title.\n     */\n    titleField: ComponentOptions.buildFieldOption({ defaultValue: '@title' }),\n\n    /**\n     * Specifies a template literal from which to generate the title and URI's `href` attribute value (see\n     * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\n     *\n     * This option overrides the [`field`]{@link SmartSnippet.options.uriField} option value.\n     *\n     * The template literal can reference any number of fields from the parent result. It can also reference global\n     * scope properties.\n     *\n     * **Examples:**\n     *\n     * - The following markup generates an `href` value such as `http://uri.com?id=itemTitle`:\n     *\n     * ```html\n     * <a class='CoveoSmartSnippet' data-href-template='${clickUri}?id=${raw.title}'></a>\n     * ```\n     *\n     * - The following markup generates an `href` value such as `localhost/fooBar`:\n     *\n     * ```html\n     * <a class='CoveoSmartSnippet' data-href-template='${window.location.hostname}/{Foo.Bar}'></a>\n     * ```\n     *\n     * Default value is `undefined`.\n     */\n    hrefTemplate: ComponentOptions.buildStringOption(),\n\n    /**\n     * Specifies whether the component should open its links in a new window instead of opening them in the current\n     * context.\n     *\n     * Default value is `false`.\n     */\n    alwaysOpenInNewWindow: ComponentOptions.buildBooleanOption({ defaultValue: false }),\n\n    /**\n     * Specify if the SmartSnippet should be displayed inside an iframe or not.\n     *\n     * Use this option in specific cases where your environment has limitations around iframe usage.\n     *\n     * **Examples:**\n     *\n     * ```html\n     * <div class='CoveoSmartSnippet' data-use-i-frame='true'></div>\n     * ```\n     *\n     * Default value is `true`.\n     */\n    useIFrame: ComponentOptions.buildBooleanOption({ defaultValue: true })\n  };\n\n  private lastRenderedResult: IQueryResult = null;\n  private searchUid: string;\n  private questionContainer: HTMLElement;\n  private shadowContainer: HTMLElement;\n  private sourceContainer: HTMLElement;\n  private snippetContainer: HTMLElement;\n  private heightLimiter: HeightLimiter;\n  private explanationModal: ExplanationModal;\n  private feedbackBanner: UserFeedbackBanner;\n  private shadowLoading: Promise<HTMLElement>;\n\n  constructor(\n    public element: HTMLElement,\n    public options?: ISmartSnippetOptions,\n    bindings?: IComponentBindings,\n    private ModalBox = ModalBoxModule\n  ) {\n    super(element, SmartSnippet.ID, bindings);\n    this.options = ComponentOptions.initComponentOptions(element, SmartSnippet, options);\n    this.bind.onRootElement(QueryEvents.deferredQuerySuccess, (data: IQuerySuccessEventArgs) => this.handleQuerySuccess(data));\n  }\n\n  public get loading() {\n    return this.shadowLoading;\n  }\n\n  private get style() {\n    const styles = $$(this.element)\n      .children()\n      .filter(element => element instanceof HTMLScriptElement && element.type.toLowerCase() === 'text/css')\n      .map(element => element.innerHTML);\n    return styles.length ? styles.join('\\n') : null;\n  }\n\n  private set hasAnswer(hasAnswer: boolean) {\n    $$(this.element).toggleClass(HAS_ANSWER_CLASSNAME, hasAnswer);\n  }\n\n  public createDom() {\n    this.element.appendChild(this.buildAnswerContainer());\n    this.feedbackBanner = new UserFeedbackBanner(\n      isUseful => (isUseful ? this.sendLikeSmartSnippetAnalytics() : this.sendDislikeSmartSnippetAnalytics()),\n      () => this.openExplanationModal()\n    );\n    this.element.appendChild(this.feedbackBanner.build());\n    this.explanationModal = new ExplanationModal({\n      reasons: reasons.map(\n        reason =>\n          <IReason>{\n            label: l(reason.localeKey),\n            id: reason.analytics.replace(/_/g, '-'),\n            onSelect: () => this.sendExplanationAnalytics(reason.analytics, this.explanationModal.details),\n            hasDetails: reason.hasDetails\n          }\n      ),\n      onClosed: () => this.sendCloseFeedbackModalAnalytics(),\n      ownerElement: this.searchInterface.options.modalContainer,\n      modalBoxModule: this.ModalBox\n    });\n  }\n\n  private buildAnswerContainer() {\n    return $$(\n      'div',\n      {\n        className: ANSWER_CONTAINER_CLASSNAME\n      },\n      this.buildQuestion(),\n      this.buildShadow(),\n      this.buildHeightLimiter(),\n      this.buildSourceContainer()\n    ).el;\n  }\n\n  private buildQuestion() {\n    return (this.questionContainer = $$('div', { className: QUESTION_CLASSNAME }).el);\n  }\n\n  private buildShadow() {\n    this.shadowContainer = $$('div', { className: SHADOW_CLASSNAME }).el;\n    this.snippetContainer = $$('section', { className: CONTENT_CLASSNAME }).el;\n    this.shadowLoading = attachShadow(this.shadowContainer, {\n      mode: 'open',\n      title: l('AnswerSnippet'),\n      onSizeChanged: () => this.handleAnswerSizeChanged(),\n      useIFrame: this.options.useIFrame\n    }).then(shadow => {\n      shadow.appendChild(this.snippetContainer);\n      const style = this.buildStyle();\n      shadow.appendChild(style);\n      return shadow;\n    });\n    return this.shadowContainer;\n  }\n\n  private buildHeightLimiter() {\n    return (this.heightLimiter = new HeightLimiter(\n      this.shadowContainer,\n      this.shadowContainer.childNodes.item(0) as HTMLElement,\n      this.options.maximumSnippetHeight,\n      isExpanded => (isExpanded ? this.sendExpandSmartSnippetAnalytics() : this.sendCollapseSmartSnippetAnalytics())\n    )).toggleButton;\n  }\n\n  private buildSourceContainer() {\n    return (this.sourceContainer = $$('div', { className: SOURCE_CLASSNAME }).el);\n  }\n\n  private buildStyle() {\n    const style = Utils.isNullOrUndefined(this.style) ? getDefaultSnippetStyle(CONTENT_CLASSNAME) : this.style;\n    const styleTag = document.createElement('style');\n    styleTag.innerHTML = style;\n    return styleTag;\n  }\n\n  private handleAnswerSizeChanged() {\n    this.heightLimiter.onContentHeightChanged();\n  }\n\n  /**\n   * @warning This method only works for the demo. In practice, the source of the answer will not always be part of the results.\n   */\n  private getCorrespondingResult(questionAnswer: IQuestionAnswerResponse) {\n    const lastResults = this.queryController.getLastResults().results;\n    const childResults = flatten(map(lastResults, lastResult => lastResult.childResults)) as IQueryResult[];\n    const attachments = flatten(map(lastResults, lastResult => lastResult.attachments)) as IQueryResult[];\n\n    return find(\n      compact(lastResults.concat(childResults, attachments)),\n      result => result.raw[questionAnswer.documentId.contentIdKey] === questionAnswer.documentId.contentIdValue\n    );\n  }\n\n  private async handleQuerySuccess(data: IQuerySuccessEventArgs) {\n    const { questionAnswer } = data.results;\n    if (!this.containsQuestionAnswer(questionAnswer)) {\n      this.hasAnswer = false;\n      return;\n    }\n    this.hasAnswer = true;\n    this.searchUid = data.results.searchUid;\n    await this.render(questionAnswer);\n  }\n\n  private containsQuestionAnswer(questionAnswer: IQuestionAnswerResponse) {\n    return questionAnswer && questionAnswer.question && questionAnswer.answerSnippet;\n  }\n\n  private async render(questionAnswer: IQuestionAnswerResponse) {\n    this.ensureDom();\n    this.feedbackBanner.reset();\n    this.questionContainer.innerText = questionAnswer.question;\n    this.renderSnippet(questionAnswer.answerSnippet);\n    this.lastRenderedResult = this.getCorrespondingResult(questionAnswer);\n    if (this.lastRenderedResult) {\n      this.renderSource();\n    } else {\n      this.lastRenderedResult = null;\n    }\n  }\n\n  private renderSnippet(content: string) {\n    this.snippetContainer.innerHTML = content;\n  }\n\n  private renderSource() {\n    const container = $$(this.sourceContainer);\n    container.empty();\n    container.append(this.renderSourceUrl().el);\n    container.append(this.renderSourceTitle().el);\n  }\n\n  private renderSourceTitle() {\n    const link = this.buildLink(SOURCE_TITLE_CLASSNAME);\n    link.text(Utils.getFieldValue(this.lastRenderedResult, <string>this.options.titleField));\n    return link;\n  }\n\n  private renderSourceUrl() {\n    const link = this.buildLink(SOURCE_URL_CLASSNAME);\n    link.text((link.el as HTMLAnchorElement).href);\n    return link;\n  }\n\n  private buildLink(className: string) {\n    const element = $$('a', { className: 'CoveoResultLink' });\n    element.addClass(className);\n    new ResultLink(\n      element.el,\n      {\n        hrefTemplate: this.options.hrefTemplate,\n        logAnalytics: href => this.sendClickSourceAnalytics(element.el, href),\n        alwaysOpenInNewWindow: this.options.alwaysOpenInNewWindow\n      },\n      { ...this.getBindings(), resultElement: this.element },\n      this.lastRenderedResult\n    );\n    return element;\n  }\n\n  private openExplanationModal() {\n    this.sendOpenFeedbackModalAnalytics();\n    this.explanationModal.open(this.feedbackBanner.explainWhy);\n  }\n\n  private sendLikeSmartSnippetAnalytics() {\n    return this.usageAnalytics.logCustomEvent<IAnalyticsNoMeta>(\n      analyticsActionCauseList.likeSmartSnippet,\n      { searchQueryUid: this.searchUid },\n      this.element\n    );\n  }\n\n  private sendDislikeSmartSnippetAnalytics() {\n    return this.usageAnalytics.logCustomEvent<IAnalyticsNoMeta>(\n      analyticsActionCauseList.dislikeSmartSnippet,\n      { searchQueryUid: this.searchUid },\n      this.element\n    );\n  }\n\n  private sendExpandSmartSnippetAnalytics() {\n    return this.usageAnalytics.logCustomEvent<IAnalyticsNoMeta>(\n      analyticsActionCauseList.expandSmartSnippet,\n      { searchQueryUid: this.searchUid },\n      this.element\n    );\n  }\n\n  private sendCollapseSmartSnippetAnalytics() {\n    return this.usageAnalytics.logCustomEvent<IAnalyticsNoMeta>(\n      analyticsActionCauseList.collapseSmartSnippet,\n      { searchQueryUid: this.searchUid },\n      this.element\n    );\n  }\n\n  private sendOpenFeedbackModalAnalytics() {\n    return this.usageAnalytics.logCustomEvent<IAnalyticsNoMeta>(\n      analyticsActionCauseList.openSmartSnippetFeedbackModal,\n      { searchQueryUid: this.searchUid },\n      this.element\n    );\n  }\n\n  private sendCloseFeedbackModalAnalytics() {\n    return this.usageAnalytics.logCustomEvent<IAnalyticsNoMeta>(\n      analyticsActionCauseList.closeSmartSnippetFeedbackModal,\n      { searchQueryUid: this.searchUid },\n      this.element\n    );\n  }\n\n  private sendExplanationAnalytics(reason: AnalyticsSmartSnippetFeedbackReason, details?: string) {\n    return this.usageAnalytics.logCustomEvent<IAnalyticsSmartSnippetFeedbackMeta>(\n      analyticsActionCauseList.sendSmartSnippetReason,\n      {\n        searchQueryUid: this.searchUid,\n        reason,\n        details\n      },\n      this.element\n    );\n  }\n\n  private sendClickSourceAnalytics(element: HTMLElement, href: string) {\n    return this.usageAnalytics.logClickEvent<IAnalyticsSmartSnippetOpenSourceMeta>(\n      analyticsActionCauseList.openSmartSnippetSource,\n      {\n        searchQueryUid: this.searchUid,\n        documentTitle: this.lastRenderedResult.title,\n        author: Utils.getFieldValue(this.lastRenderedResult, 'author'),\n        documentURL: href\n      },\n      this.lastRenderedResult,\n      element\n    );\n  }\n}\nInitialization.registerAutoCreateComponent(SmartSnippet);\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/SmartSnippet/SmartSnippet.ts","import { Defer } from '../../misc/Defer';\nimport { without, chain } from 'underscore';\nimport { $$, Dom } from '../../utils/Dom';\n\nexport interface FocusTrapOptions {\n  focusableSelector: string;\n}\n\nexport class FocusTrap {\n  private focusInEvent: (e: FocusEvent) => void;\n  private focusOutEvent: (e: FocusEvent) => void;\n  private hiddenElements: HTMLElement[];\n  private enabled: boolean;\n\n  private get focusableElements(): HTMLElement[] {\n    return chain(Dom.nodeListToArray(this.container.querySelectorAll(this.options.focusableSelector)))\n      .filter(element => $$(element).isVisible())\n      .sortBy(element => element.tabIndex)\n      .value();\n  }\n\n  constructor(\n    private container: HTMLElement,\n    private options: FocusTrapOptions = {\n      focusableSelector: '[tabindex], button'\n    }\n  ) {\n    this.hiddenElements = [];\n    this.enable();\n  }\n\n  public disable() {\n    document.removeEventListener('focusin', this.focusInEvent);\n    document.removeEventListener('focusout', this.focusOutEvent);\n    this.showHiddenElements();\n    this.enabled = false;\n  }\n\n  private enable() {\n    document.addEventListener('focusin', (this.focusInEvent = e => this.onFocusIn(e)));\n    document.addEventListener('focusout', (this.focusOutEvent = e => this.onFocusOut(e)));\n    this.hideAllExcept(this.container);\n    this.enabled = true;\n  }\n\n  private showHiddenElements() {\n    while (this.hiddenElements.length) {\n      this.hiddenElements.pop().removeAttribute('aria-hidden');\n    }\n  }\n\n  private hideElement(element: HTMLElement) {\n    if (element.getAttribute('aria-hidden')) {\n      return;\n    }\n    this.hiddenElements.push(element);\n    element.setAttribute('aria-hidden', `${true}`);\n  }\n\n  private hideSiblings(allowedElement: HTMLElement) {\n    const parent = allowedElement.parentElement;\n    if (parent) {\n      without($$(parent).children(), allowedElement).forEach(elementToHide => {\n        this.hideElement(elementToHide);\n      });\n    }\n  }\n\n  private hideAllExcept(allowedElement: HTMLElement) {\n    this.hideSiblings(allowedElement);\n    const parent = allowedElement.parentElement;\n    if (parent && parent !== document.body) {\n      this.hideAllExcept(parent);\n    }\n  }\n\n  private getFocusableSibling(element: HTMLElement, previous = false) {\n    const elements = this.focusableElements;\n    const currentIndex = elements.indexOf(element);\n    if (currentIndex === -1) {\n      return null;\n    }\n    return elements[(currentIndex + (previous ? -1 : 1) + elements.length) % elements.length];\n  }\n\n  private focusSibling(element: HTMLElement, previous = false) {\n    const sibling = this.getFocusableSibling(element, previous);\n    if (sibling) {\n      sibling.focus();\n    }\n  }\n\n  private focusFirstElement() {\n    const elements = this.focusableElements;\n    if (elements.length) {\n      elements[0].focus();\n    }\n  }\n\n  private elementIsBefore(oldElement: HTMLElement, newElement: HTMLElement) {\n    if (!newElement) {\n      return false;\n    }\n    return oldElement.compareDocumentPosition(newElement) === Node.DOCUMENT_POSITION_PRECEDING;\n  }\n\n  private onLosingFocus(oldElement: HTMLElement, newElement: HTMLElement) {\n    Defer.defer(() => {\n      if (!this.enabled) {\n        return;\n      }\n      this.enabled = false;\n      if (oldElement && this.focusIsAllowed(oldElement)) {\n        this.focusSibling(oldElement, this.elementIsBefore(oldElement, newElement));\n      } else {\n        this.focusFirstElement();\n      }\n      this.enabled = true;\n    });\n  }\n\n  private focusIsAllowed(element: HTMLElement) {\n    return this.container.contains(element);\n  }\n\n  private elementIsInPage(element: HTMLElement) {\n    return element && element !== document.body.parentElement;\n  }\n\n  private onFocusIn(e: FocusEvent) {\n    if (!this.enabled) {\n      return;\n    }\n    const oldElement = e.relatedTarget as HTMLElement;\n    const handledByFocusOut = this.elementIsInPage(oldElement);\n    if (handledByFocusOut) {\n      return;\n    }\n    const newElement = e.target as HTMLElement;\n    if (!this.elementIsInPage(newElement)) {\n      return;\n    }\n    if (!this.focusIsAllowed(newElement)) {\n      this.onLosingFocus(null, newElement);\n    }\n  }\n\n  private onFocusOut(e: FocusEvent) {\n    if (!this.enabled) {\n      return;\n    }\n    const newElement = e.relatedTarget as HTMLElement;\n    if (!this.elementIsInPage(newElement)) {\n      return;\n    }\n    if (!newElement || !this.focusIsAllowed(newElement)) {\n      this.onLosingFocus(e.target as HTMLElement, newElement);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/FocusTrap/FocusTrap.ts","import { $$ } from '../utils/Dom';\nimport 'styling/_AttachShadowPolyfill';\n\nexport interface IShadowOptions {\n  title: string;\n  onSizeChanged?: Function;\n  useIFrame?: Boolean;\n}\n\nexport async function attachShadow(element: HTMLElement, options: IShadowOptions & ShadowRootInit): Promise<HTMLElement> {\n  const elementOptions = { className: 'coveo-shadow-iframe', scrolling: 'no', title: options.title };\n  let autoUpdateContainer: HTMLIFrameElement | HTMLElement;\n  let contentBody: HTMLElement;\n  if (options.useIFrame) {\n    autoUpdateContainer = $$('iframe', elementOptions).el;\n    const onLoad = new Promise(resolve => autoUpdateContainer.addEventListener('load', () => resolve()));\n    element.appendChild(autoUpdateContainer);\n    await onLoad;\n    contentBody = (autoUpdateContainer as HTMLIFrameElement).contentDocument.body;\n  } else {\n    autoUpdateContainer = $$('div', elementOptions).el;\n    contentBody = autoUpdateContainer;\n    element.appendChild(autoUpdateContainer);\n  }\n\n  contentBody.style.margin = '0';\n  const shadowRootContainer = $$('div', { style: 'overflow: auto;' }).el;\n  contentBody.appendChild(shadowRootContainer);\n  autoUpdateHeight(autoUpdateContainer, shadowRootContainer, options.onSizeChanged);\n  if (options.mode === 'open') {\n    Object.defineProperty(element, 'shadowRoot', { get: () => shadowRootContainer });\n  }\n\n  return shadowRootContainer;\n}\n\nfunction autoUpdateHeight(elementToResize: HTMLElement, content: HTMLElement, onUpdate?: Function) {\n  let lastWidth = content.clientWidth;\n  let lastHeight = content.clientHeight;\n\n  const heightObserver = new MutationObserver(() => {\n    if (lastWidth === content.clientWidth && lastHeight === content.clientHeight) {\n      return;\n    }\n    lastWidth = content.clientWidth;\n    lastHeight = content.clientHeight;\n    elementToResize.style.width = `${content.clientWidth}px`;\n    elementToResize.style.height = `${content.clientHeight}px`;\n    if (onUpdate) {\n      onUpdate();\n    }\n  });\n  heightObserver.observe(content, {\n    attributes: true,\n    characterData: true,\n    childList: true,\n    subtree: true\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/misc/AttachShadowPolyfill.ts","export const getDefaultSnippetStyle = (contentClassName: string) => `\n  body {\n    font-family: \"Lato\", \"Helvetica Neue\", Helvetica, Arial, sans-serif, sans-serif;\n  }\n\n  .${contentClassName} > :first-child {\n    margin-top: 0;\n  }\n\n  .${contentClassName} > :last-child {\n    margin-bottom: 0;\n  }\n`;\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/SmartSnippet/SmartSnippetCommon.ts","import { Component } from '../Base/Component';\nimport { ComponentOptions } from '../Base/ComponentOptions';\nimport { ComponentOptionsModel } from '../../models/ComponentOptionsModel';\nimport { IResultsComponentBindings } from '../Base/ResultsComponentBindings';\nimport { analyticsActionCauseList } from '../Analytics/AnalyticsActionListMeta';\nimport { IResultLinkOptions } from './ResultLinkOptions';\nimport { ResultListEvents } from '../../events/ResultListEvents';\nimport { HighlightUtils } from '../../utils/HighlightUtils';\nimport { IQueryResult } from '../../rest/QueryResult';\nimport { DeviceUtils } from '../../utils/DeviceUtils';\nimport { OS_NAME, OSUtils } from '../../utils/OSUtils';\nimport { Initialization } from '../Base/Initialization';\nimport { QueryUtils } from '../../utils/QueryUtils';\nimport { Assert } from '../../misc/Assert';\nimport { Utils } from '../../utils/Utils';\nimport { Defer } from '../../misc/Defer';\nimport { $$ } from '../../utils/Dom';\nimport { StreamHighlightUtils } from '../../utils/StreamHighlightUtils';\nimport { StringUtils } from '../../utils/StringUtils';\nimport { once, debounce, extend, escape } from 'underscore';\nimport { exportGlobally } from '../../GlobalExports';\n\nimport 'styling/_ResultLink';\nimport { AccessibleButton } from '../../utils/AccessibleButton';\n\n/**\n * The `ResultLink` component automatically transform a search result title into a clickable link pointing to the\n * original item.\n *\n * This component is a result template component (see [Result Templates](https://docs.coveo.com/en/413/)).\n */\nexport class ResultLink extends Component {\n  static ID = 'ResultLink';\n\n  static doExport = () => {\n    exportGlobally({\n      ResultLink: ResultLink\n    });\n  };\n\n  /**\n   * The options for the ResultLink\n   * @componentOptions\n   */\n  static options: IResultLinkOptions = {\n    /**\n     * Specifies the field to use to output the component `href` attribute value.\n     *\n     * **Tip:**\n     * > Instead of specifying a value for the `field` option, you can directly add an `href` attribute to the\n     * > `ResultLink` HTML element. Then, you can use a custom script to generate the `href` value.\n     *\n     * **Examples:**\n     * - With the following markup, the `ResultLink` outputs its `href` value using the `@uri` field (rather than the\n     * default field):\n     *\n     * ```html\n     * <a class=\"CoveoResultLink\" data-field=\"@uri\"></a>\n     * ```\n     *\n     * - In the following result template, the custom `getMyKBUri()` function provides the `href` value:\n     *\n     * ```html\n     * <script id=\"KnowledgeArticle\" type=\"text/underscore\" class=\"result-template\">\n     *   <div class='CoveoIcon>'></div>\n     *   <a class=\"CoveoResultLink\" href=\"<%= getMyKBUri(raw) %>\"></a>\n     *   <div class=\"CoveoExcerpt\"></div>\n     * </script>\n     * ```\n     *\n     * See also [`hrefTemplate`]{@link ResultLink.options.hrefTemplate}, which can override this option.\n     *\n     * By default, the component uses the `@clickUri` field of the item to output the value of its `href` attribute.\n     */\n    field: ComponentOptions.buildFieldOption(),\n\n    /**\n     * Specifies whether the component should try to open its link in Microsoft Outlook.\n     *\n     * Setting this option to `true` is normally useful for `ResultLink` instances related to Microsoft Exchange emails.\n     *\n     * If this option is `true`, clicking the `ResultLink` calls the\n     * [`openLinkInOutlook`]{@link ResultLink.openLinkInOutlook} method instead of the\n     * [`openLink`]{@link ResultLink.openLink} method.\n     *\n     * Default value is `false`.\n     */\n    openInOutlook: ComponentOptions.buildBooleanOption({ defaultValue: false }),\n\n    /**\n     * Specifies whether the component should open its link in the [`Quickview`]{@link Quickview} component rather than\n     * loading through the original URL.\n     *\n     * Default value is `false`.\n     */\n    openQuickview: ComponentOptions.buildBooleanOption({ defaultValue: false }),\n\n    /**\n     * Specifies whether the component should open its link in a new window instead of opening it in the current\n     * context.\n     *\n     * If this option is `true`, clicking the `ResultLink` calls the\n     * [`openLinkInNewWindow`]{@link ResultLink.openLinkInNewWindow} method instead of the\n     * [`openLink`]{@link ResultLink.openLink} method.\n     *\n     * **Note:**\n     * > If a search page contains a [`ResultPreferences`]{@link ResultsPreferences} component whose\n     * > [`enableOpenInNewWindow`]{@link ResultsPreferences.options.enableOpenInNewWindow} option is `true`, and the end\n     * > user checks the <b>Always open results in new window</b> box, `ResultLink` components in this page will always\n     * > open their links in a new window when the end user clicks them, no matter what the value of their\n     * > `alwaysOpenInNewWindow` option is.\n     *\n     * Default value is `false`.\n     */\n    alwaysOpenInNewWindow: ComponentOptions.buildBooleanOption({ defaultValue: false }),\n\n    /**\n     * Specifies a template literal from which to generate the `ResultLink` `href` attribute value (see\n     * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\n     *\n     * This option overrides the [`field`]{@link ResultLink.options.field} option value.\n     *\n     * The template literal can reference any number of fields from the parent result. It can also reference global\n     * scope properties.\n     *\n     * **Examples:**\n     *\n     * - The following markup generates an `href` value such as `http://uri.com?id=itemTitle`:\n     *\n     * ```html\n     * <a class='CoveoResultLink' data-href-template='${clickUri}?id=${raw.title}'></a>\n     * ```\n     *\n     * - The following markup generates an `href` value such as `localhost/fooBar`:\n     *\n     * ```html\n     * <a class='CoveoResultLink' data-href-template='${window.location.hostname}/{Foo.Bar}'></a>\n     * ```\n     *\n     * Default value is `undefined`.\n     */\n    hrefTemplate: ComponentOptions.buildStringOption(),\n\n    /**\n     * Specifies a template literal from which to generate the `ResultLink` display title (see\n     * [Template literals](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals)).\n     *\n     * This option overrides the default `ResultLink` display title behavior.\n     *\n     * The template literal can reference any number of fields from the parent result. However, if the template literal\n     * references a key whose value is undefined in the parent result fields, the `ResultLink` title displays the\n     * name of this key instead.\n     *\n     * This option is ignored if the `ResultLink` innerHTML contains any value.\n     *\n     * **Examples:**\n     *\n     * - The following markup generates a `ResultLink` display title such as `Case number: 123456` if both the\n     * `raw.objecttype` and `raw.objectnumber` keys are defined in the parent result fields:\n     *\n     * ```html\n     * <a class=\"CoveoResultLink\" data-title-template=\"${raw.objecttype} number: ${raw.objectnumber}\"></a>\n     * ```\n     *\n     * - The following markup generates `${myField}` as a `ResultLink` display title if the `myField` key is undefined\n     * in the parent result fields:\n     *\n     * ```html\n     * <a class=\"CoveoResultLink\" data-title-template=\"${myField}\"></a>\n     * ```\n     *\n     * - The following markup generates `Foobar` as a `ResultLink` display title, because the `ResultLink` innterHTML is\n     * not empty:\n     *\n     * ```html\n     * <a class=\"CoveoResultLink\" data-title-template=\"${will} ${be} ${ignored}\">Foobar</a>\n     * ```\n     *\n     * Default value is `undefined`.\n     *\n     * @availablesince [January 2017 Release (v1.1865.9)](https://docs.coveo.com/en/396/#january-2017-release-v118659)\n     */\n    titleTemplate: ComponentOptions.buildStringOption(),\n\n    /**\n     * Specifies an event handler function to execute when the user clicks the `ResultLink` component.\n     *\n     * The handler function takes a JavaScript [`Event`](https://developer.mozilla.org/en/docs/Web/API/Event) object and\n     * an [`IQueryResult`]{@link IQueryResult} as its parameters.\n     *\n     * Overriding the default behavior of the `onClick` event can allow you to execute specific code instead.\n     *\n     * **Note:**\n     * > You cannot set this option directly in the component markup as an HTML attribute. You must either set it in the\n     * > [`init`]{@link init} call of your search interface (see\n     * > [Passing Component Options in the init Call](https://docs.coveo.com/en/346/#passing-component-options-in-the-init-call)),\n     * > or before the `init` call, using the `options` top-level function (see\n     * > [Passing Component Options Before the init Call](https://docs.coveo.com/en/346/#passing-component-options-before-the-init-call)).\n     *\n     * **Example:**\n     * ```javascript\n     * // You can set the option in the 'init' call:\n     * Coveo.init(document.querySelector(\"#search\"), {\n     *   ResultLink : {\n     *     onClick : function(e, result) {\n     *       e.preventDefault();\n     *       // Custom code to execute with the item URI and title.\n     *       openUriInASpecialTab(result.clickUri, result.title);\n     *     }\n     *   }\n     * });\n     *\n     * // Or before the 'init' call, using the 'options' top-level function:\n     * // Coveo.options(document.querySelector('#search'), {\n     * //   ResultLink : {\n     * //     onClick : function(e, result) {\n     * //       e.preventDefault();\n     * //       // Custom code to execute with the item URI and title.\n     * //       openUriInASpecialTab(result.clickUri, result.title);\n     * //     }\n     * //   }\n     * // });\n     * ```\n     */\n    onClick: ComponentOptions.buildCustomOption<(e: Event, result: IQueryResult) => any>(() => {\n      return null;\n    }),\n\n    /**\n     * Specify this option to log additional analytics when this result link is pressed.\n     *\n     * **Example:**\n     * ```javascript\n     * const resultLink = new Coveo.ResultLink(\n     *   linkElement,\n     *   {\n     *     logAnalytics: (href) => Coveo.logCustomEvent(\n     *         Coveo.analyticsActionCauseList.openSmartSnippetSource,\n     *         {\n     *           searchQueryUid: searchInterface.queryController.lastSearchUid,\n     *           documentTitle: result.title,\n     *           author: Utils.getFieldValue(result, 'author'),\n     *           documentURL: href\n     *         },\n     *         element\n     *       )\n     *   },\n     *   searchInterface.getBindings(),\n     *   result\n     * )\n     * ```\n     */\n    logAnalytics: ComponentOptions.buildCustomOption<(href: string) => void>(() => null)\n  };\n\n  private toExecuteOnOpen: (e?: Event) => void;\n\n  /**\n   * Creates a new `ResultLink` component.\n   * @param element The HTMLElement on which to instantiate the component.\n   * @param options The options for the `ResultLink` component.\n   * @param bindings The bindings that the component requires to function normally. If not set, these will be\n   * automatically resolved (with a slower execution time).\n   * @param result The result to associate the component with.\n   * @param os\n   */\n  constructor(\n    public element: HTMLElement,\n    public options: IResultLinkOptions,\n    public bindings?: IResultsComponentBindings,\n    public result?: IQueryResult,\n    public os?: OS_NAME\n  ) {\n    super(element, ResultLink.ID, bindings);\n\n    const globalOptions = this.searchInterface.options.originalOptionsObject[ResultLink.ID] || {};\n    const initialOptions = ComponentOptions.initComponentOptions(element, ResultLink, { ...globalOptions, ...options });\n    const resultLinkOptions = this.componentOptionsModel.get(ComponentOptionsModel.attributesEnum.resultLink);\n    this.options = extend({}, initialOptions, resultLinkOptions);\n\n    this.result = result || this.resolveResult();\n\n    if (this.options.openQuickview == null) {\n      this.options.openQuickview = result.raw['connectortype'] == 'ExchangeCrawler' && DeviceUtils.isMobileDevice();\n    }\n    if (!this.element.hasAttribute('tabindex')) {\n      this.element.setAttribute('tabindex', '0');\n    }\n\n    Assert.exists(this.componentOptionsModel);\n    Assert.exists(this.result);\n\n    if (!this.quickviewShouldBeOpened()) {\n      // Bind on multiple \"click\" or \"mouse\" events.\n      // Create a function that will be executed only once, so as not to log multiple events\n      // Once a result link has been opened, and that we log at least one analytics event,\n      // it should not matter if the end user open the same link multiple times with different methods.\n      // It's still only one \"click\" event as far as UA is concerned.\n      // Also need to handle \"longpress\" on mobile (the contextual menu), which we assume to be 1 s long.\n\n      const executeOnlyOnce = once(() => this.logAnalytics());\n\n      $$(element).on(['contextmenu', 'click', 'mousedown', 'mouseup'], executeOnlyOnce);\n      let longPressTimer: number;\n      $$(element).on('touchstart', () => {\n        longPressTimer = window.setTimeout(executeOnlyOnce, 1000);\n      });\n      $$(element).on('touchend', () => {\n        if (longPressTimer) {\n          clearTimeout(longPressTimer);\n        }\n      });\n    }\n    this.renderUri(element, result);\n    this.bindEventToOpen();\n  }\n  public renderUri(element: HTMLElement, result?: IQueryResult) {\n    if (/^\\s*$/.test(this.element.innerHTML)) {\n      const title = this.getDisplayedTitle();\n      this.element.innerHTML = title;\n\n      const titleAsText = this.getDisplayedTitleAsText();\n      if (!this.element.hasAttribute('aria-label')) {\n        this.element.setAttribute('aria-label', titleAsText);\n      }\n\n      if (!this.element.title) {\n        this.element.title = titleAsText;\n      }\n    }\n  }\n  /**\n   * Opens the result in the same window, no matter how the actual component is configured for the end user.\n   * @param logAnalytics Specifies whether the method should log an analytics event.\n   */\n  public openLink(logAnalytics = true) {\n    if (logAnalytics) {\n      this.logAnalytics();\n    }\n    window.location.href = this.getResultUri();\n  }\n\n  /**\n   * Opens the result in a new window, no matter how the actual component is configured for the end user.\n   * @param logAnalytics Specifies whether the method should log an analytics event.\n   */\n  public openLinkInNewWindow(logAnalytics = true) {\n    if (logAnalytics) {\n      this.logAnalytics();\n    }\n    window.open(this.getResultUri(), '_blank');\n  }\n\n  /**\n   * Tries to open the result in Microsoft Outlook if the result has an `outlookformacuri` or `outlookuri` field.\n   *\n   * Normally, this implies the result should be a link to an email.\n   *\n   * If the needed fields are not present, this method does nothing.\n   * @param logAnalytics Specifies whether the method should log an analytics event.\n   */\n  public openLinkInOutlook(logAnalytics = true) {\n    if (this.hasOutlookField()) {\n      if (logAnalytics) {\n        this.logAnalytics();\n      }\n      this.openLink();\n    }\n  }\n\n  /**\n   * Opens the link in the same manner the end user would.\n   *\n   * This essentially simulates a click on the result link.\n   *\n   * @param logAnalytics Specifies whether the method should log an analytics event.\n   */\n  public openLinkAsConfigured(logAnalytics = true) {\n    if (this.toExecuteOnOpen) {\n      if (logAnalytics) {\n        this.logAnalytics();\n      }\n      this.toExecuteOnOpen();\n    }\n  }\n\n  protected bindEventToOpen(): boolean {\n    return (\n      this.bindOnClickIfNotUndefined() ||\n      this.bindOpenQuickviewIfNotUndefined() ||\n      this.setHrefIfNotAlready() ||\n      this.openLinkThatIsNotAnAnchor()\n    );\n  }\n\n  private getDisplayedTitle() {\n    if (!this.options.titleTemplate) {\n      return this.result.title\n        ? HighlightUtils.highlightString(this.result.title, this.result.titleHighlights, null, 'coveo-highlight')\n        : this.escapedClickUri;\n    } else {\n      let newTitle = StringUtils.buildStringTemplateFromResult(this.options.titleTemplate, this.result);\n      return newTitle\n        ? StreamHighlightUtils.highlightStreamText(newTitle, this.result.termsToHighlight, this.result.phrasesToHighlight)\n        : this.escapedClickUri;\n    }\n  }\n\n  private getDisplayedTitleAsText() {\n    const container = $$('div');\n    container.setHtml(this.getDisplayedTitle());\n    return container.text();\n  }\n\n  private get escapedClickUri() {\n    return escape(this.result.clickUri);\n  }\n\n  private bindOnClickIfNotUndefined() {\n    if (this.options.onClick != undefined) {\n      this.toExecuteOnOpen = (e: MouseEvent) => {\n        this.options.onClick.call(this, e, this.result);\n      };\n\n      new AccessibleButton()\n        .withElement(this.element)\n        .withLabel(this.result.title)\n        .withSelectAction((e: Event) => this.toExecuteOnOpen(e))\n        .build();\n\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  private bindOpenQuickviewIfNotUndefined() {\n    if (this.quickviewShouldBeOpened()) {\n      this.toExecuteOnOpen = () => {\n        $$(this.bindings.resultElement).trigger(ResultListEvents.openQuickview);\n      };\n\n      $$(this.element).on('click', (e: Event) => {\n        e.preventDefault();\n        this.toExecuteOnOpen();\n      });\n\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  private openLinkThatIsNotAnAnchor() {\n    if (!this.elementIsAnAnchor()) {\n      this.toExecuteOnOpen = () => {\n        if (this.options.alwaysOpenInNewWindow) {\n          if (this.options.openInOutlook) {\n            this.openLinkInOutlook();\n          } else {\n            this.openLinkInNewWindow();\n          }\n        } else {\n          this.openLink();\n        }\n      };\n\n      $$(this.element).on('click', () => {\n        this.toExecuteOnOpen();\n      });\n\n      return true;\n    }\n    return false;\n  }\n\n  private setHrefIfNotAlready() {\n    // Do not erase any value put in href by the template, etc. Allows\n    // using custom click urls while still keeping analytics recording\n    // and other behavior brought by the component.\n    if (this.elementIsAnAnchor() && !Utils.isNonEmptyString($$(this.element).getAttribute('href'))) {\n      $$(this.element).setAttribute('href', this.getResultUri());\n      if (this.options.alwaysOpenInNewWindow && !(this.options.openInOutlook && this.hasOutlookField())) {\n        $$(this.element).setAttribute('target', '_blank');\n      }\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  private logDocumentOpen(href: string) {\n    this.usageAnalytics.logClickEvent(\n      analyticsActionCauseList.documentOpen,\n      {\n        documentURL: href,\n        documentTitle: this.result.title,\n        author: Utils.getFieldValue(this.result, 'author')\n      },\n      this.result,\n      this.root\n    );\n  }\n\n  private logAnalytics = debounce(\n    () => {\n      this.queryController.saveLastQuery();\n      let documentURL = $$(this.element).getAttribute('href');\n      if (documentURL == undefined || documentURL == '') {\n        documentURL = this.escapedClickUri;\n      }\n      if (this.options.logAnalytics) {\n        this.options.logAnalytics(documentURL);\n      } else {\n        this.logDocumentOpen(documentURL);\n      }\n      Defer.flush();\n    },\n    1500,\n    true\n  );\n\n  private filterProtocol(uri: string) {\n    const isAbsolute = /^(https?|ftp|file|mailto|tel):/i.test(uri);\n    const isRelative = /^(\\/|\\.\\/|\\.\\.\\/)/.test(uri);\n\n    return isAbsolute || isRelative ? uri : '';\n  }\n\n  private getResultUri(): string {\n    if (this.options.hrefTemplate) {\n      const uri = StringUtils.buildStringTemplateFromResult(this.options.hrefTemplate, this.result);\n      return this.filterProtocol(uri);\n    }\n\n    if (this.options.field == undefined && this.options.openInOutlook) {\n      this.setField();\n    }\n\n    if (this.options.field != undefined) {\n      return this.filterProtocol(Utils.getFieldValue(this.result, <string>this.options.field));\n    }\n\n    return this.filterProtocol(this.result.clickUri);\n  }\n\n  private elementIsAnAnchor() {\n    return this.element.tagName == 'A';\n  }\n\n  private setField() {\n    let os = Utils.exists(this.os) ? this.os : OSUtils.get();\n    if (os == OS_NAME.MACOSX && this.hasOutlookField()) {\n      this.options.field = '@outlookformacuri';\n    } else if (os == OS_NAME.WINDOWS && this.hasOutlookField()) {\n      this.options.field = '@outlookuri';\n    }\n  }\n\n  private hasOutlookField() {\n    let os = Utils.exists(this.os) ? this.os : OSUtils.get();\n    if (os == OS_NAME.MACOSX && this.result.raw['outlookformacuri'] != undefined) {\n      return true;\n    } else if (os == OS_NAME.WINDOWS && this.result.raw['outlookuri'] != undefined) {\n      return true;\n    }\n    return false;\n  }\n\n  private isUriThatMustBeOpenedInQuickview(): boolean {\n    return this.escapedClickUri.toLowerCase().indexOf('ldap://') == 0;\n  }\n\n  private quickviewShouldBeOpened() {\n    return (this.options.openQuickview || this.isUriThatMustBeOpenedInQuickview()) && QueryUtils.hasHTMLVersion(this.result);\n  }\n}\n\nInitialization.registerAutoCreateComponent(ResultLink);\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/ResultLink/ResultLink.ts","import { $$ } from '../../utils/Dom';\nimport { l } from '../../strings/Strings';\nimport { SVGIcons } from '../../utils/SVGIcons';\nimport { uniqueId } from 'underscore';\n\nconst ROOT_CLASSNAME = 'coveo-user-feedback-banner';\nconst CONTAINER_CLASSNAME = `${ROOT_CLASSNAME}-container`;\nconst LABEL_CLASSNAME = `${ROOT_CLASSNAME}-label`;\nconst BUTTONS_CONTAINER_CLASSNAME = `${ROOT_CLASSNAME}-buttons`;\nconst YES_BUTTON_CLASSNAME = `${ROOT_CLASSNAME}-yes-button`;\nconst NO_BUTTON_CLASSNAME = `${ROOT_CLASSNAME}-no-button`;\nconst BUTTON_ACTIVE_CLASSNAME = `${ROOT_CLASSNAME}-button-active`;\nconst THANK_YOU_BANNER_CLASSNAME = `${ROOT_CLASSNAME}-thanks`;\nconst THANK_YOU_BANNER_ACTIVE_CLASSNAME = `${THANK_YOU_BANNER_CLASSNAME}-active`;\nconst ICON_CLASSNAME = `${THANK_YOU_BANNER_CLASSNAME}-icon`;\nconst EXPLAIN_WHY_CLASSNAME = `${ROOT_CLASSNAME}-explain-why`;\nconst EXPLAIN_WHY_ACTIVE_CLASSNAME = `${EXPLAIN_WHY_CLASSNAME}-active`;\n\nenum UsefulState {\n  Unknown,\n  Yes,\n  No\n}\n\ninterface IButtonOptions {\n  text: string;\n  className: string;\n  action: Function;\n  icon?: {\n    content: string;\n    className: string;\n  };\n  attributes?: any;\n}\n\nexport const UserFeedbackBannerClassNames = {\n  ROOT_CLASSNAME,\n  CONTAINER_CLASSNAME,\n  LABEL_CLASSNAME,\n  BUTTONS_CONTAINER_CLASSNAME,\n  YES_BUTTON_CLASSNAME,\n  NO_BUTTON_CLASSNAME,\n  BUTTON_ACTIVE_CLASSNAME,\n  THANK_YOU_BANNER_CLASSNAME,\n  THANK_YOU_BANNER_ACTIVE_CLASSNAME,\n  ICON_CLASSNAME,\n  EXPLAIN_WHY_CLASSNAME,\n  EXPLAIN_WHY_ACTIVE_CLASSNAME\n};\n\nexport class UserFeedbackBanner {\n  public explainWhy: HTMLElement;\n  private isUseful = UsefulState.Unknown;\n  private yesButton: HTMLElement;\n  private noButton: HTMLElement;\n  private thankYouBanner: HTMLElement;\n  private labelId: string;\n\n  constructor(private readonly sendUsefulnessAnalytics: (isUseful: boolean) => void, private readonly onExplainWhyPressed: () => void) {\n    this.labelId = uniqueId(LABEL_CLASSNAME);\n  }\n\n  public build() {\n    return $$(\n      'div',\n      {\n        className: ROOT_CLASSNAME,\n        ariaLive: 'polite'\n      },\n      this.buildContainer(),\n      this.buildThankYouBanner()\n    ).el;\n  }\n\n  public reset() {\n    this.isUseful = UsefulState.Unknown;\n    $$(this.yesButton).removeClass(BUTTON_ACTIVE_CLASSNAME);\n    $$(this.yesButton).setAttribute('aria-pressed', 'false');\n    $$(this.noButton).removeClass(BUTTON_ACTIVE_CLASSNAME);\n    $$(this.noButton).setAttribute('aria-pressed', 'false');\n    $$(this.thankYouBanner).removeClass(THANK_YOU_BANNER_ACTIVE_CLASSNAME);\n    $$(this.explainWhy).removeClass(EXPLAIN_WHY_ACTIVE_CLASSNAME);\n  }\n\n  private buildContainer() {\n    return $$(\n      'div',\n      {\n        className: CONTAINER_CLASSNAME,\n        ariaLabelledby: this.labelId\n      },\n      this.buildLabel(),\n      this.buildButtons()\n    ).el;\n  }\n\n  private buildLabel() {\n    return $$('span', { className: LABEL_CLASSNAME, id: this.labelId }, l('UsefulnessFeedbackRequest')).el;\n  }\n\n  private buildThankYouBanner() {\n    this.thankYouBanner = $$('div', { className: THANK_YOU_BANNER_CLASSNAME }).el;\n\n    const text = $$('span', {}, l('UsefulnessFeedbackThankYou')).el;\n    this.thankYouBanner.appendChild(text);\n\n    this.explainWhy = this.buildButton({\n      text: l('UsefulnessFeedbackExplainWhy'),\n      className: EXPLAIN_WHY_CLASSNAME,\n      action: () => this.requestExplaination()\n    });\n    this.thankYouBanner.appendChild(this.explainWhy);\n\n    return this.thankYouBanner;\n  }\n\n  private buildButtons() {\n    const buttonsContainer = $$('div', { className: BUTTONS_CONTAINER_CLASSNAME }).el;\n\n    this.yesButton = this.buildButton({\n      text: l('Yes'),\n      className: YES_BUTTON_CLASSNAME,\n      action: () => this.showThankYouBanner(true),\n      icon: {\n        className: ICON_CLASSNAME,\n        content: SVGIcons.icons.checkYes\n      },\n      attributes: {\n        ariaPressed: false,\n        ariaDescribedby: this.labelId\n      }\n    });\n    this.yesButton.setAttribute('aria-pressed', 'false');\n    buttonsContainer.appendChild(this.yesButton);\n\n    this.noButton = this.buildButton({\n      text: l('No'),\n      className: NO_BUTTON_CLASSNAME,\n      action: () => this.showThankYouBanner(false),\n      icon: {\n        className: ICON_CLASSNAME,\n        content: SVGIcons.icons.clearSmall\n      },\n      attributes: {\n        ariaPressed: false,\n        ariaDescribedby: this.labelId\n      }\n    });\n    buttonsContainer.appendChild(this.noButton);\n\n    return buttonsContainer;\n  }\n\n  private buildButton(options: IButtonOptions) {\n    const button = $$('button', { ...(options.attributes || {}), className: options.className, type: 'button' }).el;\n\n    if (options.icon) {\n      const icon = $$('span', { className: options.icon.className }, options.icon.content).el;\n      button.appendChild(icon);\n      const text = $$('span', {}, options.text).el;\n      button.appendChild(text);\n    } else {\n      button.innerText = options.text;\n    }\n\n    button.addEventListener('click', () => options.action());\n\n    return button;\n  }\n\n  private showThankYouBanner(isUseful: boolean) {\n    if (this.isUseful !== UsefulState.Unknown && isUseful === (this.isUseful === UsefulState.Yes)) {\n      return;\n    }\n    this.isUseful = isUseful ? UsefulState.Yes : UsefulState.No;\n    $$(this.yesButton).toggleClass(BUTTON_ACTIVE_CLASSNAME, isUseful);\n    $$(this.yesButton).setAttribute('aria-pressed', `${isUseful}`);\n    $$(this.noButton).toggleClass(BUTTON_ACTIVE_CLASSNAME, !isUseful);\n    $$(this.noButton).setAttribute('aria-pressed', `${!isUseful}`);\n    $$(this.thankYouBanner).addClass(THANK_YOU_BANNER_ACTIVE_CLASSNAME);\n    $$(this.explainWhy).toggleClass(EXPLAIN_WHY_ACTIVE_CLASSNAME, !isUseful);\n    this.sendUsefulnessAnalytics(isUseful);\n  }\n\n  private requestExplaination() {\n    this.onExplainWhyPressed();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/SmartSnippet/UserFeedbackBanner.ts","import { $$ } from '../../utils/Dom';\nimport { SVGIcons } from '../../utils/SVGIcons';\nimport { l } from '../../strings/Strings';\n\nconst BASE_CLASSNAME = 'coveo-height-limiter';\nconst CONTAINER_ACTIVE_CLASSNAME = `${BASE_CLASSNAME}-container-active`;\nconst CONTAINER_EXPANDED_CLASSNAME = `${BASE_CLASSNAME}-container-expanded`;\nconst BUTTON_CLASSNAME = `${BASE_CLASSNAME}-button`;\nconst BUTTON_LABEL_CLASSNAME = `${BUTTON_CLASSNAME}-label`;\nconst BUTTON_ICON_CLASSNAME = `${BUTTON_CLASSNAME}-icon`;\nconst BUTTON_ACTIVE_CLASSNAME = `${BUTTON_CLASSNAME}-active`;\n\nexport const HeightLimiterClassNames = {\n  CONTAINER_ACTIVE_CLASSNAME,\n  CONTAINER_EXPANDED_CLASSNAME,\n  BUTTON_CLASSNAME,\n  BUTTON_LABEL_CLASSNAME,\n  BUTTON_ICON_CLASSNAME,\n  BUTTON_ACTIVE_CLASSNAME\n};\n\nexport class HeightLimiter {\n  private isExpanded = false;\n  private button: HTMLElement;\n  private buttonLabel: HTMLElement;\n  private buttonIcon: HTMLElement;\n\n  public get toggleButton() {\n    return this.button;\n  }\n\n  private set height(height: number) {\n    this.containerElement.style.height = `${height}px`;\n  }\n\n  private get contentHeight() {\n    return this.contentElement.clientHeight;\n  }\n\n  constructor(\n    private containerElement: HTMLElement,\n    private contentElement: HTMLElement,\n    private heightLimit: number,\n    private onToggle?: (isExpanded: boolean) => void\n  ) {\n    this.buildButton();\n    this.updateActiveAppearance();\n  }\n\n  public onContentHeightChanged() {\n    this.updateActiveAppearance();\n  }\n\n  private buildButton() {\n    this.button = $$(\n      'button',\n      { className: BUTTON_CLASSNAME, type: 'button', ariaLabel: l('ShowMore'), ariaPressed: 'false', ariaHidden: 'true' },\n      (this.buttonLabel = $$('span', { className: BUTTON_LABEL_CLASSNAME }).el),\n      (this.buttonIcon = $$('span', { className: BUTTON_ICON_CLASSNAME }).el)\n    ).el;\n    this.button.addEventListener('click', () => this.toggle());\n    this.updateButton();\n    return this.button;\n  }\n\n  private updateActiveAppearance() {\n    const shouldBeActive = this.contentHeight > this.heightLimit;\n    $$(this.containerElement).toggleClass(CONTAINER_ACTIVE_CLASSNAME, shouldBeActive);\n    $$(this.button).toggleClass(BUTTON_ACTIVE_CLASSNAME, shouldBeActive);\n    if (shouldBeActive) {\n      this.updateExpandedAppearance();\n    } else {\n      this.isExpanded = false;\n      this.updateExpandedAppearance();\n      this.containerElement.style.height = '';\n    }\n  }\n\n  private updateButton() {\n    this.buttonLabel.innerText = this.isExpanded ? l('ShowLess') : l('ShowMore');\n    this.button.setAttribute('aria-pressed', `${this.isExpanded}`);\n    this.buttonIcon.innerHTML = this.isExpanded ? SVGIcons.icons.arrowUp : SVGIcons.icons.arrowDown;\n  }\n\n  private updateExpandedAppearance() {\n    this.updateButton();\n    $$(this.containerElement).toggleClass(CONTAINER_EXPANDED_CLASSNAME, this.isExpanded);\n    this.height = this.isExpanded ? this.contentHeight : this.heightLimit;\n  }\n\n  private toggle() {\n    this.isExpanded = !this.isExpanded;\n    this.updateExpandedAppearance();\n    if (this.onToggle) {\n      this.onToggle(this.isExpanded);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/SmartSnippet/HeightLimiter.ts","import { AccessibleModal } from '../../utils/AccessibleModal';\nimport { l } from '../../strings/Strings';\nimport { $$, Dom } from '../../utils/Dom';\nimport { RadioButton } from '../FormWidgets/RadioButton';\nimport 'styling/_ExplanationModal';\n\nexport interface IReason {\n  label: string;\n  id: string;\n  onSelect: () => void;\n  hasDetails?: boolean;\n}\n\nexport interface IExplanationModalOptions {\n  ownerElement: HTMLElement;\n  reasons: IReason[];\n  onClosed: () => void;\n  modalBoxModule?: Coveo.ModalBox.ModalBox;\n}\n\nconst ROOT_CLASSNAME = 'coveo-user-explanation-modal';\nconst CONTENT_CLASSNAME = `${ROOT_CLASSNAME}-content`;\nconst EXPLANATION_SECTION_CLASSNAME = `${ROOT_CLASSNAME}-explanation-section`;\nconst REASONS_CLASSNAME = `${ROOT_CLASSNAME}-explanations`;\nconst REASONS_LABEL_CLASSNAME = `${REASONS_CLASSNAME}-label`;\nconst DETAILS_SECTION_CLASSNAME = `${ROOT_CLASSNAME}-details`;\nconst DETAILS_TEXTAREA_CLASSNAME = `${DETAILS_SECTION_CLASSNAME}-textarea`;\nconst DETAILS_LABEL_CLASSNAME = `${DETAILS_SECTION_CLASSNAME}-label`;\nconst BUTTONS_SECTION_CLASSNAME = `${ROOT_CLASSNAME}-buttons-section`;\nconst SEND_BUTTON_CLASSNAME = `${ROOT_CLASSNAME}-send-button`;\nconst CANCEL_BUTTON_CLASSNAME = `${ROOT_CLASSNAME}-cancel-button`;\nconst DETAILS_ID = DETAILS_SECTION_CLASSNAME;\n\nexport const ExplanationModalClassNames = {\n  ROOT_CLASSNAME,\n  CONTENT_CLASSNAME,\n  EXPLANATION_SECTION_CLASSNAME,\n  REASONS_CLASSNAME,\n  REASONS_LABEL_CLASSNAME,\n  DETAILS_SECTION_CLASSNAME,\n  DETAILS_TEXTAREA_CLASSNAME,\n  DETAILS_LABEL_CLASSNAME,\n  BUTTONS_SECTION_CLASSNAME,\n  SEND_BUTTON_CLASSNAME,\n  CANCEL_BUTTON_CLASSNAME\n};\n\nexport class ExplanationModal {\n  private modal: AccessibleModal;\n  private reasons: RadioButton[];\n  private selectedReason: IReason;\n  private detailsSection: Dom;\n  private detailsTextArea: HTMLTextAreaElement;\n  private shouldCallCloseEvent = false;\n\n  constructor(public options: IExplanationModalOptions) {\n    this.modal = new AccessibleModal(ROOT_CLASSNAME, this.options.ownerElement, this.options.modalBoxModule, {\n      focusOnOpen: () => this.sendButton()\n    });\n  }\n\n  private sendButton(): HTMLElement {\n    return this.modal.element.querySelector(`.${REASONS_CLASSNAME} input`);\n  }\n\n  public get details() {\n    if (!this.selectedReason || !this.selectedReason.hasDetails) {\n      return null;\n    }\n    return this.detailsTextArea.value;\n  }\n\n  public open(origin: HTMLElement) {\n    this.modal.open({\n      origin,\n      title: $$('span', {}, l('UsefulnessFeedbackExplainWhyImperative')).el,\n      content: this.buildContent(),\n      validation: () => {\n        if (this.shouldCallCloseEvent) {\n          this.options.onClosed();\n          this.shouldCallCloseEvent = false;\n        }\n        return true;\n      }\n    });\n    this.shouldCallCloseEvent = true;\n  }\n\n  private buildContent() {\n    return $$(\n      'div',\n      {\n        className: CONTENT_CLASSNAME\n      },\n      this.buildExplanationSection(),\n      this.buildButtonsSection()\n    ).el;\n  }\n\n  private buildExplanationSection() {\n    const detailsSection = this.buildDetailsSection();\n    return $$(\n      'div',\n      {\n        className: EXPLANATION_SECTION_CLASSNAME\n      },\n      this.buildReasons(),\n      detailsSection\n    ).el;\n  }\n\n  private buildButtonsSection() {\n    return $$(\n      'div',\n      {\n        className: BUTTONS_SECTION_CLASSNAME\n      },\n      this.buildSendButton(),\n      this.buildCancelButton()\n    );\n  }\n\n  private buildReasons() {\n    const reasonsContainer = $$('fieldset', { className: REASONS_CLASSNAME }, this.buildReasonsLabel()).el;\n    this.reasons = this.options.reasons.map(reason => this.buildReasonRadioButton(reason));\n    this.reasons[0].select();\n    this.reasons.forEach(radioButton => reasonsContainer.appendChild(radioButton.getElement()));\n    return reasonsContainer;\n  }\n\n  private buildReasonsLabel() {\n    return $$('legend', { className: REASONS_LABEL_CLASSNAME }, l('UsefulnessFeedbackReason')).el;\n  }\n\n  private buildDetailsSection() {\n    return (this.detailsSection = $$(\n      'div',\n      { className: `coveo-hidden ${DETAILS_SECTION_CLASSNAME}` },\n      $$('label', { className: DETAILS_LABEL_CLASSNAME, for: DETAILS_ID }, l('Details')).el,\n      (this.detailsTextArea = $$('textarea', { className: DETAILS_TEXTAREA_CLASSNAME, id: DETAILS_ID, disabled: true })\n        .el as HTMLTextAreaElement)\n    ));\n  }\n\n  private buildSendButton() {\n    const button = $$('button', { className: SEND_BUTTON_CLASSNAME, type: 'button' }, l('Send'));\n    button.on('click', () => {\n      this.selectedReason.onSelect();\n      this.shouldCallCloseEvent = false;\n      this.modal.close();\n    });\n    return button.el;\n  }\n\n  private buildCancelButton() {\n    const button = $$('button', { className: CANCEL_BUTTON_CLASSNAME, type: 'button' }, l('Cancel'));\n    button.on('click', () => this.modal.close());\n    return button.el;\n  }\n\n  private buildReasonRadioButton(reason: IReason) {\n    return new RadioButton(\n      radioButton => {\n        if (!radioButton.isSelected()) {\n          return;\n        }\n        this.detailsSection.toggleClass('coveo-hidden', !reason.hasDetails);\n        this.detailsTextArea.disabled = !reason.hasDetails;\n        this.selectedReason = reason;\n      },\n      reason.label,\n      'reason',\n      `coveo-reason-${reason.id}`\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/SmartSnippet/ExplanationModal.ts","import { $$ } from '../../utils/Dom';\nimport { IFormWidgetWithLabel, IFormWidgetSelectable } from './FormWidgets';\nimport 'styling/vapor/_Radio';\nimport { exportGlobally } from '../../GlobalExports';\n\n/**\n * A radio button widget with standard styling.\n */\nexport class RadioButton implements IFormWidgetWithLabel, IFormWidgetSelectable {\n  protected element: HTMLElement;\n\n  static doExport() {\n    exportGlobally({\n      RadioButton: RadioButton\n    });\n  }\n\n  /**\n   * Creates a new `RadioButton`.\n   * @param onChange The function to call when the radio button value changes. This function takes the current\n   * `RadioButton` instance as an argument.\n   * @param label The label to display next to the radio button.\n   * @param name The value to set the `input` HTMLElement `name` attribute to.\n   */\n  constructor(\n    public onChange: (radioButton: RadioButton) => void = (radioButton: RadioButton) => {},\n    public label: string,\n    public name: string,\n    private id: string = label\n  ) {\n    this.buildContent();\n  }\n\n  /**\n   * Resets the radio button.\n   */\n  public reset() {\n    const currentlySelected = this.isSelected();\n    this.getRadio().checked = false;\n    if (currentlySelected) {\n      this.onChange(this);\n    }\n  }\n\n  /**\n   * Select the radio button\n   * @param triggerChange will trigger change event if specified and the radio button is not already selected\n   */\n  public select(triggerChange = true) {\n    const currentlySelected = this.isSelected();\n    this.getRadio().checked = true;\n    if (!currentlySelected && triggerChange) {\n      this.onChange(this);\n    }\n  }\n\n  /**\n   * Gets the element on which the radio button is bound.\n   * @returns {HTMLElement} The radio button element.\n   */\n  public build(): HTMLElement {\n    return this.element;\n  }\n\n  /**\n   * Gets the element on which the radio button is bound.\n   * @returns {HTMLElement} The radio button element.\n   */\n  public getElement(): HTMLElement {\n    return this.element;\n  }\n\n  public getValue(): string {\n    return this.label;\n  }\n\n  /**\n   * Indicates whether the radio button is selected.\n   * @returns {boolean} `true` if the radio button is selected, `false` otherwise.\n   */\n  public isSelected(): boolean {\n    return this.getRadio().checked;\n  }\n\n  /**\n   * Gets the `input` element (the radio button itself).\n   * @returns {HTMLInputElement} The `input` element.\n   */\n  public getRadio(): HTMLInputElement {\n    return <HTMLInputElement>$$(this.element).find('input');\n  }\n\n  /**\n   * Gets the radio button [`label`]{@link RadioButton.label} element.\n   * @returns {HTMLLabelElement} The `label` element.\n   */\n  public getLabel(): HTMLLabelElement {\n    return <HTMLLabelElement>$$(this.element).find('label');\n  }\n\n  private buildContent() {\n    const radioOption = $$('div', { className: 'coveo-radio' });\n    const radioInput = $$('input', { type: 'radio', name: this.name, id: this.id });\n    const labelInput = $$('label', { className: 'coveo-radio-input-label', for: this.id });\n    labelInput.text(this.label);\n    radioInput.on('change', () => {\n      this.onChange(this);\n    });\n\n    radioOption.append(radioInput.el);\n    radioOption.append(labelInput.el);\n    this.element = radioOption.el;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/FormWidgets/RadioButton.ts"],"sourceRoot":""}